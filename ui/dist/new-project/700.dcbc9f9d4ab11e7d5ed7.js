(self.webpackChunknew_project=self.webpackChunknew_project||[]).push([[700],{7806:()=>{L.Geoserver=L.FeatureGroup.extend({options:{layers:"",format:"image/png",transparent:!0,CQL_FILTER:"INCLUDE",zIndex:1e3,version:"1.1.0",srsname:"EPSG:4326",attribution:"layer",fitLayer:!0,style:"",onEachFeature:function(t,e){},wmsLayers:[],wmsCQL_FILTER:[],wmsStyle:[],width:500,height:500},initialize:function(t,e){this.baseLayerUrl=t,L.setOptions(this,e),this._layers={},this.state={exist:"exist"}},wms:function(){return L.tileLayer.wms(this.baseLayerUrl,this.options)},wfs:function(){var t=this;return $.ajax(this.baseLayerUrl,{type:"GET",data:{service:"WFS",version:"1.1.0",request:"GetFeature",typename:this.options.layers,CQL_FILTER:this.options.CQL_FILTER,srsname:this.options.srsname,outputFormat:"text/javascript",format_options:"callback: getJson"},dataType:"jsonp",jsonpCallback:"getJson",success:function(e){for(var i=[],n=0;n<e.features.length;n++){var o=L.GeoJSON.geometryToLayer(e.features[n],t.options||null);o.feature=e.features[n],o.options.onEachFeature=t.options.onEachFeature(o.feature,o),i.push(o)}if("function"==typeof t.options.style)for(n=0;n<i.length;n++)t.addLayer(i[n]),n.setStyle&&n.setStyle(t.options.style(n.feature));else for(n=0;n<i.length;n++)t.addLayer(i[n]),t.setStyle(t.options.style);t.options.fitLayer&&t._map.fitBounds(t.getBounds())}}).fail(function(t,e,i){console.log(t,e,i)}),t},legend:function(){var t=this,e=L.control({position:"bottomleft"});return e.onAdd=function(e){var i=L.DomUtil.create("div","info Legend");return i.innerHTML+=`<img src=${t.baseLayerUrl}/wms?REQUEST=GetLegendGraphic&VERSION=1.1.0&FORMAT=image/png&LAYER=${t.options.layers}&style=${t.options.style} alt="legend" data-toggle="tooltip" title="Map legend">`,i},e},wmsImage:function(){var t=this;return $.ajax({url:`${t.baseLayerUrl}/ows?service=WFS&version=1.0.0&request=GetFeature&cql_filter=${t.options.wmsCQL_FILTER[0]}&typeName=${t.options.wmsLayers[0]}&srsName=EPSG:4326&maxFeatures=50&outputFormat=text%2Fjavascript`,dataType:"jsonp",jsonpCallback:"parseResponse",success:function(e){selectedArea=L.geoJson(e),bboxX1=selectedArea.getBounds()._southWest.lng,bboxX2=selectedArea.getBounds()._northEast.lng,bboxY1=selectedArea.getBounds()._southWest.lat,bboxY2=selectedArea.getBounds()._northEast.lat,bboxList=[bboxX1,bboxX2,bboxY1,bboxY2],bufferBbox=Math.min(.1*(bboxX2-bboxX1),.1*(bboxY2-bboxY1)),maxValue=Math.max(bboxX2-bboxX1,bboxY2-bboxY1)/2;for(var i="",n="",o="",r=1;r<t.options.wmsLayers.length;r++)i+=t.options.wmsLayers[r],n+=t.options.wmsStyle[r],o+=t.options.wmsCQL_FILTER[r],r!=t.options.wmsLayers.length-1&&(i+=",",n+=",",o+=";");var s=`${t.baseLayerUrl}/wms?service=WMS&version=1.1.0&request=GetMap&layers=${i}&styles=${n}&cql_filter=${o}&bbox=${.5*(bboxX1+bboxX2)-maxValue-bufferBbox},${.5*(bboxY1+bboxY2)-maxValue-bufferBbox},${.5*(bboxX1+bboxX2)+maxValue+bufferBbox},${.5*(bboxY1+bboxY2)+maxValue+bufferBbox}&width=${t.options.width}&height=${t.options.height}&srs=EPSG%3A4326&format=image/png`;return $(`#${t.options.wmsId}`).attr("src",s),t}}),t}}),L.Geoserver.wms=function(t,e){return new L.Geoserver(t,e).wms()},L.Geoserver.wfs=function(t,e){return new L.Geoserver(t,e).wfs()},L.Geoserver.legend=function(t,e){return new L.Geoserver(t,e).legend()},L.Geoserver.wmsImage=function(t,e){return new L.Geoserver(t,e).wmsImage()}},3219:function(t,e){!function(t){"use strict";function e(t){var e,i,n,o;for(i=1,n=arguments.length;i<n;i++)for(e in o=arguments[i])t[e]=o[e];return t}var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function n(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}var o=0;function r(t){return t._leaflet_id=t._leaflet_id||++o,t._leaflet_id}function s(t,e,i){var n,o,r,s;return s=function(){n=!1,o&&(r.apply(i,o),o=!1)},r=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}}function a(t,e,i){var n=e[1],o=e[0],r=n-o;return t===n&&i?t:((t-o)%r+r)%r+o}function h(){return!1}function l(t,e){var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function c(t){return u(t).split(/\s+/)}function p(t,e){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?i(t.options):{}),e)t.options[n]=e[n];return t.options}function d(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}var f=/\{ *([\w_-]+) *\}/g;function g(t,e){return t.replace(f,function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})}var _=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function m(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function v(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var x=0;function w(t){var e=+new Date,i=Math.max(0,16-(e-x));return x=e+i,window.setTimeout(t,i)}var b=window.requestAnimationFrame||v("RequestAnimationFrame")||w,C=window.cancelAnimationFrame||v("CancelAnimationFrame")||v("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function M(t,e,i){if(!i||b!==w)return b.call(window,n(t,e));t.call(e)}function S(t){t&&C.call(window,t)}var T={extend:e,create:i,bind:n,lastId:o,stamp:r,throttle:s,wrapNum:a,falseFn:h,formatNum:l,trim:u,splitWords:c,setOptions:p,getParamString:d,template:g,isArray:_,indexOf:m,emptyImageUrl:y,requestFn:b,cancelFn:C,requestAnimFrame:M,cancelAnimFrame:S};function P(){}P.extend=function(t){var n=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},o=n.__super__=this.prototype,r=i(o);for(var s in r.constructor=n,n.prototype=r,this)Object.prototype.hasOwnProperty.call(this,s)&&"prototype"!==s&&"__super__"!==s&&(n[s]=this[s]);return t.statics&&(e(n,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=_(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),e.apply(null,[r].concat(t.includes)),delete t.includes),r.options&&(t.options=e(i(r.options),t.options)),e(r,t),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},n},P.include=function(t){return e(this.prototype,t),this},P.mergeOptions=function(t){return e(this.prototype.options,t),this},P.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var E={on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var o=0,r=(t=c(t)).length;o<r;o++)this._on(t[o],e,i);return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else for(var o=0,r=(t=c(t)).length;o<r;o++)this._off(t[o],e,i);else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(this._events[t]=n=[]),i===this&&(i=void 0);for(var o={fn:e,ctx:i},r=n,s=0,a=r.length;s<a;s++)if(r[s].fn===e&&r[s].ctx===i)return;r.push(o)},_off:function(t,e,i){var n,o,r;if(this._events&&(n=this._events[t]))if(e){if(i===this&&(i=void 0),n)for(o=0,r=n.length;o<r;o++){var s=n[o];if(s.ctx===i&&s.fn===e)return s.fn=h,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(o,1)}}else{for(o=0,r=n.length;o<r;o++)n[o].fn=h;delete this._events[t]}},fire:function(t,i,n){if(!this.listens(t,n))return this;var o=e({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var r=this._events[t];if(r){this._firingCount=this._firingCount+1||1;for(var s=0,a=r.length;s<a;s++){var h=r[s];h.fn.call(h.ctx||this,o)}this._firingCount--}}return n&&this._propagateEvent(o),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var o in t)this.once(o,t[o],e);return this}var r=n(function(){this.off(t,e,i).off(t,r,i)},this);return this.on(t,e,i).on(t,r,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[r(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[r(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};E.addEventListener=E.on,E.removeEventListener=E.clearAllEventListeners=E.off,E.addOneTimeEventListener=E.once,E.fireEvent=E.fire,E.hasEventListeners=E.listens;var A=P.extend(E);function R(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var O=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function Z(t,e,i){return t instanceof R?t:_(t)?new R(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new R(t.x,t.y):new R(t,e,i)}function I(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])}function k(t,e){return!t||t instanceof I?t:new I(t,e)}function N(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])}function F(t,e){return t instanceof N?t:new N(t,e)}function D(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function q(t,e,i){return t instanceof D?t:_(t)&&"object"!=typeof t[0]?3===t.length?new D(t[0],t[1],t[2]):2===t.length?new D(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new D(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new D(t,e,i)}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(t){return this.clone()._add(Z(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(Z(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new R(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new R(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=O(this.x),this.y=O(this.y),this},distanceTo:function(t){var e=(t=Z(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=Z(t)).x===this.x&&t.y===this.y},contains:function(t){return t=Z(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+l(this.x)+", "+l(this.y)+")"}},I.prototype={extend:function(t){return t=Z(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new R((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new R(this.min.x,this.max.y)},getTopRight:function(){return new R(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof R?Z(t):k(t))instanceof I?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=k(t);var e=this.min,i=this.max,n=t.min,o=t.max;return o.x>=e.x&&n.x<=i.x&&o.y>=e.y&&n.y<=i.y},overlaps:function(t){t=k(t);var e=this.min,i=this.max,n=t.min,o=t.max;return o.x>e.x&&n.x<i.x&&o.y>e.y&&n.y<i.y},isValid:function(){return!(!this.min||!this.max)}},N.prototype={extend:function(t){var e,i,n=this._southWest,o=this._northEast;if(t instanceof D)e=t,i=t;else{if(!(t instanceof N))return t?this.extend(q(t)||F(t)):this;if(i=t._northEast,!(e=t._southWest)||!i)return this}return n||o?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),o.lat=Math.max(i.lat,o.lat),o.lng=Math.max(i.lng,o.lng)):(this._southWest=new D(e.lat,e.lng),this._northEast=new D(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new N(new D(e.lat-n,e.lng-o),new D(i.lat+n,i.lng+o))},getCenter:function(){return new D((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new D(this.getNorth(),this.getWest())},getSouthEast:function(){return new D(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof D||"lat"in t?q(t):F(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof N?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=F(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast();return o.lat>=e.lat&&n.lat<=i.lat&&o.lng>=e.lng&&n.lng<=i.lng},overlaps:function(t){t=F(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast();return o.lat>e.lat&&n.lat<i.lat&&o.lng>e.lng&&n.lng<i.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=F(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},D.prototype={equals:function(t,e){return!!t&&(t=q(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+l(this.lat,t)+", "+l(this.lng,t)+")"},distanceTo:function(t){return G.distance(this,q(t))},wrap:function(){return G.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return F([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new D(this.lat,this.lng,this.alt)}};var z,j={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new I(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?a(t.lng,this.wrapLng,!0):t.lng;return new D(this.wrapLat?a(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,o=e.lng-i.lng;if(0===n&&0===o)return t;var r=t.getSouthWest(),s=t.getNorthEast();return new N(new D(r.lat-n,r.lng-o),new D(s.lat-n,s.lng-o))}},G=e({},j,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,r=Math.sin((e.lat-t.lat)*i/2),s=Math.sin((e.lng-t.lng)*i/2),a=r*r+Math.cos(n)*Math.cos(o)*s*s,h=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*h}}),U=6378137,B={R:U,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=Math.sin(n*e);return new R(this.R*t.lng*e,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var e=180/Math.PI;return new D((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(z=U*Math.PI,new I([-z,-z],[z,z]))};function W(t,e,i,n){if(_(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function Y(t,e,i,n){return new W(t,e,i,n)}W.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return t.x=(e=e||1)*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return new R((t.x/(e=e||1)-this._b)/this._a,(t.y/e-this._d)/this._c)}};var V,X=e({},G,{code:"EPSG:3857",projection:B,transformation:(V=.5/(Math.PI*B.R),Y(V,.5,-V,.5))}),H=e({},X,{code:"EPSG:900913"});function K(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function J(t,e){var i,n,o,r,s,a,h="";for(i=0,o=t.length;i<o;i++){for(n=0,r=(s=t[i]).length;n<r;n++)h+=(n?"L":"M")+(a=s[n]).x+" "+a.y;h+=e?At?"z":"x":""}return h||"M0 0"}var Q=document.documentElement.style,$="ActiveXObject"in window,tt=$&&!document.addEventListener,et="msLaunchUri"in navigator&&!("documentMode"in document),it=Rt("webkit"),nt=Rt("android"),ot=Rt("android 2")||Rt("android 3"),rt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),st=nt&&Rt("Google")&&rt<537&&!("AudioNode"in window),at=!!window.opera,ht=!et&&Rt("chrome"),lt=Rt("gecko")&&!it&&!at&&!$,ut=!ht&&Rt("safari"),ct=Rt("phantom"),pt="OTransition"in Q,dt=0===navigator.platform.indexOf("Win"),ft=$&&"transition"in Q,gt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ot,_t="MozPerspective"in Q,mt=!window.L_DISABLE_3D&&(ft||gt||_t)&&!pt&&!ct,yt="undefined"!=typeof orientation||Rt("mobile"),vt=yt&&it,xt=yt&&gt,wt=!window.PointerEvent&&window.MSPointerEvent,bt=!(!window.PointerEvent&&!wt),Ct=!window.L_NO_TOUCH&&(bt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Mt=yt&&at,St=yt&&lt,Tt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Pt=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",h,e),window.removeEventListener("testPassiveEventSupport",h,e)}catch(i){}return t}(),Et=!!document.createElement("canvas").getContext,At=!(!document.createElementNS||!K("svg").createSVGRect),Lt=!At&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(i){return!1}}();function Rt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Ot={ie:$,ielt9:tt,edge:et,webkit:it,android:nt,android23:ot,androidStock:st,opera:at,chrome:ht,gecko:lt,safari:ut,phantom:ct,opera12:pt,win:dt,ie3d:ft,webkit3d:gt,gecko3d:_t,any3d:mt,mobile:yt,mobileWebkit:vt,mobileWebkit3d:xt,msPointer:wt,pointer:bt,touch:Ct,mobileOpera:Mt,mobileGecko:St,retina:Tt,passiveEvents:Pt,canvas:Et,svg:At,vml:Lt},Zt=wt?"MSPointerDown":"pointerdown",It=wt?"MSPointerMove":"pointermove",kt=wt?"MSPointerUp":"pointerup",Nt=wt?"MSPointerCancel":"pointercancel",Ft={},Dt=!1;function qt(t){Ft[t.pointerId]=t}function zt(t){Ft[t.pointerId]&&(Ft[t.pointerId]=t)}function jt(t){delete Ft[t.pointerId]}function Gt(t,e){for(var i in t.touches=[],Ft)t.touches.push(Ft[i]);t.changedTouches=[t],e(t)}var Ut,Bt,Wt,Yt,Vt,Xt=wt?"MSPointerDown":bt?"pointerdown":"touchstart",Ht=wt?"MSPointerUp":bt?"pointerup":"touchend",Kt="_leaflet_",Jt=de(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qt=de(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),$t="webkitTransition"===Qt||"OTransition"===Qt?Qt+"End":"transitionend";function te(t){return"string"==typeof t?document.getElementById(t):t}function ee(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function ie(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function ne(t){var e=t.parentNode;e&&e.removeChild(t)}function oe(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function re(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function se(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ae(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=ce(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function he(t,e){if(void 0!==t.classList)for(var i=c(e),n=0,o=i.length;n<o;n++)t.classList.add(i[n]);else if(!ae(t,e)){var r=ce(t);ue(t,(r?r+" ":"")+e)}}function le(t,e){void 0!==t.classList?t.classList.remove(e):ue(t,u((" "+ce(t)+" ").replace(" "+e+" "," ")))}function ue(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function ce(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function pe(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(o){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}(t,e)}function de(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function fe(t,e,i){var n=e||new R(0,0);t.style[Jt]=(ft?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function ge(t,e){t._leaflet_pos=e,mt?fe(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function _e(t){return t._leaflet_pos||new R(0,0)}if("onselectstart"in document)Ut=function(){Se(window,"selectstart",ke)},Bt=function(){Pe(window,"selectstart",ke)};else{var me=de(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ut=function(){if(me){var t=document.documentElement.style;Wt=t[me],t[me]="none"}},Bt=function(){me&&(document.documentElement.style[me]=Wt,Wt=void 0)}}function ye(){Se(window,"dragstart",ke)}function ve(){Pe(window,"dragstart",ke)}function xe(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(we(),Yt=t,Vt=t.style.outline,t.style.outline="none",Se(window,"keydown",we))}function we(){Yt&&(Yt.style.outline=Vt,Yt=void 0,Vt=void 0,Pe(window,"keydown",we))}function be(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Ce(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Me={TRANSFORM:Jt,TRANSITION:Qt,TRANSITION_END:$t,get:te,getStyle:ee,create:ie,remove:ne,empty:oe,toFront:re,toBack:se,hasClass:ae,addClass:he,removeClass:le,setClass:ue,getClass:ce,setOpacity:pe,testProp:de,setTransform:fe,setPosition:ge,getPosition:_e,disableTextSelection:Ut,enableTextSelection:Bt,disableImageDrag:ye,enableImageDrag:ve,preventOutline:xe,restoreOutline:we,getSizedParentNode:be,getScale:Ce};function Se(t,e,i,n){if("object"==typeof e)for(var o in e)Le(t,o,e[o],i);else for(var r=0,s=(e=c(e)).length;r<s;r++)Le(t,e[r],i,n);return this}var Te="_leaflet_events";function Pe(t,e,i,n){if("object"==typeof e)for(var o in e)Re(t,o,e[o],i);else if(e)for(var r=0,s=(e=c(e)).length;r<s;r++)Re(t,e[r],i,n);else{for(var a in t[Te])Re(t,a,t[Te][a]);delete t[Te]}return this}function Ee(){if(bt)return!(et||ut)}var Ae={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Le(t,e,i,o){var s=e+r(i)+(o?"_"+r(o):"");if(t[Te]&&t[Te][s])return this;var a=function(e){return i.call(o||t,e||window.event)},h=a;bt&&0===e.indexOf("touch")?function(t,e,i,o){"touchstart"===e?function(t,e,i){var o=n(function(t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&ke(t),Gt(t,e)});t["_leaflet_touchstart"+i]=o,t.addEventListener(Zt,o,!1),Dt||(document.addEventListener(Zt,qt,!0),document.addEventListener(It,zt,!0),document.addEventListener(kt,jt,!0),document.addEventListener(Nt,jt,!0),Dt=!0)}(t,i,o):"touchmove"===e?function(t,e,i){var n=function(t){t.pointerType===(t.MSPOINTER_TYPE_MOUSE||"mouse")&&0===t.buttons||Gt(t,e)};t["_leaflet_touchmove"+i]=n,t.addEventListener(It,n,!1)}(t,i,o):"touchend"===e&&function(t,e,i){var n=function(t){Gt(t,e)};t["_leaflet_touchend"+i]=n,t.addEventListener(kt,n,!1),t.addEventListener(Nt,n,!1)}(t,i,o)}(t,e,a,s):Ct&&"dblclick"===e&&!Ee()?function(t,e,i){var n,o,r=!1;function s(t){if(bt){if(!t.isPrimary)return;if("mouse"===t.pointerType)return}else if(t.touches.length>1)return;var e=Date.now(),i=e-(n||e);o=t.touches?t.touches[0]:t,r=i>0&&i<=250,n=e}function a(t){if(r&&!o.cancelBubble){if(bt){if("mouse"===t.pointerType)return;var i,s,a={};for(s in o)a[s]=(i=o[s])&&i.bind?i.bind(o):i;o=a}o.type="dblclick",o.button=0,e(o),n=null}}t[Kt+Xt+i]=s,t[Kt+Ht+i]=a,t[Kt+"dblclick"+i]=e,t.addEventListener(Xt,s,!!Pt&&{passive:!1}),t.addEventListener(Ht,a,!!Pt&&{passive:!1}),t.addEventListener("dblclick",e,!1)}(t,a,s):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Ae[e]||e,a,!!Pt&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?t.addEventListener(Ae[e],a=function(e){e=e||window.event,Ue(t,e)&&h(e)},!1):t.addEventListener(e,h,!1):"attachEvent"in t&&t.attachEvent("on"+e,a),t[Te]=t[Te]||{},t[Te][s]=a}function Re(t,e,i,n){var o=e+r(i)+(n?"_"+r(n):""),s=t[Te]&&t[Te][o];if(!s)return this;bt&&0===e.indexOf("touch")?function(t,e,i){var n=t["_leaflet_"+e+i];"touchstart"===e?t.removeEventListener(Zt,n,!1):"touchmove"===e?t.removeEventListener(It,n,!1):"touchend"===e&&(t.removeEventListener(kt,n,!1),t.removeEventListener(Nt,n,!1))}(t,e,o):Ct&&"dblclick"===e&&!Ee()?function(t,e){var i=t[Kt+Ht+e],n=t[Kt+"dblclick"+e];t.removeEventListener(Xt,t[Kt+Xt+e],!!Pt&&{passive:!1}),t.removeEventListener(Ht,i,!!Pt&&{passive:!1}),t.removeEventListener("dblclick",n,!1)}(t,o):"removeEventListener"in t?t.removeEventListener(Ae[e]||e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[Te][o]=null}function Oe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,Ge(t),this}function Ze(t){return Le(t,"wheel",Oe),this}function Ie(t){return Se(t,"mousedown touchstart dblclick",Oe),Le(t,"click",je),this}function ke(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ne(t){return ke(t),Oe(t),this}function Fe(t,e){if(!e)return new R(t.clientX,t.clientY);var i=Ce(e),n=i.boundingClientRect;return new R((t.clientX-n.left)/i.x-e.clientLeft,(t.clientY-n.top)/i.y-e.clientTop)}var De=dt&&ht?2*window.devicePixelRatio:lt?window.devicePixelRatio:1;function qe(t){return et?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/De:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var ze={};function je(t){ze[t.type]=!0}function Ge(t){var e=ze[t.type];return ze[t.type]=!1,e}function Ue(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t}var Be={on:Se,off:Pe,stopPropagation:Oe,disableScrollPropagation:Ze,disableClickPropagation:Ie,preventDefault:ke,stop:Ne,getMousePosition:Fe,getWheelDelta:qe,fakeStop:je,skipped:Ge,isExternalTarget:Ue,addListener:Se,removeListener:Pe},We=A.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=_e(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),ge(this._el,i),this.fire("step")},_complete:function(){S(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Ye=A.extend({options:{crs:X,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=p(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=n(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(q(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qt&&mt&&!Mt&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Se(this._proxy,$t,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,n){return i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(q(t),i,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=e({animate:n.animate},n.zoom),n.pan=e({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,i),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t=t||(mt?this.options.zoomDelta:1)),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t=t||(mt?this.options.zoomDelta:1)),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),r=(t instanceof R?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),s=this.containerPointToLatLng(o.add(r));return this.setView(s,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():F(t);var i=Z(e.paddingTopLeft||e.padding||[0,0]),n=Z(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n));if((o="number"==typeof e.maxZoom?Math.min(e.maxZoom,o):o)===1/0)return{center:t.getCenter(),zoom:o};var r=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o);return{center:this.unproject(s.add(a).divideBy(2).add(r),o),zoom:o}},fitBounds:function(t,e){if(!(t=F(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=Z(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new We,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){he(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(!1===(i=i||{}).animate||!mt)return this.setView(t,e,i);this._stop();var n=this.project(this.getCenter()),o=this.project(t),r=this.getSize(),s=this._zoom;t=q(t),e=void 0===e?s:e;var a=Math.max(r.x,r.y),h=a*this.getZoomScale(s,e),l=o.distanceTo(n)||1,u=1.42,c=2.0164;function p(t){var e=(h*h-a*a+(t?-1:1)*c*c*l*l)/(2*(t?h:a)*c*l),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function d(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}var g=p(0);var _=Date.now(),m=(p(1)-g)/u,y=i.duration?1e3*i.duration:1e3*m*.8;return this._moveStart(!0,i.noMoveStart),(function i(){var r=(Date.now()-_)/y,h=function(t){return 1-Math.pow(1-t,1.5)}(r)*m;r<=1?(this._flyToFrame=M(i,this),this._move(this.unproject(n.add(o.subtract(n).multiplyBy(function(t){return a*(f(g)*(d(e=g+u*t)/f(e))-d(g))/c;var e}(h)/l)),s),this.getScaleZoom(a/function(t){return a*(f(g)/f(g+u*t))}(h),s),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}).call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return(t=F(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,F(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},panInside:function(t,e){var i=Z((e=e||{}).paddingTopLeft||e.padding||[0,0]),n=Z(e.paddingBottomRight||e.padding||[0,0]),o=this.getCenter(),r=this.project(o),s=this.project(t),a=this.getPixelBounds(),h=a.getSize().divideBy(2),l=k([a.min.add(i),a.max.subtract(n)]);if(!l.contains(s)){this._enforcingBounds=!0;var u=r.subtract(s),c=Z(s.x+u.x,s.y+u.y);(s.x<l.min.x||s.x>l.max.x)&&(c.x=r.x-u.x,u.x>0?c.x+=h.x-i.x:c.x-=h.x-n.x),(s.y<l.min.y||s.y>l.max.y)&&(c.y=r.y-u.y,u.y>0?c.y+=h.y-i.y:c.y-=h.y-n.y),this.panTo(this.unproject(c),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var i=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var o=this.getSize(),r=i.divideBy(2).round(),s=o.divideBy(2).round(),a=r.subtract(s);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(n(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:o})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var i=n(this._handleGeolocationResponse,this),o=n(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,o,t):navigator.geolocation.getCurrentPosition(i,o,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=new D(t.coords.latitude,t.coords.longitude),i=e.toBounds(2*t.coords.accuracy),n=this._locateOptions;if(n.setView){var o=this.getBoundsZoom(i);this.setView(e,n.maxZoom?Math.min(o,n.maxZoom):o)}var r={latlng:e,bounds:i,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(r[s]=t.coords[s]);this.fire("locationfound",r)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ne(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(S(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)ne(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=ie("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new N(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=F(t),i=Z(i||[0,0]);var n=this.getZoom()||0,o=this.getMinZoom(),r=this.getMaxZoom(),s=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(i),l=k(this.project(a,n),this.project(s,n)).getSize(),u=mt?this.options.zoomSnap:1,c=h.x/l.x,p=h.y/l.y,d=e?Math.max(c,p):Math.min(c,p);return n=this.getScaleZoom(d,n),u&&(n=Math.round(n/(u/100))*(u/100),n=e?Math.ceil(n/u)*u:Math.floor(n/u)*u),Math.max(o,Math.min(r,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new I(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs,n=i.zoom(t*i.scale(e=void 0===e?this._zoom:e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(q(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(Z(t),e)},layerPointToLatLng:function(t){var e=Z(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(q(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(q(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(F(t))},distance:function(t,e){return this.options.crs.distance(q(t),q(e))},containerPointToLayerPoint:function(t){return Z(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return Z(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(Z(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(t)))},mouseEventToContainerPoint:function(t){return Fe(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=te(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Se(e,"scroll",this._onScroll,this),this._containerId=r(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&mt,he(t,"leaflet-container"+(Ct?" leaflet-touch":"")+(Tt?" leaflet-retina":"")+(tt?" leaflet-oldie":"")+(ut?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=ee(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ge(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(he(t.markerPane,"leaflet-zoom-hide"),he(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){ge(this._mapPane,new R(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n,!1)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return S(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ge(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[r(this._container)]=this;var e=t?Pe:Se;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),mt&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){S(this._resizeRequest),this._resizeRequest=M(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],o="mouseout"===e||"mouseover"===e,s=t.target||t.srcElement,a=!1;s;){if((i=this._targets[r(s)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(o&&!Ue(s,t))break;if(n.push(i),o)break}if(s===this._container)break;s=s.parentNode}return n.length||a||o||!Ue(s,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!Ge(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e&&"keyup"!==e&&"keydown"!==e||xe(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,n){if("click"===t.type){var o=e({},t);o.type="preclick",this._fireDOMEvent(o,o.type,n)}if(!t._stopped&&(n=(n||[]).concat(this._findEventTargets(t,i))).length){var r=n[0];"contextmenu"===i&&r.listens(i,!0)&&ke(t);var s={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var a=r.getLatLng&&(!r._radius||r._radius<=10);s.containerPoint=a?this.latLngToContainerPoint(r.getLatLng()):this.mouseEventToContainerPoint(t),s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=a?r.getLatLng():this.layerPointToLatLng(s.layerPoint)}for(var h=0;h<n.length;h++)if(n[h].fire(i,s,!0),s.originalEvent._stopped||!1===n[h].options.bubblingMouseEvents&&-1!==m(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return _e(this._mapPane)||new R(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return k([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),r=new I(n.subtract(o),n.add(o)),s=this._getBoundsOffset(r,i,e);return s.round().equals([0,0])?t:this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new I(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=k(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),o=n.min.subtract(t.min),r=n.max.subtract(t.max);return new R(this._rebound(o.x,-r.x),this._rebound(o.y,-r.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=mt?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){le(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i)||(this.panBy(i,e),0))},_createAnimProxy:function(){var t=this._proxy=ie("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=Jt,i=this._proxy.style[e];fe(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ne(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();fe(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(o)||(M(function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)},this),0))},_animateZoom:function(t,e,i,o){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,he(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:o}),setTimeout(n(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&le(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),M(function(){this._moveEnd(!0)},this))}}),Ve=P.extend({options:{position:"topright"},initialize:function(t){p(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return he(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ne(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Xe=function(t){return new Ve(t)};Ye.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=ie("div",e+"control-container",this._container);function n(n,o){t[n+o]=ie("div",e+n+" "+e+o,i)}n("top","left"),n("top","right"),n("bottom","left"),n("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ne(this._controlCorners[t]);ne(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var He=Ve.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){for(var n in p(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Ve.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){he(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(he(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):le(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return le(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=ie("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Ie(e),Ze(e);var n=this._section=ie("section",t+"-list");i&&(this._map.on("click",this.collapse,this),nt||Se(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var o=this._layersLink=ie("a",t+"-toggle",e);o.href="#",o.title="Layers",Ct?(Se(o,"click",Ne),Se(o,"click",this.expand,this)):Se(o,"focus",this.expand,this),i||this.expand(),this._baseLayersList=ie("div",t+"-base",n),this._separator=ie("div",t+"-separator",n),this._overlaysList=ie("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(n(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;oe(this._baseLayersList),oe(this._overlaysList),this._layerControlInputs=[];var t,e,i,n,o=0;for(i=0;i<this._layers.length;i++)this._addItem(n=this._layers[i]),e=e||n.overlay,t=t||!n.overlay,o+=n.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(t=t&&o>1)?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers_"+r(this),n),this._layerControlInputs.push(e),e.layerId=r(t.layer),Se(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var s=document.createElement("div");return i.appendChild(s),s.appendChild(e),s.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i=this._layerControlInputs,n=[],o=[];this._handlingClick=!0;for(var r=i.length-1;r>=0;r--)e=this._getLayer((t=i[r]).layerId).layer,t.checked?n.push(e):t.checked||o.push(e);for(r=0;r<o.length;r++)this._map.hasLayer(o[r])&&this._map.removeLayer(o[r]);for(r=0;r<n.length;r++)this._map.hasLayer(n[r])||this._map.addLayer(n[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,n=this._map.getZoom(),o=i.length-1;o>=0;o--)e=this._getLayer((t=i[o]).layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Ke=Ve.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=ie("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,o){var r=ie("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,r.setAttribute("role","button"),r.setAttribute("aria-label",e),Ie(r),Se(r,"click",Ne),Se(r,"click",o,this),Se(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";le(this._zoomInButton,e),le(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&he(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&he(this._zoomInButton,e)}});Ye.mergeOptions({zoomControl:!0}),Ye.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ke,this.addControl(this.zoomControl))});var Je=Ve.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=ie("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=ie("div",e,i)),t.imperial&&(this._iScale=ie("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t);this._updateScale(this._mScale,e<1e3?e+" m":e/1e3+" km",e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(i=this._getRoundNum(e=o/5280),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)}}),Qe=Ve.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){p(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=ie("div","leaflet-control-attribution"),Ie(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}});Ye.mergeOptions({attributionControl:!0}),Ye.addInitHook(function(){this.options.attributionControl&&(new Qe).addTo(this)}),Ve.Layers=He,Ve.Zoom=Ke,Ve.Scale=Je,Ve.Attribution=Qe,Xe.layers=function(t,e,i){return new He(t,e,i)},Xe.zoom=function(t){return new Ke(t)},Xe.scale=function(t){return new Je(t)},Xe.attribution=function(t){return new Qe(t)};var $e=P.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});$e.addTo=function(t,e){return t.addHandler(e,this),this};var ti,ei={Events:E},ii=Ct?"touchstart mousedown":"mousedown",ni={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},oi={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},ri=A.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){p(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Se(this._dragStartTarget,ii,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ri._dragging===this&&this.finishDrag(),Pe(this._dragStartTarget,ii,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!ae(this._element,"leaflet-zoom-anim")&&!(ri._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(ri._dragging=this,this._preventOutline&&xe(this._element),ye(),Ut(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t,i=be(this._element);this._startPoint=new R(e.clientX,e.clientY),this._parentScale=Ce(i),Se(document,oi[t.type],this._onMove,this),Se(document,ni[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new R(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,ke(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=_e(this._element).subtract(i),he(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),he(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,S(this._animRequest),this._lastEvent=t,this._animRequest=M(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ge(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in le(document.body,"leaflet-dragging"),this._lastTarget&&(le(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),oi)Pe(document,oi[t],this._onMove,this),Pe(document,ni[t],this._onUp,this);ve(),Bt(),this._moved&&this._moving&&(S(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,ri._dragging=!1}});function si(t,e){if(!e||!t.length)return t.slice();var i=e*e;return function(t,e){var i=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,hi(t,n,e,0,i-1);var o,r=[];for(o=0;o<i;o++)n[o]&&r.push(t[o]);return r}(t=function(t,e){for(var i=[t[0]],n=1,o=0,r=t.length;n<r;n++)h=void 0,l=void 0,(h=(a=t[o]).x-(s=t[n]).x)*h+(l=a.y-s.y)*l>e&&(i.push(t[n]),o=n);var s,a,h,l;return o<r-1&&i.push(t[r-1]),i}(t,i),i)}function ai(t,e,i){return Math.sqrt(pi(t,e,i,!0))}function hi(t,e,i,n,o){var r,s,a,h=0;for(s=n+1;s<=o-1;s++)(a=pi(t[s],t[n],t[o],!0))>h&&(r=s,h=a);h>i&&(e[r]=1,hi(t,e,i,n,r),hi(t,e,i,r,o))}function li(t,e,i,n,o){var r,s,a,h=n?ti:ci(t,i),l=ci(e,i);for(ti=l;;){if(!(h|l))return[t,e];if(h&l)return!1;a=ci(s=ui(t,e,r=h||l,i,o),i),r===h?(t=s,h=a):(e=s,l=a)}}function ui(t,e,i,n,o){var r,s,a=e.x-t.x,h=e.y-t.y,l=n.min,u=n.max;return 8&i?(r=t.x+a*(u.y-t.y)/h,s=u.y):4&i?(r=t.x+a*(l.y-t.y)/h,s=l.y):2&i?(r=u.x,s=t.y+h*(u.x-t.x)/a):1&i&&(r=l.x,s=t.y+h*(l.x-t.x)/a),new R(r,s,o)}function ci(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function pi(t,e,i,n){var o,r=e.x,s=e.y,a=i.x-r,h=i.y-s,l=a*a+h*h;return l>0&&((o=((t.x-r)*a+(t.y-s)*h)/l)>1?(r=i.x,s=i.y):o>0&&(r+=a*o,s+=h*o)),a=t.x-r,h=t.y-s,n?a*a+h*h:new R(r,s)}function di(t){return!_(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function fi(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),di(t)}var gi={simplify:si,pointToSegmentDistance:ai,closestPointOnSegment:function(t,e,i){return pi(t,e,i)},clipSegment:li,_getEdgeIntersection:ui,_getBitCode:ci,_sqClosestPointOnSegment:pi,isFlat:di,_flat:fi};function _i(t,e,i){var n,o,r,s,a,h,l,u,c,p=[1,4,2,8];for(o=0,l=t.length;o<l;o++)t[o]._code=ci(t[o],e);for(s=0;s<4;s++){for(u=p[s],n=[],o=0,r=(l=t.length)-1;o<l;r=o++)h=t[r],(a=t[o])._code&u?h._code&u||((c=ui(h,a,u,e,i))._code=ci(c,e),n.push(c)):(h._code&u&&((c=ui(h,a,u,e,i))._code=ci(c,e),n.push(c)),n.push(a));t=n}return t}var mi={clipPolygon:_i},yi={project:function(t){return new R(t.lng,t.lat)},unproject:function(t){return new D(t.y,t.x)},bounds:new I([-180,-90],[180,90])},vi={R:6378137,R_MINOR:6356752.314245179,bounds:new I([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,o=this.R_MINOR/i,r=Math.sqrt(1-o*o),s=r*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),r/2);return n=-i*Math.log(Math.max(a,1e-10)),new R(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,o=this.R_MINOR/n,r=Math.sqrt(1-o*o),s=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(s),h=0,l=.1;h<15&&Math.abs(l)>1e-7;h++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),a+=l=Math.PI/2-2*Math.atan(s*e)-a;return new D(a*i,t.x*i/n)}},xi={LonLat:yi,Mercator:vi,SphericalMercator:B},wi=e({},G,{code:"EPSG:3395",projection:vi,transformation:function(){var t=.5/(Math.PI*vi.R);return Y(t,.5,-t,.5)}()}),bi=e({},G,{code:"EPSG:4326",projection:yi,transformation:Y(1/180,1,-1/180,.5)}),Ci=e({},j,{projection:yi,transformation:Y(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});j.Earth=G,j.EPSG3395=wi,j.EPSG3857=X,j.EPSG900913=H,j.EPSG4326=bi,j.Simple=Ci;var Mi=A.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[r(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[r(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});Ye.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=r(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=r(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&r(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?_(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[r(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=r(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=void 0===o.minZoom?t:Math.min(t,o.minZoom),e=void 0===o.maxZoom?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Si=Mi.extend({initialize:function(t,e){var i,n;if(p(this,e),this._layers={},t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r(t)}}),Ti=Si.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Si.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Si.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new N;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Pi=P.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){p(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var o=Z(n),r=Z("shadow"===e&&i.shadowAnchor||i.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Tt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Ei=Pi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Ei.imagePath||(Ei.imagePath=this._detectIconPath()),(this.options.imagePath||Ei.imagePath)+Pi.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=ie("div","leaflet-default-icon-path",document.body),e=ee(t,"background-image")||ee(t,"backgroundImage");return document.body.removeChild(t),null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Ai=$e.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new ri(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),he(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&le(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,r=_e(e._icon),s=i.getPixelBounds(),a=i.getPixelOrigin(),h=k(s.min._subtract(a).add(o),s.max._subtract(a).subtract(o));if(!h.contains(r)){var l=Z((Math.max(h.max.x,r.x)-h.max.x)/(s.max.x-h.max.x)-(Math.min(h.min.x,r.x)-h.min.x)/(s.min.x-h.min.x),(Math.max(h.max.y,r.y)-h.max.y)/(s.max.y-h.max.y)-(Math.min(h.min.y,r.y)-h.min.y)/(s.min.y-h.min.y)).multiplyBy(n);i.panBy(l,{animate:!1}),this._draggable._newPos._add(l),this._draggable._startPos._add(l),ge(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=M(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(S(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=_e(e._icon),o=e._map.layerPointToLatLng(n);i&&ge(i,n),e._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){S(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Li=Mi.extend({options:{icon:new Ei,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){p(this,e),this._latlng=q(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=q(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),he(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var o=t.icon.createShadow(this._shadow),r=!1;o!==this._shadow&&(this._removeShadow(),r=!0),o&&(he(o,e),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&r&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ne(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ne(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ge(this._icon,t),this._shadow&&ge(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(he(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ai)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ai(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&pe(this._icon,t),this._shadow&&pe(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Ri=Mi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return p(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Oi=Ri.extend({options:{fill:!0,radius:10},initialize:function(t,e){p(this,e),this._latlng=q(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=q(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Ri.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new I(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Zi=Oi.extend({initialize:function(t,i,n){if("number"==typeof i&&(i=e({},n,{radius:i})),p(this,i),this._latlng=q(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new N(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Ri.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===G.distance){var o=Math.PI/180,r=this._mRadius/G.R/o,s=i.project([e+r,t]),a=i.project([e-r,t]),h=s.add(a).divideBy(2),l=i.unproject(h).lat,u=Math.acos((Math.cos(r*o)-Math.sin(e*o)*Math.sin(l*o))/(Math.cos(e*o)*Math.cos(l*o)))/o;(isNaN(u)||0===u)&&(u=r/Math.cos(Math.PI/180*e)),this._point=h.subtract(i.getPixelOrigin()),this._radius=isNaN(u)?0:h.x-i.project([l,t-u]).x,this._radiusY=h.y-s.y}else{var c=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(c).x}this._updateBounds()}}),Ii=Ri.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){p(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,o=null,r=pi,s=0,a=this._parts.length;s<a;s++)for(var h=this._parts[s],l=1,u=h.length;l<u;l++){var c=r(t,e=h[l-1],i=h[l],!0);c<n&&(n=c,o=r(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,r,s,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,e=0;t<h-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<h-1;t++)if((n+=i=(o=a[t]).distanceTo(r=a[t+1]))>e)return this._map.layerPointToLatLng([r.x-(s=(n-e)/i)*(r.x-o.x),r.y-s*(r.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=q(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new N,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return di(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=di(t),n=0,o=t.length;n<o;n++)i?(e[n]=q(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new I;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new R(t,t);this._pxBounds=new I([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)])},_projectLatlngs:function(t,e,i){var n,o,r=t.length;if(t[0]instanceof D){for(o=[],n=0;n<r;n++)o[n]=this._map.latLngToLayerPoint(t[n]),i.extend(o[n]);e.push(o)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,o,r,s,a,h=this._parts;for(e=0,n=0,o=this._rings.length;e<o;e++)for(i=0,r=(a=this._rings[e]).length;i<r-1;i++)(s=li(a[i],a[i+1],t,i,!0))&&(h[n]=h[n]||[],h[n].push(s[0]),s[1]===a[i+1]&&i!==r-2||(h[n].push(s[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=si(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,o,r,s,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;i<r;i++)for(n=0,o=(s=(a=this._parts[i]).length)-1;n<s;o=n++)if((e||0!==n)&&ai(t,a[o],a[n])<=h)return!0;return!1}});Ii._flat=fi;var ki=Ii.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,r,s,a,h=this._rings[0],l=h.length;if(!l)return null;for(r=s=a=0,t=0,e=l-1;t<l;e=t++)s+=((i=h[t]).x+(n=h[e]).x)*(o=i.y*n.x-n.y*i.x),a+=(i.y+n.y)*o,r+=3*o;return this._map.layerPointToLatLng(0===r?h[0]:[s/r,a/r])},_convertLatLngs:function(t){var e=Ii.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof D&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){Ii.prototype._setLatLngs.call(this,t),di(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return di(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new R(e,e);if(t=new I(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,o=0,r=this._rings.length;o<r;o++)(n=_i(this._rings[o],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,o,r,s,a,h,l=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(r=0,s=(h=(e=this._parts[o]).length)-1;r<h;s=r++)(i=e[r]).y>t.y!=(n=e[s]).y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(l=!l);return l||Ii.prototype._containsPoint.call(this,t,!0)}}),Ni=Ti.extend({initialize:function(t,e){p(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=_(t)?t:t.features;if(o){for(e=0,i=o.length;e<i;e++)((n=o[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var s=Fi(t,r);return s?(s.feature=Bi(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Fi(t,e){var i,n,o,r,s="Feature"===t.type?t.geometry:t,a=s?s.coordinates:null,h=[],l=e&&e.pointToLayer,u=e&&e.coordsToLatLng||qi;if(!a&&!s)return null;switch(s.type){case"Point":return Di(l,t,i=u(a),e);case"MultiPoint":for(o=0,r=a.length;o<r;o++)i=u(a[o]),h.push(Di(l,t,i,e));return new Ti(h);case"LineString":case"MultiLineString":return n=zi(a,"LineString"===s.type?0:1,u),new Ii(n,e);case"Polygon":case"MultiPolygon":return n=zi(a,"Polygon"===s.type?1:2,u),new ki(n,e);case"GeometryCollection":for(o=0,r=s.geometries.length;o<r;o++){var c=Fi({geometry:s.geometries[o],type:"Feature",properties:t.properties},e);c&&h.push(c)}return new Ti(h);default:throw new Error("Invalid GeoJSON object.")}}function Di(t,e,i,n){return t?t(e,i):new Li(i,n&&n.markersInheritOptions&&n)}function qi(t){return new D(t[1],t[0],t[2])}function zi(t,e,i){for(var n,o=[],r=0,s=t.length;r<s;r++)n=e?zi(t[r],e-1,i):(i||qi)(t[r]),o.push(n);return o}function ji(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[l(t.lng,e),l(t.lat,e),l(t.alt,e)]:[l(t.lng,e),l(t.lat,e)]}function Gi(t,e,i,n){for(var o=[],r=0,s=t.length;r<s;r++)o.push(e?Gi(t[r],e-1,i,n):ji(t[r],n));return!e&&i&&o.push(o[0]),o}function Ui(t,i){return t.feature?e({},t.feature,{geometry:i}):Bi(i)}function Bi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Wi={toGeoJSON:function(t){return Ui(this,{type:"Point",coordinates:ji(this.getLatLng(),t)})}};function Yi(t,e){return new Ni(t,e)}Li.include(Wi),Zi.include(Wi),Oi.include(Wi),Ii.include({toGeoJSON:function(t){var e=!di(this._latlngs);return Ui(this,{type:(e?"Multi":"")+"LineString",coordinates:Gi(this._latlngs,e?1:0,!1,t)})}}),ki.include({toGeoJSON:function(t){var e=!di(this._latlngs),i=e&&!di(this._latlngs[0]),n=Gi(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),Ui(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Si.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(i){e.push(i.toGeoJSON(t).geometry.coordinates)}),Ui(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer(function(e){if(e.toGeoJSON){var o=e.toGeoJSON(t);if(i)n.push(o.geometry);else{var r=Bi(o);"FeatureCollection"===r.type?n.push.apply(n,r.features):n.push(r)}}}),i?Ui(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var Vi=Yi,Xi=Mi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=F(e),p(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(he(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ne(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&re(this._image),this},bringToBack:function(){return this._map&&se(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=F(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:ie("img");he(e,"leaflet-image-layer"),this._zoomAnimated&&he(e,"leaflet-zoom-animated"),this.options.className&&he(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onload=n(this.fire,this,"load"),e.onerror=n(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;fe(this._image,i,e)},_reset:function(){var t=this._image,e=new I(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();ge(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){pe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Hi=Xi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:ie("video");if(he(e,"leaflet-image-layer"),this._zoomAnimated&&he(e,"leaflet-zoom-animated"),this.options.className&&he(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onloadeddata=n(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),o=[],r=0;r<i.length;r++)o.push(i[r].src);this._url=i.length>0?o:[e.src]}else{_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted;for(var s=0;s<this._url.length;s++){var a=ie("source");a.src=this._url[s],e.appendChild(a)}}}}),Ki=Xi.extend({_initImage:function(){var t=this._image=this._url;he(t,"leaflet-image-layer"),this._zoomAnimated&&he(t,"leaflet-zoom-animated"),this.options.className&&he(t,this.options.className),t.onselectstart=h,t.onmousemove=h}}),Ji=Mi.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){p(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&pe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&pe(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(pe(this._container,0),this._removeTimeout=setTimeout(n(ne,void 0,this._container),200)):ne(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=q(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&re(this._container),this},bringToBack:function(){return this._map&&se(this._container),this},_prepareOpen:function(t,e,i){if(e instanceof Mi||(i=e,e=t),e instanceof Ti)for(var n in t._layers){e=t._layers[n];break}if(!i)if(e.getCenter)i=e.getCenter();else{if(!e.getLatLng)throw new Error("Unable to get source layer LatLng.");i=e.getLatLng()}return this._source=e,this.update(),i},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=Z(this.options.offset),i=this._getAnchor();this._zoomAnimated?ge(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}}),Qi=Ji.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Ji.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ri||this._source.on("preclick",Oe))},onRemove:function(t){Ji.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ri||this._source.off("preclick",Oe))},getEvents:function(){var t=Ji.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=ie("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=ie("div",t+"-content-wrapper",e);if(this._contentNode=ie("div",t+"-content",i),Ie(e),Ze(this._contentNode),Se(e,"contextmenu",Oe),this._tipContainer=ie("div",t+"-tip-container",e),this._tip=ie("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=ie("a",t+"-close-button",e);n.href="#close",n.innerHTML="&#215;",Se(n,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=this.options.maxHeight,o="leaflet-popup-scrolled";n&&t.offsetHeight>n?(e.height=n+"px",he(t,o)):le(t,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();ge(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var t=this._map,e=parseInt(ee(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,o=new R(this._containerLeft,-i-this._containerBottom);o._add(_e(this._container));var r=t.layerPointToContainerPoint(o),s=Z(this.options.autoPanPadding),a=Z(this.options.autoPanPaddingTopLeft||s),h=Z(this.options.autoPanPaddingBottomRight||s),l=t.getSize(),u=0,c=0;r.x+n+h.x>l.x&&(u=r.x+n-l.x+h.x),r.x-u-a.x<0&&(u=r.x-a.x),r.y+i+h.y>l.y&&(c=r.y+i-l.y+h.y),r.y-c-a.y<0&&(c=r.y-a.y),(u||c)&&t.fire("autopanstart").panBy([u,c])}},_onCloseButtonClick:function(t){this._close(),Ne(t)},_getAnchor:function(){return Z(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Ye.mergeOptions({closePopupOnClick:!0}),Ye.include({openPopup:function(t,e,i){return t instanceof Qi||(t=new Qi(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Mi.include({bindPopup:function(t,e){return t instanceof Qi?(p(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new Qi(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){return this._popup&&this._map&&(e=this._popup._prepareOpen(this,t,e),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(Ne(t),e instanceof Ri?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var $i=Ji.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Ji.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Ji.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Ji.prototype.getEvents.call(this);return Ct&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=ie("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,n=this._map,o=this._container,r=n.latLngToContainerPoint(n.getCenter()),s=n.layerPointToContainerPoint(t),a=this.options.direction,h=o.offsetWidth,l=o.offsetHeight,u=Z(this.options.offset),c=this._getAnchor();"top"===a?(e=h/2,i=l):"bottom"===a?(e=h/2,i=0):"center"===a?(e=h/2,i=l/2):"right"===a?(e=0,i=l/2):"left"===a?(e=h,i=l/2):s.x<r.x?(a="right",e=0,i=l/2):(a="left",e=h+2*(u.x+c.x),i=l/2),t=t.subtract(Z(e,i,!0)).add(u).add(c),le(o,"leaflet-tooltip-right"),le(o,"leaflet-tooltip-left"),le(o,"leaflet-tooltip-top"),le(o,"leaflet-tooltip-bottom"),he(o,"leaflet-tooltip-"+a),ge(o,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&pe(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return Z(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Ye.include({openTooltip:function(t,e,i){return t instanceof $i||(t=new $i(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Mi.include({bindTooltip:function(t,e){return t instanceof $i?(p(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new $i(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),Ct&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){return this._tooltip&&this._map&&(e=this._tooltip._prepareOpen(this,t,e),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(he(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(le(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){this._tooltip&&this._map&&this.openTooltip(t.layer||t.target,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}});var tn=Pi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(oe(e),e.appendChild(i.html)):e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=Z(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Pi.Default=Ei;var en=Mi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:yt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){p(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ne(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(re(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(se(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof R?t:new R(t,t)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),o=0,r=i.length;o<r;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!tt){pe(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var o=this._tiles[n];if(o.current&&o.loaded){var r=Math.min(1,(t-o.loaded)/200);pe(o.el,r),r<1?e=!0:(o.active?i=!0:this._onOpaqueTile(o),o.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(S(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=ie("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(ne(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var n=this._levels[t],o=this._map;return n||((n=this._levels[t]={}).el=ie("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ne(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,n){var o=Math.floor(t/2),r=Math.floor(e/2),s=i-1,a=new R(+o,+r);a.z=+s;var h=this._tileCoordsToKey(a),l=this._tiles[h];return l&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),s>n&&this._retainParent(o,r,s,n))},_retainChildren:function(t,e,i,n){for(var o=2*t;o<2*t+2;o++)for(var r=2*e;r<2*e+2;r++){var s=new R(o,r);s.z=i+1;var a=this._tileCoordsToKey(s),h=this._tiles[a];h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),i+1<n&&this._retainChildren(o,r,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,n){var o=Math.round(e);o=void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom?void 0:this._clampZoom(o),n&&!(this.options.updateWhenZooming&&o!==this._tileZoom)||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),o=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();mt?fe(t.el,o,n):ge(t.el,o)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),o=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*n);return new I(o.subtract(r),o.add(r))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(n),r=o.getCenter(),s=[],a=this.options.keepBuffer,h=new I(o.getBottomLeft().subtract([a,-a]),o.getTopRight().add([a,-a]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var l in this._tiles){var u=this._tiles[l].coords;u.z===this._tileZoom&&h.contains(new R(u.x,u.y))||(this._tiles[l].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var c=o.min.y;c<=o.max.y;c++)for(var p=o.min.x;p<=o.max.x;p++){var d=new R(p,c);if(d.z=this._tileZoom,this._isValidTile(d)){var f=this._tiles[this._tileCoordsToKey(d)];f?f.current=!0:s.push(d)}}if(s.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)}),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var g=document.createDocumentFragment();for(p=0;p<s.length;p++)this._addTile(s[p],g);this._level.el.appendChild(g)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return F(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),o=n.add(i);return[e.unproject(n,t.z),e.unproject(o,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new N(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new R(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(ne(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){he(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=h,t.onmousemove=h,tt&&this.options.opacity<1&&pe(t,this.options.opacity),nt&&!ot&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),o=this._tileCoordsToKey(t),r=this.createTile(this._wrapCoords(t),n(this._tileReady,this,t));this._initTile(r),this.createTile.length<2&&M(n(this._tileReady,this,t,null,r)),ge(r,i),this._tiles[o]={el:r,coords:t,current:!0},e.appendChild(r),this.fire("tileloadstart",{tile:r,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var o=this._tileCoordsToKey(t);(i=this._tiles[o])&&(i.loaded=+new Date,this._map._fadeAnimated?(pe(i.el,0),S(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(he(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),tt||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(n(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new R(this._wrapX?a(t.x,this._wrapX):t.x,this._wrapY?a(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new I(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),nn=en.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=p(this,e)).detectRetina&&Tt&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),nt||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Se(i,"load",n(this._tileOnLoad,this,e,i)),Se(i,"error",n(this._tileOnError,this,e,i)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i.alt="",i.setAttribute("role","presentation"),i.src=this.getTileUrl(t),i},getTileUrl:function(t){var i={r:Tt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(i.y=n),i["-y"]=n}return g(this._url,e(i,this.options))},_tileOnLoad:function(t,e){tt?setTimeout(n(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.getAttribute("src")!==n&&(e.src=n),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom;return this.options.zoomReverse&&(t=this.options.maxZoom-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=h,e.onerror=h,e.complete||(e.src=y,ne(e),delete this._tiles[t]))},_removeTile:function(t){var e=this._tiles[t];if(e)return st||e.el.setAttribute("src",y),en.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(this._map&&(!i||i.getAttribute("src")!==y))return en.prototype._tileReady.call(this,t,e,i)}});function on(t,e){return new nn(t,e)}var rn=nn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var n=e({},this.defaultWmsParams);for(var o in i)o in this.options||(n[o]=i[o]);var r=(i=p(this,i)).detectRetina&&Tt?2:1,s=this.getTileSize();n.width=s.x*r,n.height=s.y*r,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,nn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,n=k(i.project(e[0]),i.project(e[1])),o=n.min,r=n.max,s=(this._wmsVersion>=1.3&&this._crs===bi?[o.y,o.x,r.y,r.x]:[o.x,o.y,r.x,r.y]).join(","),a=nn.prototype.getTileUrl.call(this,t);return a+d(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,i){return e(this.wmsParams,t),i||this.redraw(),this}});nn.WMS=rn,on.wms=function(t,e){return new rn(t,e)};var sn=Mi.extend({options:{padding:.1,tolerance:0},initialize:function(t){p(this,t),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&he(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=_e(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),s=this._map.project(t,e).subtract(r),a=o.multiplyBy(-i).add(n).add(o).subtract(s);mt?fe(this._container,a,i):ge(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new I(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),an=sn.extend({getEvents:function(){var t=sn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){sn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Se(t,"mousemove",this._onMouseMove,this),Se(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Se(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){S(this._redrawRequest),delete this._ctx,ne(this._container),Pe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){sn.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=Tt?2:1;ge(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Tt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){sn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[r(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[r(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,i,n=t.options.dashArray.split(/[, ]+/),o=[];for(i=0;i<n.length;i++){if(e=Number(n[i]),isNaN(e))return;o.push(e)}t.options._dashArray=o}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new I,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,o,r,s=t._parts,a=s.length,h=this._ctx;if(a){for(h.beginPath(),i=0;i<a;i++){for(n=0,o=s[i].length;n<o;n++)h[n?"lineTo":"moveTo"]((r=s[i][n]).x,r.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),o=(Math.max(Math.round(t._radiusY),1)||n)/n;1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(n)&&("click"!==t.type&&"preclick"===t.type||!this._map._draggableMoved(e))&&(i=e);i&&(je(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(le(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,o,r=this._drawFirst;r;r=r.next)(i=r.layer).options.interactive&&i._containsPoint(e)&&(o=i);o!==this._hoveredLayer&&(this._handleMouseOut(t),o&&(he(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseover"),this._hoveredLayer=o)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(n(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function hn(t){return Et?new an(t):null}var ln=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),un={_initContainer:function(){this._container=ie("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(sn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=ln("shape");he(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=ln("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ne(e),t.removeInteractiveTarget(e),delete this._layers[r(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(e||(e=t._stroke=ln("stroke")),o.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,e.dashStyle=n.dashArray?_(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):"",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(o.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=ln("fill")),o.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(o.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){re(t._container)},_bringToBack:function(t){se(t._container)}},cn=Lt?ln:K,pn=sn.extend({getEvents:function(){var t=sn.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=cn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=cn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ne(this._container),Pe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){sn.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),ge(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=cn("path");t.options.className&&he(e,t.options.className),t.options.interactive&&he(e,"leaflet-interactive"),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ne(t._path),t.removeInteractiveTarget(t._path),delete this._layers[r(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,J(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),n="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,o)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){re(t._path)},_bringToBack:function(t){se(t._path)}});function dn(t){return At||Lt?new pn(t):null}Lt&&pn.include(un),Ye.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&hn(t)||dn(t)}});var fn=ki.extend({initialize:function(t,e){ki.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=F(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});pn.create=cn,pn.pointsToPath=J,Ni.geometryToLayer=Fi,Ni.coordsToLatLng=qi,Ni.coordsToLatLngs=zi,Ni.latLngToCoords=ji,Ni.latLngsToCoords=Gi,Ni.getFeature=Ui,Ni.asFeature=Bi,Ye.mergeOptions({boxZoom:!0});var gn=$e.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Se(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Pe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ne(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Ut(),ye(),this._startPoint=this._map.mouseEventToContainerPoint(t),Se(document,{contextmenu:Ne,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ie("div","leaflet-zoom-box",this._container),he(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new I(this._point,this._startPoint),i=e.getSize();ge(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(ne(this._box),le(this._container,"leaflet-crosshair")),Bt(),ve(),Pe(document,{contextmenu:Ne,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(n(this._resetState,this),0);var e=new N(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});Ye.addInitHook("addHandler","boxZoom",gn),Ye.mergeOptions({doubleClickZoom:!0});var _n=$e.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}});Ye.addInitHook("addHandler","doubleClickZoom",_n),Ye.mergeOptions({dragging:!0,inertia:!ot,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var mn=$e.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new ri(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}he(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){le(this._map._container,"leaflet-grab"),le(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=F(this._map.options.maxBounds);this._offsetLimit=k(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,s=Math.abs(o+i)<Math.abs(r+i)?o:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{this._prunePositions(+new Date);var o=this._lastPos.subtract(this._positions[0]),r=i.easeLinearity,s=o.multiplyBy(r/((this._lastTime-this._times[0])/1e3)),a=s.distanceTo([0,0]),h=Math.min(i.inertiaMaxSpeed,a),l=s.multiplyBy(h/a),u=h/(i.inertiaDeceleration*r),c=l.multiplyBy(-u/2).round();c.x||c.y?(c=e._limitOffset(c,e.options.maxBounds),M(function(){e.panBy(c,{duration:u,easeLinearity:r,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}});Ye.addInitHook("addHandler","dragging",mn),Ye.mergeOptions({keyboard:!0,keyboardPanDelta:80});var yn=$e.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Se(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Pe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){Se(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Pe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys)n._panAnim&&n._panAnim._inProgress||(e=this._panKeys[i],t.shiftKey&&(e=Z(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds));else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Ne(t)}}});Ye.addInitHook("addHandler","keyboard",yn),Ye.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var vn=$e.extend({addHooks:function(){Se(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Pe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=qe(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(n(this._performZoom,this),o),Ne(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,o=i?Math.ceil(n/i)*i:n,r=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}});Ye.addInitHook("addHandler","scrollWheelZoom",vn),Ye.mergeOptions({tap:!0,tapTolerance:15});var xn=$e.extend({addHooks:function(){Se(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Pe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(ke(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new R(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&he(i,"leaflet-active"),this._holdTimeout=setTimeout(n(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),Se(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),Pe(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&le(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new R(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}});!Ct||bt&&!ut||Ye.addInitHook("addHandler","tap",xn),Ye.mergeOptions({touchZoom:Ct&&!ot,bounceAtZoomLimits:!0});var wn=$e.extend({addHooks:function(){he(this._map._container,"leaflet-touch-zoom"),Se(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){le(this._map._container,"leaflet-touch-zoom"),Pe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Se(document,"touchmove",this._onTouchMove,this),Se(document,"touchend",this._onTouchEnd,this),ke(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]),r=i.distanceTo(o)/this._startDist;if(this._zoom=e.getScaleZoom(r,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&r<1||this._zoom>e.getMaxZoom()&&r>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{var s=i._add(o)._divideBy(2)._subtract(this._centerPoint);if(1===r&&0===s.x&&0===s.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),S(this._animRequest);var a=n(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=M(a,this,!0),ke(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,S(this._animRequest),Pe(document,"touchmove",this._onTouchMove,this),Pe(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Ye.addInitHook("addHandler","touchZoom",wn),Ye.BoxZoom=gn,Ye.DoubleClickZoom=_n,Ye.Drag=mn,Ye.Keyboard=yn,Ye.ScrollWheelZoom=vn,Ye.Tap=xn,Ye.TouchZoom=wn,t.version="1.7.1",t.Control=Ve,t.control=Xe,t.Browser=Ot,t.Evented=A,t.Mixin=ei,t.Util=T,t.Class=P,t.Handler=$e,t.extend=e,t.bind=n,t.stamp=r,t.setOptions=p,t.DomEvent=Be,t.DomUtil=Me,t.PosAnimation=We,t.Draggable=ri,t.LineUtil=gi,t.PolyUtil=mi,t.Point=R,t.point=Z,t.Bounds=I,t.bounds=k,t.Transformation=W,t.transformation=Y,t.Projection=xi,t.LatLng=D,t.latLng=q,t.LatLngBounds=N,t.latLngBounds=F,t.CRS=j,t.GeoJSON=Ni,t.geoJSON=Yi,t.geoJson=Vi,t.Layer=Mi,t.LayerGroup=Si,t.layerGroup=function(t,e){return new Si(t,e)},t.FeatureGroup=Ti,t.featureGroup=function(t,e){return new Ti(t,e)},t.ImageOverlay=Xi,t.imageOverlay=function(t,e,i){return new Xi(t,e,i)},t.VideoOverlay=Hi,t.videoOverlay=function(t,e,i){return new Hi(t,e,i)},t.SVGOverlay=Ki,t.svgOverlay=function(t,e,i){return new Ki(t,e,i)},t.DivOverlay=Ji,t.Popup=Qi,t.popup=function(t,e){return new Qi(t,e)},t.Tooltip=$i,t.tooltip=function(t,e){return new $i(t,e)},t.Icon=Pi,t.icon=function(t){return new Pi(t)},t.DivIcon=tn,t.divIcon=function(t){return new tn(t)},t.Marker=Li,t.marker=function(t,e){return new Li(t,e)},t.TileLayer=nn,t.tileLayer=on,t.GridLayer=en,t.gridLayer=function(t){return new en(t)},t.SVG=pn,t.svg=dn,t.Renderer=sn,t.Canvas=an,t.canvas=hn,t.Path=Ri,t.CircleMarker=Oi,t.circleMarker=function(t,e){return new Oi(t,e)},t.Circle=Zi,t.circle=function(t,e,i){return new Zi(t,e,i)},t.Polyline=Ii,t.polyline=function(t,e){return new Ii(t,e)},t.Polygon=ki,t.polygon=function(t,e){return new ki(t,e)},t.Rectangle=fn,t.rectangle=function(t,e){return new fn(t,e)},t.Map=Ye,t.map=function(t,e){return new Ye(t,e)};var bn=window.L;t.noConflict=function(){return window.L=bn,this},window.L=t}(e)},8782:function(t){t.exports=function(){"use strict";function t(t,n,o,r,s){!function t(i,n,o,r,s){for(;r>o;){if(r-o>600){var a=r-o+1,h=n-o+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(h-a/2<0?-1:1);t(i,n,Math.max(o,Math.floor(n-h*u/a+c)),Math.min(r,Math.floor(n+(a-h)*u/a+c)),s)}var p=i[n],d=o,f=r;for(e(i,o,n),s(i[r],p)>0&&e(i,o,r);d<f;){for(e(i,d,f),d++,f--;s(i[d],p)<0;)d++;for(;s(i[f],p)>0;)f--}0===s(i[o],p)?e(i,o,f):e(i,++f,r),f<=n&&(o=f+1),n<=f&&(r=f-1)}}(t,n,o||0,r||t.length-1,s||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function r(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,o){o||(o=f(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var r=e;r<i;r++){var s=t.children[r];a(o,t.leaf?n(s):s)}return o}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,n,o,r){for(var s=[i,n];s.length;)if(!((n=s.pop())-(i=s.pop())<=o)){var a=i+Math.ceil((n-i)/o/2)*o;t(e,a,i,n,r),s.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!d(t,e))return i;for(var n=this.toBBox,o=[];e;){for(var r=0;r<e.children.length;r++){var s=e.children[r],a=e.leaf?n(s):s;d(t,a)&&(e.leaf?i.push(s):p(t,a)?this._all(s,i):o.push(s))}e=o.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var o=e.children[n],r=e.leaf?this.toBBox(o):o;if(d(t,r)){if(e.leaf||p(t,r))return!0;i.push(o)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=f([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,r,s=this.data,a=this.toBBox(t),h=[],l=[];s||h.length;){if(s||(s=h.pop(),n=h[h.length-1],i=l.pop(),r=!0),s.leaf){var u=o(t,s.children,e);if(-1!==u)return s.children.splice(u,1),h.push(s),this._condense(h),this}r||s.leaf||!p(s,a)?n?(i++,s=n.children[i],r=!1):s=null:(h.push(s),l.push(i),i=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var o,s=i-e+1,a=this._maxEntries;if(s<=a)return r(o=f(t.slice(e,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(o=f([])).leaf=!1,o.height=n;var h=Math.ceil(s/a),l=h*Math.ceil(Math.sqrt(a));g(t,e,i,l,this.compareMinX);for(var u=e;u<=i;u+=l){var c=Math.min(u+l-1,i);g(t,u,c,h,this.compareMinY);for(var p=u;p<=c;p+=h){var d=Math.min(p+h-1,c);o.children.push(this._build(t,p,d,n-1))}}return r(o,this.toBBox),o},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var o=1/0,r=1/0,s=void 0,a=0;a<e.children.length;a++){var h=e.children[a],l=u(h),c=(p=t,d=h,(Math.max(d.maxX,p.maxX)-Math.min(d.minX,p.minX))*(Math.max(d.maxY,p.maxY)-Math.min(d.minY,p.minY))-l);c<r?(r=c,o=l<o?l:o,s=h):c===r&&l<o&&(o=l,s=h)}e=s||e.children[0]}var p,d;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),o=[],r=this._chooseSubtree(n,this.data,e,o);for(r.children.push(t),a(r,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var s=this._chooseSplitIndex(i,o,n),a=f(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,r(i,this.toBBox),r(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,o,r,a,h,l,c,p=1/0,d=1/0,f=e;f<=i-e;f++){var g=s(t,0,f,this.toBBox),_=s(t,f,i,this.toBBox),m=(o=g,r=_,a=Math.max(o.minX,r.minX),h=Math.max(o.minY,r.minY),l=Math.min(o.maxX,r.maxX),c=Math.min(o.maxY,r.maxY),Math.max(0,l-a)*Math.max(0,c-h)),y=u(g)+u(_);m<p?(p=m,n=f,d=y<d?y:d):m===p&&y<d&&(d=y,n=f)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:h,o=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,o)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var o=this.toBBox,r=s(t,0,e,o),h=s(t,i-e,i,o),l=c(r)+c(h),u=e;u<i-e;u++){var p=t.children[u];a(r,t.leaf?o(p):p),l+=c(r)}for(var d=i-e-1;d>=e;d--){var f=t.children[d];a(h,t.leaf?o(f):f),l+=c(h)}return l},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():r(t[e],this.toBBox)},n}()},1821:function(t){"use strict";t.exports=function(){function t(t){return void 0!==t}function e(t,i,n){if(t.nodeType===x.CDATA_SECTION||t.nodeType===x.TEXT)n.push(i?String(t.nodeValue).replace(/(\r\n|\r|\n)/g,""):t.nodeValue);else for(t=t.firstChild;t;t=t.nextSibling)e(t,i,n);return n}function i(t){for(t=t.nextElementSibling||t.nextSibling;t&&t.nodeType!==x.ELEMENT;)t=t.nextSibling;return t}function n(e,i,n){var o;n=t(n)?n:{};var r=0;for(o=e.length;r<o;++r)n[e[r]]=i;return n}function o(e,i){return function(n,o){n=e.call(t(i)?i:this,n,o),t(n)&&o[o.length-1].push(n)}}function r(e,n,o,r,s){for(r.push(e),e=o.firstElementChild||o.firstChild;e&&e.nodeType!==x.ELEMENT;)e=e.nextSibling;for(;e;e=i(e))t(o=n[e.namespaceURI||null])&&t(o=o[e.localName])&&o.call(s,e,r);return r.pop()}function s(e,i,n){return function(o,r){var s=e.call(t(n)?n:this,o,r);t(s)&&((r=r[r.length-1])[o=t(i)?i:o.localName]=s)}}function a(e,i,n){return function(o,r){var s=e.call(t(n)?n:this,o,r);t(s)&&(r=r[r.length-1],((o=t(i)?i:o.localName)in r?r[o]:r[o]=[]).push(s))}}function h(e){if(e=/^\s*(true|1)|(false|0)\s*$/.exec(e))return t(e[1])||!1}function l(t){return u(e(t,!1,[]).join(""))}function u(t){if(t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t))return parseFloat(t[1])}function c(t){return p(e(t,!1,[]).join(""))}function p(t){if(t=/^\s*(\d+)\s*$/.exec(t))return parseInt(t[1],10)}function d(t){return e(t,!1,[]).join("").replace(b,"")}function f(t){return t.getAttributeNS("http://www.w3.org/1999/xlink","href")}function g(t){return[u(t.getAttribute("minx")),u(t.getAttribute("miny")),u(t.getAttribute("maxx")),u(t.getAttribute("maxy"))]}function _(t,e){return r({},q,t,e)}function m(t,e){return r({},k,t,e)}function y(e,i){if(t(i=_(e,i)))return e=[p(e.getAttribute("width")),p(e.getAttribute("height"))],i.size=e,i}function v(t,e){return r([],z,t,e)}var x={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},w=function(t){this._parser=new t};w.prototype.toDocument=function(t){return this._parser.parseFromString(t,"application/xml")},w.prototype.getAllTextContent=function(t,i){return e(t,i,[]).join("").join("")};var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,C=[null,"http://www.opengis.net/wms"],M=n(C,{Service:s(function(t,e){return r({},T,t,e)}),Capability:s(function(t,e){return r({},S,t,e)})}),S=n(C,{Request:s(function(t,e){return r({},I,t,e)}),Exception:s(function(t,e){return r([],L,t,e)}),Layer:s(function(e,i){var n=h(e.getAttribute("queryable"));return r({queryable:!!t(n)&&n},R,e,i)})}),T=n(C,{Name:s(d),Title:s(d),Abstract:s(d),KeywordList:s(v),OnlineResource:s(f),ContactInformation:s(function(t,e){return r({},P,t,e)}),Fees:s(d),AccessConstraints:s(d),LayerLimit:s(c),MaxWidth:s(c),MaxHeight:s(c)}),P=n(C,{ContactPersonPrimary:s(function(t,e){return r({},E,t,e)}),ContactPosition:s(d),ContactAddress:s(function(t,e){return r({},A,t,e)}),ContactVoiceTelephone:s(d),ContactFacsimileTelephone:s(d),ContactElectronicMailAddress:s(d)}),E=n(C,{ContactPerson:s(d),ContactOrganization:s(d)}),A=n(C,{AddressType:s(d),Address:s(d),City:s(d),StateOrProvince:s(d),PostCode:s(d),Country:s(d)}),L=n(C,{Format:o(d)}),R=n(C,{Name:s(d),Title:s(d),Abstract:s(d),KeywordList:s(v),CRS:a(d),SRS:a(d),EX_GeographicBoundingBox:s(function(e,i){var n=r({},Z,e,i);if(t(n)){e=n.westBoundLongitude,i=n.southBoundLatitude;var o=n.eastBoundLongitude;if(n=n.northBoundLatitude,t(e)&&t(i)&&t(o)&&t(n))return[e,i,o,n]}}),LatLonBoundingBox:s(function(e,i){if(t((e=g(e))[0])&&t(e[1])&&t(e[2])&&t(e[3]))return e}),BoundingBox:a(function(t,e){e=g(t);var i=[u(t.getAttribute("resx")),u(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS")||t.getAttribute("SRS"),extent:e,res:i}}),Dimension:a(function(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:h(t.getAttribute("multipleValues")),nearestValue:h(t.getAttribute("nearestValue")),current:h(t.getAttribute("current")),values:d(t)}}),Attribution:s(function(t,e){return r({},O,t,e)}),AuthorityURL:a(function(e,i){if(t(i=_(e,i)))return i.name=e.getAttribute("name"),i}),Identifier:a(d),MetadataURL:a(function(e,i){if(t(i=_(e,i)))return i.type=e.getAttribute("type"),i}),DataURL:a(_),FeatureListURL:a(_),Style:a(function(t,e){return r({},D,t,e)}),MinScaleDenominator:s(l),MaxScaleDenominator:s(l),ScaleHint:s(function(t,e){return{min:parseFloat(t.getAttribute("min")),max:t=parseFloat(t.getAttribute("max"))}}),Layer:a(function(e,i){var n=i[i.length-1];if(t(i=r({},R,e,i))){var o=h(e.getAttribute("queryable"));t(o)||(o=n.queryable),i.queryable=!!t(o)&&o,t(o=p(e.getAttribute("cascaded")))||(o=n.cascaded),i.cascaded=o,t(o=h(e.getAttribute("opaque")))||(o=n.opaque),i.opaque=!!t(o)&&o,t(o=h(e.getAttribute("noSubsets")))||(o=n.noSubsets),i.noSubsets=!!t(o)&&o,t(o=u(e.getAttribute("fixedWidth")))||(o=n.fixedWidth),i.fixedWidth=o,t(e=u(e.getAttribute("fixedHeight")))||(e=n.fixedHeight),i.fixedHeight=e,o=0;for(var s=(e=["Style","CRS","AuthorityURL"]).length;o<s;o++){var a=e[o],l=n[a];if(t(l)){var c=[];c=(c=a in i?i[a]:i[a]=c).concat(l),i[a]=c}}for(o=0,s=(e="EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator".split(" ")).length;o<s;o++)t(i[a=e[o]])||(i[a]=n[a]);return i}})}),O=n(C,{Title:s(d),OnlineResource:s(f),LogoURL:s(y)}),Z=n(C,{westBoundLongitude:s(l),eastBoundLongitude:s(l),southBoundLatitude:s(l),northBoundLatitude:s(l)}),I=n(C,{GetCapabilities:s(m),GetMap:s(m),GetFeatureInfo:s(m)}),k=n(C,{Format:a(d),DCPType:a(function(t,e){return r({},N,t,e)})}),N=n(C,{HTTP:s(function(t,e){return r({},F,t,e)})}),F=n(C,{Get:s(_),Post:s(_)}),D=n(C,{Name:s(d),Title:s(d),Abstract:s(d),LegendURL:a(y),StyleSheetURL:s(_),StyleURL:s(_)}),q=n(C,{Format:s(d),OnlineResource:s(f)}),z=n(C,{Keyword:o(d)});return(C=function(t,e){e||"undefined"==typeof window||(e=window.DOMParser),this.version=void 0,this._parser=new w(e),this._data=t}).prototype.data=function(t){return this._data=t,this},C.prototype.toJSON=function(t){return this.parse(t=t||this._data)},C.prototype.parse=function(t){return this.readFromDocument(this._parser.toDocument(t))},C.prototype.readFromDocument=function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType==x.ELEMENT)return this.readFromNode(t);return null},C.prototype.readFromNode=function(t){return this.version=t.getAttribute("version"),r({version:this.version},M,t,[])||null},C}()},3700:(t,e,i)=>{"use strict";i.r(e),i.d(e,{AdminModule:()=>e_});var n=i(1116),o=i(1041),r=i(8709),s=i(529),a=i(5366),h=i(2693),l=i(8512);let u=(()=>{class t{constructor(){this.data=new l.X(""),this.toolid=new l.X(""),this.nodeBoundary=new l.X(""),this.data$=this.data.asObservable(),this.toolid$=this.toolid.asObservable(),this.nodeBoundary$=this.nodeBoundary.asObservable()}changeData(t){console.log(t),this.data.next(t)}passGIStoolid(t){console.log(t),this.toolid.next(t)}sharenodeBoundary(t){console.log(t),this.nodeBoundary.next(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var c=i(3219),p=i(1821),d=i.n(p);i(7806);let f=(()=>{class t{constructor(t,e){this.dataShare=t,this.http=e,this.baseMapObj={},this.CLS="NODE_1647202549:sample_flask_cluster_output",this.layerArry=["SAMPLE_DATA_TWO_234:sample_flask"],this.loadingData=!1,this.dataShare.data$.subscribe(t=>{console.log(t),t&&t.table_name.forEach(e=>{this.x(t.workspace_name+":sample_flask_"+e),console.log(t.workspace_name+":sample_flask_"+e)})}),this.dataShare.nodeBoundary$.subscribe(t=>{t&&this.x(t.workspace+":"+t.sample_flask)})}ngOnInit(){this.addmaptoInterface(),this.map.on("click",t=>{var e=Math.trunc(this.map.layerPointToContainerPoint(t.layerPoint).x),i=Math.trunc(this.map.layerPointToContainerPoint(t.layerPoint).y);console.log(this.map.getBounds());var n=this.map.options.crs.project(this.map.getBounds().getSouthWest()),o=this.map.options.crs.project(this.map.getBounds().getNorthEast()),r=n.x+","+n.y+","+o.x+","+o.y,s=this.map.getSize().x,a=this.map.getSize().y;console.log(s),console.log(a),console.log(r),this.http.get("/geoserver/wms/?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&layers="+this.CLS+"&BBOX=-60118.851818977884,7023773.519754961,-59761.1504131746,7024282.900888765&FEATURE_COUNT=1&info_format=application/json&HEIGHT="+a+"&WIDTH="+s+"&query_layers="+this.CLS+"&SRS=EPSG%3A27700&buffer=15&X="+e+"&Y="+i).subscribe(e=>{console.log(e),c.popup().setLatLng([t.latlng.lat,t.latlng.lng]).setContent(`\n      <p>GIS ToolID: ${e.features[0].properties.gistool_id}<p>\n      <p>Cluster ID: ${e.features[0].properties.cluster_id}<p>\n\n      `).openOn(this.map),this.dataShare.passGIStoolid(e.features[0].properties.gistool_id)})})}x(t){this.loadingData=!0,this.wmsLayes(t)}addmaptoInterface(){this.map=c.map("map").fitBounds([[1.48275,103.581653],[1.16647,104.134244]]),this.map.options.maxZoom=24,c.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:24,maxNativeZoom:23,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map)}wmsLayes(t){console.log(t);var e=c.Geoserver.wms("/geoserver/wms",{layers:t,maxZoom:24,maxNativeZoom:23});console.log(e),e.addTo(this.map),this.http.get("/geoserver/wms?service=wms&version=1.1.1&request=GetCapabilities",{responseType:"text"}).subscribe(e=>{var i,n;console.log("response received");const o=new(d())(e).toJSON(),r=null===(n=null===(i=null==o?void 0:o.Capability)||void 0===i?void 0:i.Layer)||void 0===n?void 0:n.Layer,s=null==r?void 0:r.filter(e=>e.Name===t)[0],a=null==s?void 0:s.LatLonBoundingBox;this.map.fitBounds([[a[1],a[0]],[a[3],a[2]]])},t=>{console.error("Request failed with error")},()=>{console.error("Request completed")})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(u),a.Y36(h.eN))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-geoserver-map"]],decls:1,vars:0,consts:[["id","map",1,"map",2,"width","100%","height","92vh"]],template:function(t,e){1&t&&a._UZ(0,"div",0)},styles:["#map[_ngcontent-%COMP%]{border:1px solid #000}"]}),t})();function g(t,e){1&t&&(a.TgZ(0,"div",9),a._UZ(1,"div",10),a.qZA())}function _(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"form",11),a.TgZ(1,"h4",12),a._uU(2," Cluster Grouping "),a.qZA(),a.TgZ(3,"div",11),a.TgZ(4,"label",13),a._uU(5,"Select Cluster type"),a.qZA(),a.TgZ(6,"select",14),a.NdJ("ngModelChange",function(e){return a.CHM(t),a.oxw().connectiopnType=e}),a.TgZ(7,"option",15),a._uU(8,"Arial"),a.qZA(),a.TgZ(9,"option",16),a._uU(10,"Underground"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(11,"div",11),a.TgZ(12,"label",13),a._uU(13,"Choose files for Demand points"),a.qZA(),a.TgZ(14,"input",17),a.NdJ("change",function(e){return a.CHM(t),a.oxw().filesDropped(e,"demandpoints")}),a.qZA(),a.qZA(),a.TgZ(15,"div",18),a.TgZ(16,"label",13),a._uU(17,"Choose files for Street lines"),a.qZA(),a.TgZ(18,"input",19),a.NdJ("change",function(e){return a.CHM(t),a.oxw().filesDropped(e,"streetlines")}),a.qZA(),a.qZA(),a.TgZ(19,"button",20),a.NdJ("click",function(){return a.CHM(t),a.oxw().submitCLusturing()}),a._uU(20," Execute "),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(6),a.Q6J("ngModel",t.connectiopnType)}}function m(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"form",11),a.TgZ(1,"h4",12),a._uU(2," Node Boundary "),a.qZA(),a.TgZ(3,"div",11),a.TgZ(4,"label",21),a._uU(5,"Output from cluster grouping already uploaded"),a.qZA(),a._UZ(6,"input",22),a.qZA(),a.TgZ(7,"div",23),a.TgZ(8,"label",13),a._uU(9,"Choose files for Land boundary"),a.qZA(),a.TgZ(10,"input",19),a.NdJ("change",function(e){return a.CHM(t),a.oxw().filesDropped(e,"landbndry")}),a.qZA(),a.qZA(),a.TgZ(11,"button",24),a.NdJ("click",function(){return a.CHM(t),a.oxw().submitNodeBoundary()}),a._uU(12," Execute "),a.qZA(),a.qZA()}}function y(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"form",25),a.TgZ(1,"div",26),a.TgZ(2,"button",27),a.NdJ("click",function(){return a.CHM(t),a.oxw().fallbackClusterCorrection()}),a._uU(3," Move on to Cluster Correction "),a.qZA(),a.TgZ(4,"button",27),a.NdJ("click",function(){return a.CHM(t),a.oxw().fallbackNodePlacement()}),a._uU(5," Move on to Node placement "),a.qZA(),a.qZA(),a.qZA()}}function v(t,e){if(1&t&&(a.TgZ(0,"tr"),a.TgZ(1,"td"),a._uU(2),a.qZA(),a.TgZ(3,"td"),a._uU(4),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(2),a.Oqu(t.cluster_id),a.xp6(2),a.Oqu(t.sum_pon_homes)}}function x(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",28),a.TgZ(1,"h4",12),a._uU(2," Cluster Correction "),a.qZA(),a.TgZ(3,"div",29),a.TgZ(4,"table",30),a.TgZ(5,"thead"),a.TgZ(6,"th"),a._uU(7,"Cluster Id"),a.qZA(),a.TgZ(8,"th"),a._uU(9,"Sum Pon Homes"),a.qZA(),a.qZA(),a.TgZ(10,"tbody"),a.YNc(11,v,5,2,"tr",31),a.qZA(),a.qZA(),a.qZA(),a.TgZ(12,"form",32),a.NdJ("ngSubmit",function(){return a.CHM(t),a.oxw().onSubmitClusterCorrection()}),a.TgZ(13,"div",23),a.TgZ(14,"label",33),a._uU(15,"Input Cluster Id"),a.qZA(),a._UZ(16,"input",34),a.qZA(),a.TgZ(17,"div",11),a.TgZ(18,"label",33),a._uU(19,"Output Cluster Id"),a.qZA(),a._UZ(20,"input",35),a.qZA(),a.TgZ(21,"div",11),a.TgZ(22,"label",36),a._uU(23,"GIS Tool Id"),a.qZA(),a._UZ(24,"input",37),a.qZA(),a.TgZ(25,"div",38),a.TgZ(26,"button",39),a._uU(27,"Execute"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(28,"div",40),a.TgZ(29,"button",41),a._uU(30," Go to Node Boundary "),a.qZA(),a.TgZ(31,"button",41),a._uU(32," Node Placements "),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(11),a.Q6J("ngForOf",t.outliers_data),a.xp6(1),a.Q6J("formGroup",t.clusterCorrectionForm)}}function w(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",28),a.TgZ(1,"form"),a.TgZ(2,"h4",12),a._uU(3," Node Placement "),a.qZA(),a.TgZ(4,"div",11),a.TgZ(5,"label",42),a._uU(6,"Select CLuster type"),a.qZA(),a.TgZ(7,"select",43),a.NdJ("ngModelChange",function(e){return a.CHM(t),a.oxw().connectiopnTypeNodePlacement=e}),a.TgZ(8,"option",44),a._uU(9,"Arial"),a.qZA(),a.TgZ(10,"option",16),a._uU(11,"Underground"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(12,"div",18),a.TgZ(13,"label",42),a._uU(14,"Choose files for Existing"),a.qZA(),a.TgZ(15,"input",45),a.NdJ("change",function(e){return a.CHM(t),a.oxw().filesDropped(e,"existing")}),a.qZA(),a.qZA(),a.TgZ(16,"div",18),a.TgZ(17,"label",42),a._uU(18,"Choose files for Gaist"),a.qZA(),a.TgZ(19,"input",45),a.NdJ("change",function(e){return a.CHM(t),a.oxw().filesDropped(e,"gaist")}),a.qZA(),a.qZA(),a.TgZ(20,"div",18),a.TgZ(21,"label",42),a._uU(22,"Choose files for LandBoundary"),a.qZA(),a.TgZ(23,"input",45),a.NdJ("change",function(e){return a.CHM(t),a.oxw().filesDropped(e,"landBoundary")}),a.qZA(),a.qZA(),a.TgZ(24,"div",18),a.TgZ(25,"label",42),a._uU(26,"Choose files for Node"),a.qZA(),a.TgZ(27,"input",46),a.NdJ("change",function(e){return a.CHM(t),a.oxw().filesDropped(e,"node")}),a.qZA(),a.qZA(),a.TgZ(28,"div",40),a.TgZ(29,"button",27),a.NdJ("click",function(){return a.CHM(t),a.oxw().submitNodePlacement()}),a._uU(30," Execute "),a.qZA(),a.qZA(),a.qZA(),a.TgZ(31,"div",40),a.TgZ(32,"button",41),a._uU(33," Go to Node Boundary "),a.qZA(),a.TgZ(34,"button",41),a._uU(35," Node Placements "),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(7),a.Q6J("ngModel",t.connectiopnTypeNodePlacement)}}let b=(()=>{class t{constructor(t,e,i){this.httpClient=t,this.dataShare=e,this.formBuilder=i,this.connectiopnType="",this.connectiopnTypeNodePlacement="1",this.clusteringFormShow=!0,this.nodeBoundaryShow=!1,this.clusterCorrectionShow=!1,this.clusterCorrectionProcess=!1,this.nodePlacementProcess=!1,this.outliers_data=[],this.loadingLoader=!1,this.files=[],this.files2=[],this.uploadedFiles=[],this.toolID="",this.dataShare.toolid$.subscribe(t=>{console.log(t),this.toolID=t,this.ngOnInit()})}ngOnInit(){this.clusterCorrectionForm=this.formBuilder.group({input_cluster_id:[""],output_cluster_id:[""],gis_tool_id:[this.toolID]}),this.clusteringForm=this.formBuilder.group({input_cluster_id:[""],output_cluster_id:[""],gis_tool_id:[""]})}get f(){return this.clusterCorrectionForm.controls}onSubmitClusterCorrection(){console.log(this.clusterCorrectionForm.valid),console.log(this.clusterCorrectionForm.value);const t=new FormData;t.append("input_cluster_id",this.clusterCorrectionForm.value.input_cluster_id),t.append("output_cluster_id",this.clusterCorrectionForm.value.output_cluster_id),t.append("gis_tool_id",this.clusterCorrectionForm.value.gis_tool_id),this.httpClient.post(s.N.api+"/api/update_db",t).subscribe(t=>{console.log(t),this.outliers_data=[];for(var e=0;e<t.cluster_id.length;e++)console.log(t.cluster_id[e]),this.outliers_data.push({cluster_id:t.cluster_id[e],sum_pon_homes:t.sum_pon_homes[e]}),this.dataShare.sharenodeBoundary({workspace:t.workspace_name,sample_flask:t.table_name})})}submitCLusturing(){this.clusteringFormShow=!1,this.nodeBoundaryShow=!0,this.clusterCorrectionShow=!0,console.log(this.connectiopnType);const t=new FormData;this.uploadedFiles.forEach(e=>{"demandpoints"==e.fileType&&t.append("demandpoints",e.file)}),this.uploadedFiles.forEach(e=>{"streetlines"==e.fileType&&t.append("streetlines",e.file)}),this.loadingLoader=!0,"1"===this.connectiopnType?this.httpClient.post(s.N.api+"/api/aerial_page",t).subscribe(t=>{console.log(t),this.dataShare.changeData(t),this.loadingLoader=!1}):"2"===this.connectiopnType&&this.httpClient.post(s.N.api+"/api/ug_page",t).subscribe(t=>{console.log(t),this.dataShare.changeData(t)})}submitNodeBoundary(){this.clusteringFormShow=!1,this.clusterCorrectionShow=!0;const t=new FormData;this.uploadedFiles.forEach(e=>{"landbndry"==e.fileType&&t.append("landbndry",e.file)}),this.loadingLoader=!0,this.httpClient.post(s.N.api+"/api/nb_page",t).subscribe(t=>{console.log(t),this.dataShare.sharenodeBoundary(t),this.loadingLoader=!1})}fallbackClusterCorrection(){this.clusteringFormShow=!1,this.nodeBoundaryShow=!1,this.clusterCorrectionShow=!1,this.nodePlacementProcess=!1,this.clusterCorrectionProcess=!0,this.clusterCorrectionProcess&&this.httpClient.get("/api/load_data").subscribe(t=>{console.log(t);for(var e=0;e<t.cluster_id.length;e++)console.log(t.cluster_id[e]),this.outliers_data.push({cluster_id:t.cluster_id[e],sum_pon_homes:t.sum_pon_homes[e]});console.log(this.outliers_data)})}fallbackNodePlacement(){this.clusteringFormShow=!1,this.nodeBoundaryShow=!1,this.clusterCorrectionShow=!1,this.clusterCorrectionProcess=!1,this.nodePlacementProcess=!0}submitNodePlacement(){const t=new FormData;this.uploadedFiles.forEach(e=>{"existing"==e.fileType&&t.append("existing_files",e.file),"gaist"==e.fileType&&t.append("gaist_files",e.file),"landBoundary"==e.fileType&&t.append("landboundary_files",e.file)}),this.loadingLoader=!0,this.httpClient.post("1"===this.connectiopnTypeNodePlacement?"/api/np_page":"/api/np_ug_page",t).subscribe(t=>{console.log(t),this.dataShare.changeData(t),this.loadingLoader=!1},t=>{console.error(t),alert("error occured"),this.loadingLoader=!1})}filesDropped(t,e){console.log(t.target.files);for(let i=0;i<t.target.files.length;i++)this.uploadedFiles.push({file:t.target.files[i],fileType:e})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(h.eN),a.Y36(u),a.Y36(o.qu))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-geoserver-data"]],decls:13,vars:7,consts:[["class","loader-class",4,"ngIf"],[1,"col-12","someClass",3,"ngClass"],[1,"col-5"],[1,"container"],[1,"row"],["class","mb-3",4,"ngIf"],["class","mb-3 mt-2",4,"ngIf"],["class","container mt-3",4,"ngIf"],[1,"col-7"],[1,"loader-class"],[1,"loader"],[1,"mb-3"],[1,"text-center","text-warning","p-2","mb-4","text-uppercase"],["for","formFileMultiple",1,"form-label"],["aria-label","Default select example","name","connectiopnType",1,"form-select",3,"ngModel","ngModelChange"],["value","1","selected",""],["value","2"],["type","file","name","file","id","formFileMultiple","multiple","",1,"form-control",3,"change"],[1,"mb-3","mt-4"],["type","file","id","formFileMultiple","multiple","",1,"form-control",3,"change"],["type","submit",1,"btn","btn-primary","mt-4",3,"click"],["for","formFileMultiple",1,"pb-2",2,"font-weight","900"],["type","file","disabled","",1,"form-control"],[1,"mb-3","mt-3"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"mb-3","mt-2"],[1,"d-grid","gap-2","col-8","mx-auto"],["type","button",1,"btn","btn-success",3,"click"],[1,"container","mt-3"],[2,"height","500px","overflow-y","auto"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[3,"formGroup","ngSubmit"],["for","exampleFormControlInput1",1,"form-label"],["type","text","id","exampleFormControlInput1","placeholder","01","formControlName","input_cluster_id",1,"form-control"],["type","text","id","exampleFormControlInput1","placeholder","02","formControlName","output_cluster_id",1,"form-control"],["for","disabledTextInput",1,"fw-bold"],["type","text","id","disabledTextInput","placeholder","03","formControlName","gis_tool_id",1,"form-control"],[1,"d-grid","gap-2","mb-3","col-3","mx-auto"],["type","submit",1,"btn","btn-primary"],[1,"mb-3","col-6"],["type","button",1,"btn","btn-success"],[1,"form-label"],["aria-label","Default select example","name","connectiopnTypeNodePlacement",1,"form-select",3,"ngModel","ngModelChange"],["value","1"],["type","file","multiple","",1,"form-control",3,"change"],["disabled","","type","file","multiple","",1,"form-control",3,"change"]],template:function(t,e){1&t&&(a.YNc(0,g,2,0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"div",3),a.TgZ(4,"div",4),a.YNc(5,_,21,1,"form",5),a.YNc(6,m,13,0,"form",5),a._UZ(7,"hr"),a.YNc(8,y,6,0,"form",6),a.YNc(9,x,33,2,"div",7),a.YNc(10,w,36,1,"div",7),a.qZA(),a.qZA(),a.qZA(),a.TgZ(11,"div",8),a._UZ(12,"app-geoserver-map"),a.qZA(),a.qZA()),2&t&&(a.Q6J("ngIf",e.loadingLoader),a.xp6(1),a.Q6J("ngClass",e.loadingLoader?"step1":""),a.xp6(4),a.Q6J("ngIf",e.clusteringFormShow),a.xp6(1),a.Q6J("ngIf",e.nodeBoundaryShow),a.xp6(2),a.Q6J("ngIf",e.clusterCorrectionShow),a.xp6(1),a.Q6J("ngIf",e.clusterCorrectionProcess),a.xp6(1),a.Q6J("ngIf",e.nodePlacementProcess))},directives:[n.O5,n.mk,f,o._Y,o.JL,o.F,o.EJ,o.JJ,o.On,o.YN,o.Kr,n.sg,o.sg,o.Fj,o.u],styles:[".just_scroll[_ngcontent-%COMP%]{overflow:scroll;height:500px}.ms-n5[_ngcontent-%COMP%]{margin-left:-40px}.loader[_ngcontent-%COMP%]{border-radius:50%;border:16px solid #f3f3f3;border-top-color:#3498db;width:120px;height:120px;animation:spin 2s linear infinite}.loader-class[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:84vh;position:absolute;width:100%;z-index:500}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.step1[_ngcontent-%COMP%]{opacity:.5}.someClass[_ngcontent-%COMP%]{display:flex;justify-content:end}"]}),t})();const C=function(){return["/dashboard"]};let M=(()=>{class t{constructor(t){this.router=t,this.username=""}ngOnInit(){this.username=localStorage.getItem("username")}logout(){this.username=null,localStorage.setItem("isUserLoggedId","0"),localStorage.setItem("username",""),this.router.navigate(["login"])}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(r.F0))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-navbar"]],decls:11,vars:3,consts:[[1,"navbar","navbar-light","top-navbar","bg-color","p-4",2,"z-index","1"],[1,"container-fluid","d-flex","justify-content-between","align-items-center"],[1,"navbar-brand",3,"routerLink"],["width","130","src","http://media-s3-us-east-1.ceros.com/cyient/images/2017/04/04/f7fa573edde0c1a740ab3a5071a45b68/cyient-white-std-rgb.png"],[1,"m-0","text-white"],[1,"text-white","d-flex","align-items-center",3,"click"],[1,"fa","fa-sign-in","fa-2x","mx-2"]],template:function(t,e){1&t&&(a.TgZ(0,"nav",0),a.TgZ(1,"div",1),a.TgZ(2,"a",2),a._UZ(3,"img",3),a.qZA(),a.TgZ(4,"p",4),a.TgZ(5,"b"),a._uU(6,"Welcome"),a.qZA(),a._uU(7),a.qZA(),a.TgZ(8,"p",5),a.NdJ("click",function(){return e.logout()}),a._uU(9," Logout"),a._UZ(10,"i",6),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(2),a.Q6J("routerLink",a.DdM(2,C)),a.xp6(5),a.hij(" ",e.username,""))},directives:[r.yS],styles:[".nav-link[_ngcontent-%COMP%]:active, .nav-link[_ngcontent-%COMP%]:focus, .nav-link[_ngcontent-%COMP%]:hover{background-color:#75787b!important;color:#fff!important}.nav-link[_ngcontent-%COMP%]{color:#000!important;font-weight:600}"]}),t})(),S=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-home"]],decls:3,vars:0,consts:[[1,"p-1","my-container","active-cont"]],template:function(t,e){1&t&&(a._UZ(0,"app-navbar"),a.TgZ(1,"div",0),a._UZ(2,"router-outlet"),a.qZA())},directives:[M,r.lC],styles:[".my-container[_ngcontent-%COMP%]{transition:.4s}"]}),t})();var T=i(9861),P=i(5959),E=i(878),A=i(8318),L=i(8470),R=i(5024),O=i(9996);function Z(t,e,i,n){return(0,R.m)(i)&&(n=i,i=void 0),n?Z(t,e,i).pipe((0,O.U)(t=>(0,L.k)(t)?n(...t):n(t))):new A.y(n=>{I(t,e,function(t){n.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},n,i)})}function I(t,e,i,n,o){let r;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const n=t;t.addEventListener(e,i,o),r=()=>n.removeEventListener(e,i,o)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const n=t;t.on(e,i),r=()=>n.off(e,i)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const n=t;t.addListener(e,i),r=()=>n.removeListener(e,i)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let r=0,s=t.length;r<s;r++)I(t[r],e,i,n,o)}n.add(r)}var k=i(8277);class N extends k.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(()=>t.flush(null))))}recycleAsyncId(t,e,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(t,e,i);0===t.actions.length&&(cancelAnimationFrame(e),t.scheduled=void 0)}}var F=i(1098);class D extends F.v{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let i,n=-1,o=e.length;t=t||e.shift();do{if(i=t.execute(t.state,t.delay))break}while(++n<o&&(t=e.shift()));if(this.active=!1,i){for(;++n<o&&(t=e.shift());)t.unsubscribe();throw i}}}const q=new D(N);var z=i(7570);i(8720);var j=i(8569),G=i(6882);class U{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new B(t,this.durationSelector))}}class B extends G.Ds{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let i;try{const{durationSelector:e}=this;i=e(t)}catch(e){return this.destination.error(e)}const n=(0,G.ft)(i,new G.IY(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}clearThrottle(){const{value:t,hasValue:e,throttled:i}=this;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),e&&(this.value=void 0,this.hasValue=!1,this.destination.next(t))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function W(t){return!(0,L.k)(t)&&t-parseFloat(t)+1>=0}var Y=i(6163);function V(t){const{index:e,period:i,subscriber:n}=t;if(n.next(e),!n.closed){if(-1===i)return n.complete();t.index=e+1,this.schedule(t,i)}}function X(t,e=j.P){return i=()=>function(t=0,e,i){let n=-1;return W(e)?n=Number(e)<1?1:Number(e):(0,Y.K)(e)&&(i=e),(0,Y.K)(i)||(i=j.P),new A.y(e=>{const o=W(t)?t:+t-i.now();return i.schedule(V,o,{index:0,period:n,subscriber:e})})}(t,e),function(t){return t.lift(new U(i))};var i}var H=i(3835),K=i(5416),J=i(6238);i(6673);var Q=i(4689);i(653),i(1225),i(3895),i(9291);var $=i(3169),tt=i(4720);let et=(()=>{class t{constructor(t,e,i){this._ngZone=t,this._platform=e,this._scrolled=new P.xQ,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new A.y(e=>{this._globalSubscription||this._addGlobalListener();const i=t>0?this._scrolled.pipe(X(t)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,E.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(t,e){const i=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe((0,H.h)(t=>!t||i.indexOf(t)>-1))}getAncestorScrollContainers(t){const e=[];return this.scrollContainers.forEach((i,n)=>{this._scrollableContainsElement(n,t)&&e.push(n)}),e}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,e){let i=(0,T.fI)(e),n=t.getElementRef().nativeElement;do{if(i==n)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Z(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(a.R0b),a.LFG($.t4),a.LFG(n.K0,8))},t.\u0275prov=a.Yz7({factory:function(){return new t(a.LFG(a.R0b),a.LFG($.t4),a.LFG(n.K0,8))},token:t,providedIn:"root"}),t})(),it=(()=>{class t{constructor(t,e,i,n){this.elementRef=t,this.scrollDispatcher=e,this.ngZone=i,this.dir=n,this._destroyed=new P.xQ,this._elementScrolled=new A.y(t=>this.ngZone.runOutsideAngular(()=>Z(this.elementRef.nativeElement,"scroll").pipe((0,K.R)(this._destroyed)).subscribe(t)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const e=this.elementRef.nativeElement,i=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=i?t.end:t.start),null==t.right&&(t.right=i?t.start:t.end),null!=t.bottom&&(t.top=e.scrollHeight-e.clientHeight-t.bottom),i&&0!=(0,$._i)()?(null!=t.left&&(t.right=e.scrollWidth-e.clientWidth-t.left),2==(0,$._i)()?t.left=t.right:1==(0,$._i)()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=e.scrollWidth-e.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const e=this.elementRef.nativeElement;(0,$.Mq)()?e.scrollTo(t):(null!=t.top&&(e.scrollTop=t.top),null!=t.left&&(e.scrollLeft=t.left))}measureScrollOffset(t){const e="left",i="right",n=this.elementRef.nativeElement;if("top"==t)return n.scrollTop;if("bottom"==t)return n.scrollHeight-n.clientHeight-n.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?i:e:"end"==t&&(t=o?e:i),o&&2==(0,$._i)()?t==e?n.scrollWidth-n.clientWidth-n.scrollLeft:n.scrollLeft:o&&1==(0,$._i)()?t==e?n.scrollLeft+n.scrollWidth-n.clientWidth:-n.scrollLeft:t==e?n.scrollLeft:n.scrollWidth-n.clientWidth-n.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(a.SBq),a.Y36(et),a.Y36(a.R0b),a.Y36(tt.Is,8))},t.\u0275dir=a.lG2({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),t})(),nt=(()=>{class t{constructor(t,e,i){this._platform=t,this._change=new P.xQ,this._changeListener=t=>{this._change.next(t)},this._document=i,e.runOutsideAngular(()=>{if(t.isBrowser){const t=this._getWindow();t.addEventListener("resize",this._changeListener),t.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:e,height:i}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+i,right:t.left+e,height:i,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,e=this._getWindow(),i=t.documentElement,n=i.getBoundingClientRect();return{top:-n.top||t.body.scrollTop||e.scrollY||i.scrollTop||0,left:-n.left||t.body.scrollLeft||e.scrollX||i.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(X(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(a.LFG($.t4),a.LFG(a.R0b),a.LFG(n.K0,8))},t.\u0275prov=a.Yz7({factory:function(){return new t(a.LFG($.t4),a.LFG(a.R0b),a.LFG(n.K0,8))},token:t,providedIn:"root"}),t})(),ot=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({}),t})();const rt=function(){function t(t){this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.defaultPrevented=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),st="propertychange",at=function(){function t(){this.disposed=!1}return t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function ht(t,e){return t>e?1:t<e?-1:0}function lt(t,e,i){var n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;var o=void 0;if(i>0){for(o=1;o<n;++o)if(t[o]<e)return o-1}else if(i<0){for(o=1;o<n;++o)if(t[o]<=e)return o}else for(o=1;o<n;++o){if(t[o]==e)return o;if(t[o]<e)return"function"==typeof i?i(e,t[o-1],t[o])>0?o-1:o:t[o-1]-e<e-t[o]?o-1:o}return n-1}function ut(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function ct(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,o=0;o<n;o++)t[t.length]=i[o]}function pt(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function dt(){return!0}function ft(){return!1}function gt(){}var _t="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1,o=arguments.length;n<o;++n){var r=arguments[n];if(null!=r)for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])}return i};function mt(t){for(var e in t)delete t[e]}var yt="function"==typeof Object.values?Object.values:function(t){var e=[];for(var i in t)e.push(t[i]);return e};function vt(t){var e;for(e in t)return!1;return!e}var xt,wt=(xt=function(t,e){return(xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}xt(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});const bt=function(t){function e(e){var i=t.call(this)||this;return i.eventTarget_=e,i.pendingRemovals_=null,i.dispatching_=null,i.listeners_=null,i}return wt(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);-1===n.indexOf(e)&&n.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t,i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(n){var o=e?new rt(t):t;o.target||(o.target=this.eventTarget_||this);var r,s=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in s||(s[i]=0,a[i]=0),++s[i];for(var h=0,l=n.length;h<l;++h)if(!1===(r="handleEvent"in n[h]?n[h].handleEvent(o):n[h].call(this,o))||o.propagationStopped){r=!1;break}if(0==--s[i]){var u=a[i];for(delete a[i];u--;)this.removeEventListener(i,gt);delete s[i]}return r}},e.prototype.disposeInternal=function(){this.listeners_&&mt(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)},e.prototype.removeEventListener=function(t,e){var i=this.listeners_&&this.listeners_[t];if(i){var n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=gt,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},e}(at),Ct="change",Mt="contextmenu",St="click",Tt="keydown",Pt="keypress",Et="touchmove",At="wheel";function Lt(t,e,i,n,o){if(n&&n!==t&&(i=i.bind(n)),o){var r=i;i=function(){t.removeEventListener(e,i),r.apply(this,arguments)}}var s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function Rt(t,e,i,n){return Lt(t,e,i,n,!0)}function Ot(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),mt(t))}var Zt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const It=function(t){function e(){var e=t.call(this)||this;return e.on=e.onInternal,e.once=e.onceInternal,e.un=e.unInternal,e.revision_=0,e}return Zt(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(Ct)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=Lt(this,t[o],e);return n}return Lt(this,t,e)},e.prototype.onceInternal=function(t,e){var i;if(Array.isArray(t)){var n=t.length;i=new Array(n);for(var o=0;o<n;++o)i[o]=Rt(this,t[o],e)}else i=Rt(this,t,e);return e.ol_key=i,i},e.prototype.unInternal=function(t,e){var i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(var e=0,i=t.length;e<i;++e)Ot(t[e]);else Ot(t)}(i);else if(Array.isArray(t))for(var n=0,o=t.length;n<o;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)},e}(bt);function kt(){return function(){throw new Error("Unimplemented abstract method.")}()}var Nt=0;function Ft(t){return t.ol_uid||(t.ol_uid=String(++Nt))}var Dt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qt=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.key=i,o.oldValue=n,o}return Dt(e,t),e}(rt);const zt=function(t){function e(e){var i=t.call(this)||this;return Ft(i),i.values_=null,void 0!==e&&i.setProperties(e),i}return Dt(e,t),e.prototype.get=function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&_t({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,e){var i;i="change:".concat(t),this.hasListener(i)&&this.dispatchEvent(new qt(i,t,e)),this.hasListener(i=st)&&this.dispatchEvent(new qt(i,t,e))},e.prototype.addChangeListener=function(t,e){this.addEventListener("change:".concat(t),e)},e.prototype.removeChangeListener=function(t,e){this.removeEventListener("change:".concat(t),e)},e.prototype.set=function(t,e,i){var n=this.values_||(this.values_={});if(i)n[t]=e;else{var o=n[t];n[t]=e,o!==e&&this.notify(t,o)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.applyProperties=function(t){t.values_&&_t(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,e){if(this.values_&&t in this.values_){var i=this.values_[t];delete this.values_[t],vt(this.values_)&&(this.values_=null),e||this.notify(t,i)}},e}(It);var jt={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Gt={};Gt[jt.RADIANS]=6370997/(2*Math.PI),Gt[jt.DEGREES]=2*Math.PI*6370997/360,Gt[jt.FEET]=.3048,Gt[jt.METERS]=1,Gt[jt.USFEET]=1200/3937;const Ut=jt,Bt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Wt=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Gt[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}();function Yt(t,e,i){return Math.min(Math.max(t,e),i)}var Vt="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2},Xt="log2"in Math?Math.log2:function(t){return Math.log(t)*Math.LOG2E};function Ht(t,e,i,n,o,r){var s=o-i,a=r-n;if(0!==s||0!==a){var h=((t-i)*s+(e-n)*a)/(s*s+a*a);h>1?(i=o,n=r):h>0&&(i+=s*h,n+=a*h)}return Kt(t,e,i,n)}function Kt(t,e,i,n){var o=i-t,r=n-e;return o*o+r*r}function Jt(t){return t*Math.PI/180}function Qt(t,e){var i=t%e;return i*e<0?i+e:i}function $t(t,e,i){return t+i*(e-t)}function te(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}function ee(t,e){return Math.floor(te(t,e))}function ie(t,e){return Math.ceil(te(t,e))}var ne=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oe=6378137,re=Math.PI*oe,se=[-re,-re,re,re],ae=[-180,-85,180,85],he=oe*Math.log(Math.tan(Math.PI/2)),le=function(t){function e(e){return t.call(this,{code:e,units:Ut.METERS,extent:se,global:!0,worldExtent:ae,getPointResolution:function(t,e){return t/Vt(e[1]/oe)}})||this}return ne(e,t),e}(Wt),ue=[new le("EPSG:3857"),new le("EPSG:102100"),new le("EPSG:102113"),new le("EPSG:900913"),new le("http://www.opengis.net/def/crs/EPSG/0/3857"),new le("http://www.opengis.net/gml/srs/epsg.xml#3857")],ce=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pe=[-180,-90,180,90],de=6378137*Math.PI/180,fe=function(t){function e(e,i){return t.call(this,{code:e,units:Ut.DEGREES,extent:pe,axisOrientation:i,global:!0,metersPerUnit:de,worldExtent:pe})||this}return ce(e,t),e}(Wt),ge=[new fe("CRS:84"),new fe("EPSG:4326","neu"),new fe("urn:ogc:def:crs:OGC:1.3:CRS84"),new fe("urn:ogc:def:crs:OGC:2:84"),new fe("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new fe("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new fe("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],_e={},me={};function ye(t,e,i){var n=t.getCode(),o=e.getCode();n in me||(me[n]={}),me[n][o]=i}function ve(t,e){var i;return t in me&&e in me[t]&&(i=me[t][e]),i}var xe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const we=function(t){function e(e){var i=this,n="Assertion failed. See https://openlayers.org/en/v"+"6.15.1".split("-")[0]+"/doc/errors/#"+e+" for details.";return(i=t.call(this,n)||this).code=e,i.name="AssertionError",i.message=n,i}return xe(e,t),e}(Error);function be(t,e){if(!t)throw new we(e)}function Ce(t){for(var e=[1/0,1/0,-1/0,-1/0],i=0,n=t.length;i<n;++i)Fe(e,t[i]);return e}function Me(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Se(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Te(t,e,i){var n,o;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(o=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*o}function Pe(t,e){return Ae(t,e[0],e[1])}function Ee(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Ae(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function Le(t,e){var i=e[0],n=e[1],o=0;return i<t[0]?o|=16:i>t[2]&&(o|=4),n<t[1]?o|=8:n>t[3]&&(o|=2),0===o&&(o=1),o}function Re(t,e,i,n,o){return o?(o[0]=t,o[1]=e,o[2]=i,o[3]=n,o):[t,e,i,n]}function Oe(t){return Re(1/0,1/0,-1/0,-1/0,t)}function Ze(t,e){var i=t[0],n=t[1];return Re(i,n,i,n,e)}function Ie(t,e,i,n,o){return De(Oe(o),t,e,i,n)}function ke(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Ne(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Fe(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function De(t,e,i,n,o){for(;i<n;i+=o)qe(t,e[i],e[i+1]);return t}function qe(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function ze(t,e){var i;return(i=e(Ge(t)))||(i=e(Ue(t)))||(i=e(Je(t)))?i:(i=e(Ke(t)))||!1}function je(t){var e=0;return ti(t)||(e=Qe(t)*Xe(t)),e}function Ge(t){return[t[0],t[1]]}function Ue(t){return[t[2],t[1]]}function Be(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function We(t,e){var i;return"bottom-left"===e?i=Ge(t):"bottom-right"===e?i=Ue(t):"top-left"===e?i=Ke(t):"top-right"===e?i=Je(t):be(!1,13),i}function Ye(t,e,i,n,o){var r=Ve(t,e,i,n),s=r[0],a=r[1],h=r[2],l=r[3],u=r[4],c=r[5],p=r[6],d=r[7];return Re(Math.min(s,h,u,p),Math.min(a,l,c,d),Math.max(s,h,u,p),Math.max(a,l,c,d),o)}function Ve(t,e,i,n){var o=e*n[0]/2,r=e*n[1]/2,s=Math.cos(i),a=Math.sin(i),h=o*s,l=o*a,u=r*s,c=r*a,p=t[0],d=t[1];return[p-h+c,d-l-u,p-h-c,d-l+u,p+h-c,d+l+u,p+h+c,d+l-u,p-h+c,d-l-u]}function Xe(t){return t[3]-t[1]}function He(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return $e(t,e)?(n[0]=t[0]>e[0]?t[0]:e[0],n[1]=t[1]>e[1]?t[1]:e[1],n[2]=t[2]<e[2]?t[2]:e[2],n[3]=t[3]<e[3]?t[3]:e[3]):Oe(n),n}function Ke(t){return[t[0],t[3]]}function Je(t){return[t[2],t[3]]}function Qe(t){return t[2]-t[0]}function $e(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function ti(t){return t[2]<t[0]||t[3]<t[1]}function ei(t,e){var i=e.getExtent(),n=Be(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){var o=Qe(i),r=Math.floor((n[0]-i[0])/o)*o;t[0]-=r,t[2]-=r}return t}function ii(t,e){var i,n,o=e[0],r=e[1],s=o[0],a=o[1],h=r[0],l=r[1],u=h-s,c=l-a,p=0===u&&0===c?0:(u*(t[0]-s)+c*(t[1]-a))/(u*u+c*c||0);return p<=0?(i=s,n=a):p>=1?(i=h,n=l):(i=s+p*u,n=a+p*c),[i,n]}function ni(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function oi(t,e){var i=Math.cos(e),n=Math.sin(e),o=t[1]*i+t[0]*n;return t[0]=t[0]*i-t[1]*n,t[1]=o,t}function ri(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function si(t,e){return Math.sqrt(ri(t,e))}function ai(t,e){if(e.canWrapX()){var i=Qe(e.getExtent()),n=hi(t,e,i);n&&(t[0]-=n*i)}return t}function hi(t,e,i){var n=e.getExtent(),o=0;if(e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])){var r=i||Qe(n);o=Math.floor((t[0]-n[0])/r)}return o}function li(t,e,i){var n=i||6371008.8,o=Jt(t[1]),r=Jt(e[1]),s=(r-o)/2,a=Jt(e[0]-t[0])/2,h=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(o)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}var ui=!0;function ci(t,e,i){var n;if(void 0!==e){for(var o=0,r=t.length;o<r;++o)e[o]=t[o];n=e}else n=t.slice();return n}function pi(t,e,i){if(void 0!==e&&t!==e){for(var n=0,o=t.length;n<o;++n)e[n]=t[n];t=e}return t}function di(t){!function(t,e){_e[t]=e}(t.getCode(),t),ye(t,t,ci)}function fi(t){return"string"==typeof t?_e[e=t]||_e[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function gi(t,e,i,n){var o,r=(t=fi(t)).getPointResolutionFunc();if(r)o=r(e,i),n&&n!==t.getUnits()&&(a=t.getMetersPerUnit())&&(o=o*a/Gt[n]);else{var s=t.getUnits();if(s==Ut.DEGREES&&!n||n==Ut.DEGREES)o=e;else{var a,h=xi(t,fi("EPSG:4326"));if(h===pi&&s!==Ut.DEGREES)o=e*t.getMetersPerUnit();else{var l=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];o=(li((l=h(l,l,2)).slice(0,2),l.slice(2,4))+li(l.slice(4,6),l.slice(6,8)))/2}void 0!==(a=n?Gt[n]:t.getMetersPerUnit())&&(o/=a)}}return o}function _i(t){!function(t){t.forEach(di)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&ye(e,t,ci)})})}function mi(t,e){return t?"string"==typeof t?fi(t):t:fi(e)}function yi(t){return function(e,i,n){for(var o=e.length,r=void 0!==n?n:2,s=void 0!==i?i:new Array(o),a=0;a<o;a+=r)for(var h=t(e.slice(a,a+r)),l=h.length,u=0,c=r;u<c;++u)s[a+u]=u>=l?e[a+u]:h[u];return s}}function vi(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||xi(t,e)===ci)&&i}function xi(t,e){var i=ve(t.getCode(),e.getCode());return i||(i=pi),i}function wi(t,e){return xi(fi(t),fi(e))}function bi(t,e,i){return wi(e,i)(t,void 0,t.length)}function Ci(t,e,i,n){return function(t,e,i,n){var o=[];if(n>1)for(var r=t[2]-t[0],s=t[3]-t[1],a=0;a<n;++a)o.push(t[0]+r*a/n,t[1],t[2],t[1]+s*a/n,t[2]-r*a/n,t[3],t[0],t[3]-s*a/n);else o=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(o,o,2);for(var h=[],l=[],u=(a=0,o.length);a<u;a+=2)h.push(o[a]),l.push(o[a+1]);return function(t,e,i){return Re(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),undefined)}(h,l)}(t,wi(e,i),0,n)}var Mi,Si,Ti;function Pi(t,e){return t}function Ei(t,e){return ui&&!ni(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(ui=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function Ai(t,e){return t}function Li(t,e){return t}function Ri(t,e,i){return function(n){var o,r;if(t.canWrapX()){var s=t.getExtent(),a=Qe(s);(r=hi(n=n.slice(0),t,a))&&(n[0]=n[0]-r*a),n[0]=Yt(n[0],s[0],s[2]),n[1]=Yt(n[1],s[1],s[3]),o=i(n)}else o=i(n);return r&&e.canWrapX()&&(o[0]+=r*Qe(e.getExtent())),o}}function Oi(t,e,i){return function(n,o,r,s,a){if(n){if(!o&&!e)return n;var h=e?0:r[0]*o,l=e?0:r[1]*o,u=a?a[0]:0,c=a?a[1]:0,p=t[0]+h/2+u,d=t[2]-h/2+u,f=t[1]+l/2+c,g=t[3]-l/2+c;p>d&&(d=p=(d+p)/2),f>g&&(g=f=(g+f)/2);var _=Yt(n[0],p,d),m=Yt(n[1],f,g);if(s&&i&&o){var y=30*o;_+=-y*Math.log(1+Math.max(0,p-n[0])/y)+y*Math.log(1+Math.max(0,n[0]-d)/y),m+=-y*Math.log(1+Math.max(0,f-n[1])/y)+y*Math.log(1+Math.max(0,n[1]-g)/y)}return[_,m]}}}function Zi(t){return t}function Ii(t,e,i,n){var o=Qe(e)/i[0],r=Xe(e)/i[1];return n?Math.min(t,Math.max(o,r)):Math.min(t,Math.min(o,r))}function ki(t,e,i){var n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),Yt(n,i/2,2*e)}function Ni(t,e,i,n,o){return function(r,s,a,h){if(void 0!==r){var l=n?Ii(t,n,a,o):t;return(void 0===i||i)&&h?ki(r,l,e):Yt(r,e,l)}}}function Fi(t){return void 0!==t?0:void 0}function Di(t){return void 0!==t?t:void 0}function qi(t){return Math.pow(t,3)}function zi(t){return 1-qi(1-t)}function ji(t){return 3*t*t-2*t*t*t}function Gi(t){return t}_i(ue),_i(ge),Mi=ue,Si=function(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var s=0;s<n;s+=o){r[s]=re*t[s]/180;var a=oe*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));a>he?a=he:a<-he&&(a=-he),r[s+1]=a}return r},Ti=function(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var s=0;s<n;s+=o)r[s]=180*t[s]/re,r[s+1]=360*Math.atan(Math.exp(t[s+1]/oe))/Math.PI-90;return r},ge.forEach(function(t){Mi.forEach(function(e){ye(t,e,Si),ye(e,t,Ti)})});const Ui="XY",Bi="XYZ",Wi="XYM",Yi="XYZM";var Vi,Xi="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Hi=-1!==Xi.indexOf("firefox"),Ki=(-1!==Xi.indexOf("safari")&&-1==Xi.indexOf("chrom")&&(Xi.indexOf("version/15.4")>=0||Xi.match(/cpu (os|iphone os) 15_4 like mac os x/)),-1!==Xi.indexOf("webkit")&&-1==Xi.indexOf("edge")),Ji=-1!==Xi.indexOf("macintosh"),Qi="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,$i="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,tn="undefined"!=typeof Image&&Image.prototype.decode,en=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(i){}return t}();function nn(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function on(t,e,i,n,o,r,s,a){var h=Math.sin(r),l=Math.cos(r);return t[0]=n*l,t[1]=o*h,t[2]=-n*h,t[3]=o*l,t[4]=s*n*l-a*n*h+e,t[5]=s*o*h+a*o*l+i,t}function rn(t,e){var i,n=(i=e)[0]*i[3]-i[1]*i[2];be(0!==n,32);var o=e[0],r=e[1],s=e[2],a=e[3],h=e[4],l=e[5];return t[0]=a/n,t[1]=-r/n,t[2]=-s/n,t[3]=o/n,t[4]=(s*l-a*h)/n,t[5]=-(o*l-r*h)/n,t}function sn(t){var e="matrix("+t.join(", ")+")";if($i)return e;var i=Vi||(Vi=document.createElement("div"));return i.style.transform=e,i.style.transform}function an(t,e,i,n,o,r){for(var s=r||[],a=0,h=e;h<i;h+=n){var l=t[h],u=t[h+1];s[a++]=o[0]*l+o[2]*u+o[4],s[a++]=o[1]*l+o[3]*u+o[5]}return r&&s.length!=a&&(s.length=a),s}function hn(t,e,i,n,o,r,s){for(var a=s||[],h=Math.cos(o),l=Math.sin(o),u=r[0],c=r[1],p=0,d=e;d<i;d+=n){var f=t[d]-u,g=t[d+1]-c;a[p++]=u+f*h-g*l,a[p++]=c+f*l+g*h;for(var _=d+2;_<d+n;++_)a[p++]=t[_]}return s&&a.length!=p&&(a.length=p),a}function ln(t,e,i,n,o,r,s){for(var a=s||[],h=0,l=e;l<i;l+=n){a[h++]=t[l]+o,a[h++]=t[l+1]+r;for(var u=l+2;u<l+n;++u)a[h++]=t[u]}return s&&a.length!=h&&(a.length=h),a}new Array(6);var un=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cn=[1,0,0,1,0,0];const pn=function(t){function e(){var e,i,n,o,r,s=t.call(this)||this;return s.extent_=[1/0,1/0,-1/0,-1/0],s.extentRevision_=-1,s.simplifiedGeometryMaxMinSquaredTolerance=0,s.simplifiedGeometryRevision=0,s.simplifyTransformedInternal=(e=function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)},r=!1,function(){var t=Array.prototype.slice.call(arguments);return r&&this===o&&pt(t,n)||(r=!0,o=this,n=t,i=e.apply(this,arguments)),i}),s}return un(e,t),e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},e.prototype.clone=function(){return kt()},e.prototype.closestPointXY=function(t,e,i,n){return kt()},e.prototype.containsXY=function(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return kt()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Oe(e),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){kt()},e.prototype.scale=function(t,e,i){kt()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return kt()},e.prototype.getType=function(){return kt()},e.prototype.applyTransform=function(t){kt()},e.prototype.intersectsExtent=function(t){return kt()},e.prototype.translate=function(t,e){kt()},e.prototype.transform=function(t,e){var i=fi(t),n=i.getUnits()==Ut.TILE_PIXELS?function(t,n,o){var r=i.getExtent(),s=i.getWorldExtent(),a=Xe(s)/Xe(r);return on(cn,s[0],s[3],a,-a,0,0,0),an(t,0,t.length,o,cn,n),wi(i,e)(t,n,o)}:wi(i,e);return this.applyTransform(n),this},e}(zt);var dn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function fn(t){var e;return t==Ui?e=2:t==Bi||t==Wi?e=3:t==Yi&&(e=4),e}const gn=function(t){function e(){var e=t.call(this)||this;return e.layout=Ui,e.stride=2,e.flatCoordinates=null,e}return dn(e,t),e.prototype.computeExtent=function(t){return Ie(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return kt()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=fn(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){kt()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=fn(t);else{for(var o=0;o<i;++o){if(0===e.length)return this.layout=Ui,void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e=Ui:3==t?e=Bi:4==t&&(e=Yi),e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();hn(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var o=i;o||(o=Be(this.getExtent()));var r=this.getFlatCoordinates();if(r){var s=this.getStride();!function(t,e,i,n,o,r,s,a){for(var h=a||[],l=s[0],u=s[1],c=0,p=0;p<i;p+=n){var d=t[p+1]-u;h[c++]=l+o*(t[p]-l),h[c++]=u+r*d;for(var f=p+2;f<p+n;++f)h[c++]=t[f]}a&&h.length!=c&&(h.length=c)}(r,0,r.length,s,t,n,o,r),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();ln(i,0,i.length,n,t,e,i),this.changed()}},e}(pn);function _n(t,e,i,n,o,r,s){var a,h=t[e],l=t[e+1],u=t[i]-h,c=t[i+1]-l;if(0===u&&0===c)a=e;else{var p=((o-h)*u+(r-l)*c)/(u*u+c*c);if(p>1)a=i;else{if(p>0){for(var d=0;d<n;++d)s[d]=$t(t[e+d],t[i+d],p);return void(s.length=n)}a=e}}for(d=0;d<n;++d)s[d]=t[a+d];s.length=n}function mn(t,e,i,n,o){var r=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],h=t[e+1],l=Kt(r,s,a,h);l>o&&(o=l),r=a,s=h}return o}function yn(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];o=mn(t,e,a,n,o),e=a}return o}function vn(t,e,i,n,o,r,s,a,h,l,u){if(e==i)return l;var c,p;if(0===o){if((p=Kt(s,a,t[e],t[e+1]))<l){for(c=0;c<n;++c)h[c]=t[e+c];return h.length=n,p}return l}for(var d=u||[NaN,NaN],f=e+n;f<i;)if(_n(t,f-n,f,n,s,a,d),(p=Kt(s,a,d[0],d[1]))<l){for(l=p,c=0;c<n;++c)h[c]=d[c];h.length=n,f+=n}else f+=n*Math.max((Math.sqrt(p)-Math.sqrt(l))/o|0,1);if(r&&(_n(t,i-n,e,n,s,a,d),(p=Kt(s,a,d[0],d[1]))<l)){for(l=p,c=0;c<n;++c)h[c]=d[c];h.length=n}return l}function xn(t,e,i,n,o,r,s,a,h,l,u){for(var c=u||[NaN,NaN],p=0,d=i.length;p<d;++p){var f=i[p];l=vn(t,e,f,n,o,r,s,a,h,l,c),e=f}return l}function wn(t,e,i,n){for(var o=0,r=i.length;o<r;++o)t[e++]=i[o];return e}function bn(t,e,i,n){for(var o=0,r=i.length;o<r;++o)for(var s=i[o],a=0;a<n;++a)t[e++]=s[a];return e}function Cn(t,e,i,n,o){for(var r=o||[],s=0,a=0,h=i.length;a<h;++a){var l=bn(t,e,i[a],n);r[s++]=l,e=l}return r.length=s,r}function Mn(t,e,i,n,o,r,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)r[s++]=t[e],r[s++]=t[e+1];return s}var h=new Array(a);h[0]=1,h[a-1]=1;for(var l=[e,i-n],u=0;l.length>0;){for(var c=l.pop(),p=l.pop(),d=0,f=t[p],g=t[p+1],_=t[c],m=t[c+1],y=p+n;y<c;y+=n){var v=Ht(t[y],t[y+1],f,g,_,m);v>d&&(u=y,d=v)}d>o&&(h[(u-e)/n]=1,p+n<u&&l.push(p,u),u+n<c&&l.push(u,c))}for(y=0;y<a;++y)h[y]&&(r[s++]=t[e+y*n],r[s++]=t[e+y*n+1]);return s}function Sn(t,e){return e*Math.round(t/e)}function Tn(t,e,i,n,o,r,s){if(e==i)return s;var a,h,l=Sn(t[e],o),u=Sn(t[e+1],o);e+=n,r[s++]=l,r[s++]=u;do{if(a=Sn(t[e],o),h=Sn(t[e+1],o),(e+=n)==i)return r[s++]=a,r[s++]=h,s}while(a==l&&h==u);for(;e<i;){var c=Sn(t[e],o),p=Sn(t[e+1],o);if(e+=n,c!=a||p!=h){var d=a-l,f=h-u,g=c-l,_=p-u;d*_==f*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(f<0&&_<f||f==_||f>0&&_>f)?(a=c,h=p):(r[s++]=a,r[s++]=h,l=a,u=h,a=c,h=p)}}return r[s++]=a,r[s++]=h,s}function Pn(t,e,i,n,o,r,s,a){for(var h=0,l=i.length;h<l;++h){var u=i[h];s=Tn(t,e,u,n,o,r,s),a.push(s),e=u}return s}function En(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=e;a<i;a+=n)r[s++]=t.slice(a,a+n);return r.length=s,r}function An(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=0,h=i.length;a<h;++a){var l=i[a];r[s++]=En(t,e,l,n,r[s]),e=l}return r.length=s,r}function Ln(t,e,i,n,o){for(var r=void 0!==o?o:[],s=0,a=0,h=i.length;a<h;++a){var l=i[a];r[s++]=An(t,e,l,n,r[s]),e=l[l.length-1]}return r.length=s,r}function Rn(t,e,i,n){for(var o=0,r=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],h=t[e+1];o+=s*a-r*h,r=a,s=h}return o/2}function On(t,e,i,n){for(var o=0,r=0,s=i.length;r<s;++r){var a=i[r];o+=Rn(t,e,a,n),e=a}return o}var Zn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const In=function(t){function e(e,i){var n=t.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return Zn(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Te(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return Rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return En(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,Ui)},e.prototype.getType=function(){return"LinearRing"},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=bn(this.flatCoordinates,0,t,this.stride),this.changed()},e}(gn);var kn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Nn=function(t){function e(e,i){var n=t.call(this)||this;return n.setCoordinates(e,i),n}return kn(e,t),e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,n){var o=this.flatCoordinates,r=Kt(t,e,o[0],o[1]);if(r<n){for(var s=this.stride,a=0;a<s;++a)i[a]=o[a];return i.length=s,r}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Ze(this.flatCoordinates,t)},e.prototype.getType=function(){return"Point"},e.prototype.intersectsExtent=function(t){return Ae(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=wn(this.flatCoordinates,0,t),this.changed()},e}(gn);function Fn(t,e,i,n,o){return!ze(o,function(o){return!Dn(t,e,i,n,o[0],o[1])})}function Dn(t,e,i,n,o,r){for(var s=0,a=t[i-n],h=t[i-n+1];e<i;e+=n){var l=t[e],u=t[e+1];h<=r?u>r&&(l-a)*(r-h)-(o-a)*(u-h)>0&&s++:u<=r&&(l-a)*(r-h)-(o-a)*(u-h)<0&&s--,a=l,h=u}return 0!==s}function qn(t,e,i,n,o,r){if(0===i.length)return!1;if(!Dn(t,e,i[0],n,o,r))return!1;for(var s=1,a=i.length;s<a;++s)if(Dn(t,i[s-1],i[s],n,o,r))return!1;return!0}function zn(t,e,i,n,o,r,s){for(var a,h,l,u,c,p,d,f=o[r+1],g=[],_=0,m=i.length;_<m;++_){var y=i[_];for(u=t[y-n],p=t[y-n+1],a=e;a<y;a+=n)c=t[a],d=t[a+1],(f<=p&&d<=f||p<=f&&f<=d)&&g.push(l=(f-p)/(d-p)*(c-u)+u),u=c,p=d}var v=NaN,x=-1/0;for(g.sort(ht),u=g[0],a=1,h=g.length;a<h;++a){c=g[a];var w=Math.abs(c-u);w>x&&qn(t,e,i,n,l=(u+c)/2,f)&&(v=l,x=w),u=c}return isNaN(v)&&(v=o[r]),s?(s.push(v,f,x),s):[v,f,x]}function jn(t,e,i,n,o){var r;for(e+=n;e<i;e+=n)if(r=o(t.slice(e-n,e),t.slice(e,e+n)))return r;return!1}function Gn(t,e,i,n,o){var r=De([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!$e(o,r)&&(!!Ee(o,r)||r[0]>=o[0]&&r[2]<=o[2]||r[1]>=o[1]&&r[3]<=o[3]||jn(t,e,i,n,function(t,e){return function(t,e,i){var n=!1,o=Le(t,e),r=Le(t,i);if(1===o||1===r)n=!0;else{var s=t[0],a=t[1],h=t[2],l=t[3],u=i[0],c=i[1],p=(c-e[1])/(u-e[0]),d=void 0,f=void 0;2&r&&!(2&o)&&(n=(d=u-(c-l)/p)>=s&&d<=h),n||!(4&r)||4&o||(n=(f=c-(u-h)*p)>=a&&f<=l),n||!(8&r)||8&o||(n=(d=u-(c-a)/p)>=s&&d<=h),n||!(16&r)||16&o||(n=(f=c-(u-s)*p)>=a&&f<=l)}return n}(o,t,e)}))}function Un(t,e,i,n,o){return!!(Gn(t,e,i,n,o)||Dn(t,e,i,n,o[0],o[1])||Dn(t,e,i,n,o[0],o[3])||Dn(t,e,i,n,o[2],o[1])||Dn(t,e,i,n,o[2],o[3]))}function Bn(t,e,i,n,o){if(!Un(t,e,i[0],n,o))return!1;if(1===i.length)return!0;for(var r=1,s=i.length;r<s;++r)if(Fn(t,i[r-1],i[r],n,o)&&!Gn(t,i[r-1],i[r],n,o))return!1;return!0}function Wn(t,e,i,n){for(;e<i-n;){for(var o=0;o<n;++o){var r=t[e+o];t[e+o]=t[i-n+o],t[i-n+o]=r}e+=n,i-=n}}function Yn(t,e,i,n){for(var o=0,r=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],h=t[e+1];o+=(a-r)*(h+s),r=a,s=h}return 0===o?void 0:o>0}function Vn(t,e,i,n,o){for(var r=void 0!==o&&o,s=0,a=i.length;s<a;++s){var h=i[s],l=Yn(t,e,h,n);if(0===s){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=h}return!0}function Xn(t,e,i,n,o){for(var r=void 0!==o&&o,s=0,a=i.length;s<a;++s){var h=i[s],l=Yn(t,e,h,n);(0===s?r&&l||!r&&!l:r&&!l||!r&&l)&&Wn(t,e,h,n),e=h}return e}function Hn(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r)e=Xn(t,e,i[r],n,o);return e}var Kn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Jn=function(t){function e(e,i,n){var o=t.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==i&&n?(o.setFlatCoordinates(i,e),o.ends_=n):o.setCoordinates(e,i),o}return Kn(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?ct(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,n){return n<Te(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return qn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return On(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Xn(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,An(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Be(this.getExtent());this.flatInteriorPoint_=zn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new Nn(this.getFlatInteriorPoint(),Wi)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new In(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],o=0,r=0,s=i.length;r<s;++r){var a=i[r],h=new In(e.slice(o,a),t);n.push(h),o=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Vn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Xn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=Pn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,Ui,n)},e.prototype.getType=function(){return"Polygon"},e.prototype.intersectsExtent=function(t){return Bn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=Cn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(gn);const Qn=Jn;function $n(t){var e=t[0],i=t[1],n=t[2],o=t[3],r=[e,i,e,o,n,o,n,i,e,i];return new Jn(r,Ui,[r.length])}var to=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function eo(t,e){setTimeout(function(){t(e)},0)}function io(t){return!(t.sourceCenter&&t.targetCenter&&!ni(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function no(t,e,i,n,o){var r=Math.cos(-o),s=Math.sin(-o),a=t[0]*r-t[1]*s,h=t[1]*r+t[0]*s;return[(a+=(e[0]/2-i[0])*n)*r-(h+=(i[1]-e[1]/2)*n)*(s=-s),h*r+a*s]}const oo=function(t){function e(e){var i=t.call(this)||this,n=_t({},e);return i.hints_=[0,0],i.animations_=[],i.projection_=mi(n.projection,"EPSG:3857"),i.viewportSize_=[100,100],i.targetCenter_=null,i.nextCenter_=null,i.cancelAnchor_=void 0,n.projection&&(ui=!1),n.center&&(n.center=Ei(n.center)),n.extent&&(n.extent=Li(n.extent)),i.applyOptions_(n),i}return to(e,t),e.prototype.applyOptions_=function(t){var e=_t({},t);for(var i in Bt)delete e[i];this.setProperties(e,!0);var n=function(t){var e,i,n,o=void 0!==t.minZoom?t.minZoom:0,r=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=void 0!==t.showFullExtent&&t.showFullExtent,u=mi(t.projection,"EPSG:3857"),c=u.getExtent(),p=t.constrainOnlyCenter,d=t.extent;if(a||d||!u.isGlobal()||(p=!1,d=c),void 0!==t.resolutions){var f=t.resolutions;i=f[o],n=void 0!==f[r]?f[r]:f[f.length-1],e=t.constrainResolution?function(t,e,i,n){return function(o,r,s,a){if(void 0!==o){var h=t[0],l=t[t.length-1],u=i?Ii(h,i,s,n):h;if(a)return void 0===e||e?ki(o,u,l):Yt(o,l,u);var c=Math.min(u,o),p=Math.floor(lt(t,c,r));return t[p]>u&&p<t.length-1?t[p+1]:t[p]}}}(f,h,!p&&d,l):Ni(i,n,h,!p&&d,l)}else{var g=(c?Math.max(Qe(c),Xe(c)):360*Gt[Ut.DEGREES]/u.getMetersPerUnit())/256/Math.pow(2,0),_=g/Math.pow(2,28);void 0!==(i=t.maxResolution)?o=0:i=g/Math.pow(s,o),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(s,r):g/Math.pow(s,r):_),r=o+Math.floor(Math.log(i/n)/Math.log(s)),n=i/Math.pow(s,r-o),e=t.constrainResolution?function(t,e,i,n,o,r){return function(s,a,h,l){if(void 0!==s){var u=o?Ii(e,o,h,r):e,c=void 0!==i?i:0;if(l)return void 0===n||n?ki(s,u,c):Yt(s,c,u);var p=Math.ceil(Math.log(e/u)/Math.log(t)-1e-9),d=-a*(.5-1e-9)+.5,f=Math.min(u,s),g=Math.floor(Math.log(e/f)/Math.log(t)+d),_=Math.max(p,g);return Yt(e/Math.pow(t,_),c,u)}}}(s,i,n,h,!p&&d,l):Ni(i,n,h,!p&&d,l)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:o,zoomFactor:s}}(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;var o=function(t){if(void 0!==t.extent)return Oi(t.extent,t.constrainOnlyCenter,void 0===t.smoothExtentConstraint||t.smoothExtentConstraint);var e=mi(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){var i=e.getExtent().slice();return i[0]=-1/0,i[2]=1/0,Oi(i,!1,!1)}return Zi}(t),r=n.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(n=Jt(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=n?0:t:void 0}):!1===e?Di:"number"==typeof e?(i=2*Math.PI/e,function(t,e){return e?t:void 0!==t?t=Math.floor(t/i+.5)*i:void 0}):Di}return Fi;var i,n}(t);this.constraints_={center:o,resolution:r,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var i=this.getCenter();if(i){var n=t||[0,0,0,0];e=e||[0,0,0,0];var o=this.getResolution();this.setCenterInternal([i[0]+o/2*(n[3]-e[3]+e[1]-n[1]),i[1]-o/2*(n[0]-e[0]+e[2]-n[2])])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),_t({},e,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),i=0;i<e.length;++i){var n=arguments[i];n.center&&((n=_t({},n)).center=Ei(n.center,this.getProjection())),n.anchor&&((n=_t({},n)).anchor=Ei(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)},e.prototype.animateInternal=function(t){var e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);for(var n=0;n<i&&!this.isDef();++n){var o=arguments[n];o.center&&this.setCenterInternal(o.center),void 0!==o.zoom?this.setZoom(o.zoom):o.resolution&&this.setResolution(o.resolution),void 0!==o.rotation&&this.setRotation(o.rotation)}if(n!==i){for(var r=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,h=this.targetRotation_,l=[];n<i;++n){var u=arguments[n],c={start:r,complete:!1,anchor:u.anchor,duration:void 0!==u.duration?u.duration:1e3,easing:u.easing||ji,callback:e};if(u.center&&(c.sourceCenter=s,c.targetCenter=u.center.slice(),s=c.targetCenter),void 0!==u.zoom?(c.sourceResolution=a,c.targetResolution=this.getResolutionForZoom(u.zoom),a=c.targetResolution):u.resolution&&(c.sourceResolution=a,c.targetResolution=u.resolution,a=c.targetResolution),void 0!==u.rotation){c.sourceRotation=h;var p=Qt(u.rotation-h+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=h+p,h=c.targetRotation}io(c)?c.complete=!0:r+=c.duration,l.push(c)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}else e&&eo(e,!0)},e.prototype.getAnimating=function(){return this.hints_[0]>0},e.prototype.getInteracting=function(){return this.hints_[1]>0},e.prototype.cancelAnimations=function(){var t;this.setHint(0,-this.hints_[0]);for(var e=0,i=this.animations_.length;e<i;++e){var n=this.animations_[e];if(n[0].callback&&eo(n[0].callback,!1),!t)for(var o=0,r=n.length;o<r;++o){var s=n[o];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],o=!0,r=0,s=n.length;r<s;++r){var a=n[r];if(!a.complete){var h=a.duration>0?(t-a.start)/a.duration:1;h>=1?(a.complete=!0,h=1):o=!1;var l=a.easing(h);if(a.sourceCenter){var u=a.sourceCenter[0],c=a.sourceCenter[1],p=a.targetCenter[0],d=a.targetCenter[1];this.nextCenter_=a.targetCenter,this.targetCenter_=[u+l*(p-u),c+l*(d-c)]}if(a.sourceResolution&&a.targetResolution){var f=1===l?a.targetResolution:a.sourceResolution+l*(a.targetResolution-a.sourceResolution);if(a.anchor){var g=this.getViewportSize_(this.getRotation()),_=this.constraints_.resolution(f,0,g,!0);this.targetCenter_=this.calculateCenterZoom(_,a.anchor)}this.nextResolution_=a.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var m=1===l?Qt(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+l*(a.targetRotation-a.sourceRotation);if(a.anchor){var y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,a.anchor)}this.nextRotation_=a.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),e=!0,!a.complete)break}}if(o){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var v=n[0].callback;v&&eo(v,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,e){var i,n,o,r=this.getCenterInternal();return void 0!==r&&(oi(i=[r[0]-e[0],r[1]-e[1]],t-this.getRotation()),(n=i)[0]+=+(o=e)[0],n[1]+=+o[1]),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenterInternal(),o=this.getResolution();return void 0!==n&&void 0!==o&&(i=[e[0]-t*(e[0]-n[0])/o,e[1]-t*(e[1]-n[1])/o]),i},e.prototype.getViewportSize_=function(t){var e=this.viewportSize_;if(t){var i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t?Pi(t,this.getProjection()):t},e.prototype.getCenterInternal=function(){return this.get(Bt.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){return Ai(this.calculateExtentInternal(t),this.getProjection())},e.prototype.calculateExtentInternal=function(t){var e=t||this.getViewportSizeMinusPadding_(),i=this.getCenterInternal();be(i,1);var n=this.getResolution();be(void 0!==n,2);var o=this.getRotation();return be(void 0!==o,3),Ye(i,n,o,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Bt.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(Li(t,this.getProjection()),e)},e.prototype.getResolutionForExtentInternal=function(t,e){var i=e||this.getViewportSizeMinusPadding_(),n=Qe(t)/i[0],o=Xe(t)/i[1];return Math.max(n,o)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.getConstrainedResolution(this.maxResolution_),n=Math.log(i/this.minResolution_)/Math.log(e);return function(t){return i/Math.pow(e,t*n)}},e.prototype.getRotation=function(){return this.get(Bt.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=Math.log(i/this.minResolution_)/e;return function(t){return Math.log(i/t)/e/n}},e.prototype.getViewportSizeMinusPadding_=function(t){var e=this.getViewportSize_(t),i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e},e.prototype.getState=function(){var t=this.getProjection(),e=this.getResolution(),i=this.getRotation(),n=this.getCenterInternal(),o=this.padding_;if(o){var r=this.getViewportSizeMinusPadding_();n=no(n,this.getViewportSize_(),[r[0]/2+o[3],r[1]/2+o[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,n=this.minZoom_||0;if(this.resolutions_){var o=lt(this.resolutions_,t,1);n=o,e=this.resolutions_[o],i=o==this.resolutions_.length-1?2:e/this.resolutions_[o+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=Yt(Math.floor(t),0,this.resolutions_.length-2);return this.resolutions_[e]/Math.pow(this.resolutions_[e]/this.resolutions_[e+1],Yt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,e){var i;if(be(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))be(!ti(t),25),i=$n(n=Li(t,this.getProjection()));else if("Circle"===t.getType()){var n;(i=$n(n=Li(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),Be(n))}else{i=t}this.fitInternal(i,e)},e.prototype.rotatedExtentForGeometry=function(t){for(var e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),o=t.getFlatCoordinates(),r=t.getStride(),s=1/0,a=1/0,h=-1/0,l=-1/0,u=0,c=o.length;u<c;u+=r){var p=o[u]*i-o[u+1]*n,d=o[u]*n+o[u+1]*i;s=Math.min(s,p),a=Math.min(a,d),h=Math.max(h,p),l=Math.max(l,d)}return[s,a,h,l]},e.prototype.fitInternal=function(t,e){var i=e||{},n=i.size;n||(n=this.getViewportSizeMinusPadding_());var o,r=void 0!==i.padding?i.padding:[0,0,0,0],s=void 0!==i.nearest&&i.nearest;o=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0;var a=this.rotatedExtentForGeometry(t),h=this.getResolutionForExtentInternal(a,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);h=isNaN(h)?o:Math.max(h,o),h=this.getConstrainedResolution(h,s?0:1);var l=this.getRotation(),u=Math.sin(l),c=Math.cos(l),p=Be(a);p[0]+=(r[1]-r[3])/2*h,p[1]+=(r[0]-r[2])/2*h;var d=this.getConstrainedCenter([p[0]*c-p[1]*u,p[1]*c+p[0]*u],h),f=i.callback?i.callback:gt;void 0!==i.duration?this.animateInternal({resolution:h,center:d,duration:i.duration,easing:i.easing},f):(this.targetResolution_=h,this.targetCenter_=d,this.applyTargetState_(!1,!0),eo(f,!0))},e.prototype.centerOn=function(t,e,i){this.centerOnInternal(Ei(t,this.getProjection()),e,i)},e.prototype.centerOnInternal=function(t,e,i){this.setCenterInternal(no(t,e,i,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,e,i,n){var o,r=this.padding_;if(r&&t){var s=this.getViewportSizeMinusPadding_(-i),a=no(t,n,[s[0]/2+r[3],s[1]/2+r[0]],e,i);o=[t[0]-a[0],t[1]-a[1]]}return o},e.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},e.prototype.adjustCenter=function(t){var e=Pi(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustResolution=function(t,e){var i=e&&Ei(e,this.getProjection());this.adjustResolutionInternal(t,i)},e.prototype.adjustResolutionInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(o,e)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},e.prototype.adjustRotation=function(t,e){e&&(e=Ei(e,this.getProjection())),this.adjustRotationInternal(t,e)},e.prototype.adjustRotationInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(t?Ei(t,this.getProjection()):t)},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,e){var i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),o=this.getViewportSize_(n),r=this.constraints_.resolution(this.targetResolution_,0,o,i),s=this.constraints_.center(this.targetCenter_,r,o,i,this.calculateCenterShift(this.targetCenter_,r,n,o));this.get(Bt.ROTATION)!==n&&this.set(Bt.ROTATION,n),this.get(Bt.RESOLUTION)!==r&&(this.set(Bt.RESOLUTION,r),this.set("zoom",this.getZoom(),!0)),s&&this.get(Bt.CENTER)&&ni(this.get(Bt.CENTER),s)||this.set(Bt.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,e,i){var n=void 0!==t?t:200,o=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,o,s),h=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,r,s));if(0===n&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=h,void this.applyTargetState_();var l=i||(0===n?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===r&&this.getCenterInternal()&&ni(this.getCenterInternal(),h)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:h,resolution:a,duration:n,easing:zi,anchor:l}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(1,1)},e.prototype.endInteraction=function(t,e,i){var n=i&&Ei(i,this.getProjection());this.endInteractionInternal(t,e,n)},e.prototype.endInteractionInternal=function(t,e,i){this.setHint(1,-1),this.resolveConstraints(t,e,i)},e.prototype.getConstrainedCenter=function(t,e){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)},e.prototype.getConstrainedZoom=function(t,e){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))},e.prototype.getConstrainedResolution=function(t,e){var i=e||0,n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,n)},e}(zt);var ro=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,so=/^([a-z]*)$|^hsla?\(.*\)$/i;function ao(t){return"string"==typeof t?t:co(t)}var ho=function(){var t={},e=0;return function(i){var n;if(t.hasOwnProperty(i))n=t[i];else{if(e>=1024){var o=0;for(var r in t)0==(3&o++)&&(delete t[r],--e)}n=function(t){var e,i,n,o,r;if(so.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}(t)),ro.exec(t)){var s,a=t.length-1;s=a<=4?1:2;var h=4===a||8===a;e=parseInt(t.substr(1+0*s,s),16),i=parseInt(t.substr(1+1*s,s),16),n=parseInt(t.substr(1+2*s,s),16),o=h?parseInt(t.substr(1+3*s,s),16):255,1==s&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,h&&(o=(o<<4)+o)),r=[e,i,n,o/255]}else 0==t.indexOf("rgba(")?uo(r=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((r=t.slice(4,-1).split(",").map(Number)).push(1),uo(r)):be(!1,14);return r}(i),t[i]=n,++e}return n}}();function lo(t){return Array.isArray(t)?t:ho(t)}function uo(t){return t[0]=Yt(t[0]+.5|0,0,255),t[1]=Yt(t[1]+.5|0,0,255),t[2]=Yt(t[2]+.5|0,0,255),t[3]=Yt(t[3],0,1),t}function co(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function po(t,e,i){return e+":"+t+":"+(i?ao(i):"null")}var fo=new(function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_)0!=(3&t++)||this.cache_[e].hasListener()||(delete this.cache_[e],--this.cacheSize_)}},t.prototype.get=function(t,e,i){var n=po(t,e,i);return n in this.cache_?this.cache_[n]:null},t.prototype.set=function(t,e,i,n){var o=po(t,e,i);this.cache_[o]=n,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}());const go="opacity",_o="visible",mo="extent",yo="zIndex",vo="maxResolution",xo="minResolution",wo="maxZoom",bo="minZoom",Co="source";var Mo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const So=function(t){function e(e){var i=t.call(this)||this;i.background_=e.background;var n=_t({},e);return"object"==typeof e.properties&&(delete n.properties,_t(n,e.properties)),n.opacity=void 0!==e.opacity?e.opacity:1,be("number"==typeof n.opacity,64),n.visible=void 0===e.visible||e.visible,n.zIndex=e.zIndex,n.maxResolution=void 0!==e.maxResolution?e.maxResolution:1/0,n.minResolution=void 0!==e.minResolution?e.minResolution:0,n.minZoom=void 0!==e.minZoom?e.minZoom:-1/0,n.maxZoom=void 0!==e.maxZoom?e.maxZoom:1/0,i.className_=void 0!==n.className?n.className:"ol-layer",delete n.className,i.setProperties(n),i.state_=null,i}return Mo(e,t),e.prototype.getBackground=function(){return this.background_},e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=Yt(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return kt()},e.prototype.getLayerStatesArray=function(t){return kt()},e.prototype.getExtent=function(){return this.get(mo)},e.prototype.getMaxResolution=function(){return this.get(vo)},e.prototype.getMinResolution=function(){return this.get(xo)},e.prototype.getMinZoom=function(){return this.get(bo)},e.prototype.getMaxZoom=function(){return this.get(wo)},e.prototype.getOpacity=function(){return this.get(go)},e.prototype.getSourceState=function(){return kt()},e.prototype.getVisible=function(){return this.get(_o)},e.prototype.getZIndex=function(){return this.get(yo)},e.prototype.setBackground=function(t){this.background_=t,this.changed()},e.prototype.setExtent=function(t){this.set(mo,t)},e.prototype.setMaxResolution=function(t){this.set(vo,t)},e.prototype.setMinResolution=function(t){this.set(xo,t)},e.prototype.setMaxZoom=function(t){this.set(wo,t)},e.prototype.setMinZoom=function(t){this.set(bo,t)},e.prototype.setOpacity=function(t){be("number"==typeof t,64),this.set(go,t)},e.prototype.setVisible=function(t){this.set(_o,t)},e.prototype.setZIndex=function(t){this.set(yo,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(zt),To="precompose",Po="rendercomplete";var Eo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Ao(t,e){if(!t.visible)return!1;var i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}const Lo=function(t){function e(e){var i=this,n=_t({},e);return delete n.source,(i=t.call(this,n)||this).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,i.rendered=!1,e.render&&(i.render=e.render),e.map&&i.setMap(e.map),i.addChangeListener(Co,i.handleSourcePropertyChange_),i.setSource(e.source?e.source:null),i}return Eo(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Co)||null},e.prototype.getRenderSource=function(){return this.getSource()},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():"undefined"},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Ot(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Lt(t,Ct,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(t){return t([])})},e.prototype.getData=function(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null},e.prototype.render=function(t,e){var i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,e)},e.prototype.unrender=function(){this.rendered=!1},e.prototype.setMapInternal=function(t){t||this.unrender(),this.set("map",t)},e.prototype.getMapInternal=function(){return this.get("map")},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Ot(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Ot(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Lt(t,To,function(t){var e=t.frameState.layerStatesArray,i=this.getLayerState(!1);be(!e.some(function(t){return t.layer===i.layer}),67),e.push(i)},this),this.mapRenderKey_=Lt(this,Ct,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Co,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),t.prototype.disposeInternal.call(this)},e}(So);var Ro=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Oo(t,e){fo.expire()}const Zo=function(t){function e(e){var i=t.call(this)||this;return i.map_=e,i}return Ro(e,t),e.prototype.dispatchRenderEvent=function(t,e){kt()},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;on(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),rn(n,i)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o,r,s,a){var h,l=e.viewState;function u(t,e,i,n){return o.call(r,e,t?i:null,n)}var c=l.projection,p=ai(t.slice(),c),d=[[0,0]];if(c.canWrapX()&&n){var f=Qe(c.getExtent());d.push([-f,0],[f,0])}for(var g=e.layerStatesArray,_=g.length,m=[],y=[],v=0;v<d.length;v++)for(var x=_-1;x>=0;--x){var w=g[x],b=w.layer;if(b.hasRenderer()&&Ao(w,l)&&s.call(a,b)){var C=b.getRenderer(),M=b.getSource();if(C&&M){var S=M.getWrapX()?p:t,T=u.bind(null,w.managed);y[0]=S[0]+d[v][0],y[1]=S[1]+d[v][1],h=C.forEachFeatureAtCoordinate(y,e,i,T,m)}if(h)return h}}if(0!==m.length){var P=1/m.length;return m.forEach(function(t,e){return t.distanceSq+=e*P}),m.sort(function(t,e){return t.distanceSq-e.distanceSq}),m.some(function(t){return h=t.callback(t.feature,t.layer,t.geometry)}),h}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,o){return kt()},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,o,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,dt,this,o,r)},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){kt()},e.prototype.scheduleExpireIconCache=function(t){fo.canExpireCache()&&t.postRenderFunctions.push(Oo)},e}(at);var Io=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const ko=function(t){function e(e,i,n,o){var r=t.call(this,e)||this;return r.inversePixelTransform=i,r.frameState=n,r.context=o,r}return Io(e,t),e}(rt);var No="ol-hidden",Fo="ol-control",Do=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),qo=["style","variant","weight","size","lineHeight","family"],zo=function(t){var e=t.match(Do);if(!e)return null;for(var i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,o=qo.length;n<o;++n){var r=e[n+1];void 0!==r&&(i[qo[n]]=r)}return i.families=i.family.split(/,\s?/),i};function jo(t,e,i,n){var o;return o=i&&i.length?i.shift():$i?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(o.width=t),e&&(o.height=e),o.getContext("2d",n)}function Go(t){var e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Uo(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function Bo(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var Wo="10px sans-serif",Yo="#000",Vo="round",Xo=[],Ho="round",Ko="#000",Jo="center",Qo="middle",$o=[0,0,0,0],tr=new zt;(new bt).setSize=function(){console.warn("labelCache is deprecated.")};var er,ir,nr=null,or={},rr=function(){var t,e,i="32px ",n=["monospace","serif"],o=n.length,r="wmytzilWMYTZIL@#/&?$%10\uf013";function s(t,s,a){for(var h=!0,l=0;l<o;++l){var u=n[l];if(e=hr(t+" "+s+" "+i+u,r),a!=u){var c=hr(t+" "+s+" "+i+a+","+u,r);h=h&&c!=e}}return!!h}function a(){for(var e=!0,i=tr.getKeys(),n=0,o=i.length;n<o;++n){var r=i[n];tr.get(r)<100&&(s.apply(this,r.split("\n"))?(mt(or),nr=null,er=void 0,tr.set(r,100)):(tr.set(r,tr.get(r)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var i=zo(e);if(i)for(var n=i.families,o=0,r=n.length;o<r;++o){var h=n[o],l=i.style+"\n"+i.weight+"\n"+h;void 0===tr.get(l)&&(tr.set(l,100,!0),s(i.style,i.weight,h)||(tr.set(l,0,!0),void 0===t&&(t=setInterval(a,32))))}}}(),sr=function(t){var e=or[t];if(null==e){if($i){var i=zo(t),n=ar(t,"\u017dg");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else ir||((ir=document.createElement("div")).innerHTML="M",ir.style.minHeight="0",ir.style.maxHeight="none",ir.style.height="auto",ir.style.padding="0",ir.style.border="none",ir.style.position="absolute",ir.style.display="block",ir.style.left="-99999px"),ir.style.font=t,document.body.appendChild(ir),e=ir.offsetHeight,document.body.removeChild(ir);or[t]=e}return e};function ar(t,e){return nr||(nr=jo(1,1)),t!=er&&(nr.font=t,er=nr.font),nr.measureText(e)}function hr(t,e){return ar(t,e).width}function lr(t,e,i){if(e in i)return i[e];var n=e.split("\n").reduce(function(e,i){return Math.max(e,hr(t,i))},0);return i[e]=n,n}var ur=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const cr=function(t){function e(e){var i=t.call(this,e)||this;i.fontChangeListenerKey_=Lt(tr,st,e.redrawText.bind(e)),i.element_=document.createElement("div");var n=i.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",i.element_.className="ol-unselectable ol-layers";var o=e.getViewport();return o.insertBefore(i.element_,o.firstChild||null),i.children_=[],i.renderedVisible_=!0,i}return ur(e,t),e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap();if(i.hasListener(t)){var n=new ko(t,void 0,e);i.dispatchEvent(n)}},e.prototype.disposeInternal=function(){Ot(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),t.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(To,t);var e=t.layerStatesArray.sort(function(t,e){return t.zIndex-e.zIndex}),i=t.viewState;this.children_.length=0;for(var n=[],o=null,r=0,s=e.length;r<s;++r){var a=e[r];t.layerIndex=r;var h=a.layer,l=h.getSourceState();if(!Ao(a,i)||"ready"!=l&&"undefined"!=l)h.unrender();else{var u=h.render(t,o);u&&(u!==o&&(this.children_.push(u),o=u),"getDeclutter"in h&&n.push(h))}}for(r=n.length-1;r>=0;--r)n[r].renderDeclutter(t);!function(t,e){for(var i=t.childNodes,n=0;;++n){var o=i[n],r=e[n];if(!o&&!r)break;o!==r&&(o?r?t.insertBefore(r,o):(t.removeChild(o),--n):t.appendChild(r))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,i,n,o){for(var r=e.viewState,s=e.layerStatesArray,a=s.length-1;a>=0;--a){var h=s[a],l=h.layer;if(l.hasRenderer()&&Ao(h,r)&&o(l)){var u=l.getRenderer().getDataAtPixel(t,e,i);if(u){var c=n(l,u);if(c)return c}}}},e}(Zo),pr="add",dr="remove";var fr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gr="length",_r=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.element=i,o.index=n,o}return fr(e,t),e}(rt);const mr=function(t){function e(e,i){var n=t.call(this)||this;if(n.unique_=!!(i||{}).unique,n.array_=e||[],n.unique_)for(var o=0,r=n.array_.length;o<r;++o)n.assertUnique_(n.array_[o],o);return n.updateLength_(),n}return fr(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(gr)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new _r(pr,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new _r(dr,e,t)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new _r(dr,n,t)),this.dispatchEvent(new _r(pr,e,t))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(gr,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new we(58)},e}(zt);var yr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vr=function(t){function e(e,i){var n=t.call(this,e)||this;return n.layer=i,n}return yr(e,t),e}(rt),xr="layers";const wr=function(t){function e(e){var i=this,n=e||{},o=_t({},n);delete o.layers;var r=n.layers;return(i=t.call(this,o)||this).layersListenerKeys_=[],i.listenerKeys_={},i.addChangeListener(xr,i.handleLayersChanged_),r?Array.isArray(r)?r=new mr(r.slice(),{unique:!0}):be("function"==typeof r.getArray,43):r=new mr(void 0,{unique:!0}),i.setLayers(r),i}return yr(e,t),e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Ot),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(Lt(t,pr,this.handleLayersAdd_,this),Lt(t,dr,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(Ot);mt(this.listenerKeys_);for(var i=t.getArray(),n=0,o=i.length;n<o;n++){var r=i[n];this.registerLayerListeners_(r),this.dispatchEvent(new vr("addlayer",r))}this.changed()},e.prototype.registerLayerListeners_=function(t){var i=[Lt(t,st,this.handleLayerChange_,this),Lt(t,Ct,this.handleLayerChange_,this)];t instanceof e&&i.push(Lt(t,"addlayer",this.handleLayerGroupAdd_,this),Lt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Ft(t)]=i},e.prototype.handleLayerGroupAdd_=function(t){this.dispatchEvent(new vr("addlayer",t.layer))},e.prototype.handleLayerGroupRemove_=function(t){this.dispatchEvent(new vr("removelayer",t.layer))},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new vr("addlayer",e)),this.changed()},e.prototype.handleLayersRemove_=function(t){var e=t.element,i=Ft(e);this.listenerKeys_[i].forEach(Ot),delete this.listenerKeys_[i],this.dispatchEvent(new vr("removelayer",e)),this.changed()},e.prototype.getLayers=function(){return this.get(xr)},e.prototype.setLayers=function(t){var e=this.getLayers();if(e)for(var i=e.getArray(),n=0,o=i.length;n<o;++n)this.dispatchEvent(new vr("removelayer",i[n]));this.set(xr,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});var n=this.getLayerState(),o=n.zIndex;t||void 0!==n.zIndex||(o=0);for(var r=i,s=e.length;r<s;r++){var a=e[r];a.opacity*=n.opacity,a.visible=a.visible&&n.visible,a.maxResolution=Math.min(a.maxResolution,n.maxResolution),a.minResolution=Math.max(a.minResolution,n.minResolution),a.minZoom=Math.max(a.minZoom,n.minZoom),a.maxZoom=Math.min(a.maxZoom,n.maxZoom),void 0!==n.extent&&(a.extent=void 0!==a.extent?He(a.extent,n.extent):n.extent),void 0===a.zIndex&&(a.zIndex=o)}return e},e.prototype.getSourceState=function(){return"ready"},e}(So);var br=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Cr=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.map=i,o.frameState=void 0!==n?n:null,o}return br(e,t),e}(rt);var Mr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Sr=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,r)||this;return a.originalEvent=n,a.pixel_=null,a.coordinate_=null,a.dragging=void 0!==o&&o,a.activePointers=s,a}return Mr(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(Cr),Tr={SINGLECLICK:"singleclick",CLICK:St,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Pr="pointerdown";var Er=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Ar=function(t){function e(e,i){var n=t.call(this,e)||this;n.map_=e,n.emulateClicks_=!1,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=void 0===i?1:i,n.down_=null;var o=n.map_.getViewport();return n.activePointers_=[],n.trackedTouches_={},n.element_=o,n.pointerdownListenerKey_=Lt(o,Pr,n.handlePointerDown_,n),n.relayedListenerKey_=Lt(o,"pointermove",n.relayMoveEvent_,n),n.boundHandleTouchMove_=n.handleTouchMove_.bind(n),n.element_.addEventListener(Et,n.boundHandleTouchMove_,!!en&&{passive:!1}),n}return Er(e,t),e.prototype.emulateClick_=function(t){var e=new Sr(Tr.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Sr(Tr.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((function(){this.clickTimeoutId_=void 0;var e=new Sr(Tr.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}).bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t,i=e.pointerId;if(e.type==Tr.POINTERUP||e.type==Tr.POINTERCANCEL){for(var n in delete this.trackedTouches_[i],this.trackedTouches_)if(this.trackedTouches_[n].target!==e.target){delete this.trackedTouches_[n];break}}else e.type!=Tr.POINTERDOWN&&e.type!=Tr.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=yt(this.trackedTouches_)},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Sr(Tr.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(Ot),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);var e=new Sr(Tr.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);for(var i in this.dispatchEvent(e),this.down_={},t){var n=t[i];this.down_[i]="function"==typeof n?gt:n}if(0===this.dragListenerKeys_.length){var o=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Lt(o,Tr.POINTERMOVE,this.handlePointerMove_,this),Lt(o,Tr.POINTERUP,this.handlePointerUp_,this),Lt(this.element_,Tr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==o&&this.dragListenerKeys_.push(Lt(this.element_.getRootNode(),Tr.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;var e=new Sr(Tr.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}},e.prototype.relayMoveEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Sr(Tr.POINTERMOVE,this.map_,t,e))},e.prototype.handleTouchMove_=function(t){var e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Ot(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Et,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ot(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ot),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},e}(bt),Lr="postrender",Rr="loadstart",Or="loadend",Zr="layergroup",Ir="size",kr="target",Nr="view";var Fr=1/0;const Dr=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,mt(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},t.prototype.enqueue=function(t){be(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=Fr&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,o=e[t],r=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),l=h<n&&i[h]<i[a]?h:a;e[t]=e[l],i[t]=i[l],t=l}e[t]=o,i[t]=r,this.siftDown_(s,t)},t.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,o=i[e],r=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>r))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=o,n[e]=r},t.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,o=this.elements_,r=this.priorities_,s=0,a=o.length;for(e=0;e<a;++e)(i=n(t=o[e]))==Fr?delete this.queuedElements_[this.keyFunction_(t)]:(r[s]=i,o[s++]=t);o.length=s,r.length=s,this.heapify_()},t}();var qr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const zr=function(t){function e(e,i){var n=t.call(this,function(t){return e.apply(null,t)},function(t){return t[0].getKey()})||this;return n.boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=i,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return qr(e,t),e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);return i&&e[0].addEventListener(Ct,this.boundHandleTileChange_),i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(2===i||3===i||4===i){e.removeEventListener(Ct,this.boundHandleTileChange_);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,o=0;this.tilesLoading_<t&&o<e&&this.getCount()>0;)n=(i=this.dequeue()[0]).getKey(),0!==i.getState()||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++o,i.load())},e}(Dr);function jr(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]+2*e,i[1]=t[1]+2*e,i}function Gr(t){return t[0]>0&&t[1]>0}function Ur(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function Br(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}var Wr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Yr(t){t instanceof Lo?t.setMapInternal(null):t instanceof wr&&t.getLayers().forEach(Yr)}function Vr(t,e){if(t instanceof Lo)t.setMapInternal(e);else if(t instanceof wr)for(var i=t.getLayers().getArray(),n=0,o=i.length;n<o;++n)Vr(i[n],e)}const Xr=function(t){function e(e){var i=t.call(this)||this,n=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,o,r={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new wr({layers:t.layers});return r.layergroup=s,r.target=t.target,r.view=t.view instanceof oo?t.view:new oo,void 0!==t.controls&&(Array.isArray(t.controls)?i=new mr(t.controls.slice()):(be("function"==typeof t.controls.getArray,47),i=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new mr(t.interactions.slice()):(be("function"==typeof t.interactions.getArray,48),n=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new mr(t.overlays.slice()):(be("function"==typeof t.overlays.getArray,49),o=t.overlays):o=new mr,{controls:i,interactions:n,keyboardEventTarget:e,overlays:o,values:r}}(e);i.loaded_=!0,i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(i),i.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,i.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:Qi,i.animationDelay_=(function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}).bind(i),i.coordinateToPixelTransform_=[1,0,0,1,0,0],i.pixelToCoordinateTransform_=[1,0,0,1,0,0],i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.viewport_=document.createElement("div"),i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.viewport_.style.position="relative",i.viewport_.style.overflow="hidden",i.viewport_.style.width="100%",i.viewport_.style.height="100%",i.overlayContainer_=document.createElement("div"),i.overlayContainer_.style.position="absolute",i.overlayContainer_.style.zIndex="0",i.overlayContainer_.style.width="100%",i.overlayContainer_.style.height="100%",i.overlayContainer_.style.pointerEvents="none",i.overlayContainer_.className="ol-overlaycontainer",i.viewport_.appendChild(i.overlayContainer_),i.overlayContainerStopEvent_=document.createElement("div"),i.overlayContainerStopEvent_.style.position="absolute",i.overlayContainerStopEvent_.style.zIndex="0",i.overlayContainerStopEvent_.style.width="100%",i.overlayContainerStopEvent_.style.height="100%",i.overlayContainerStopEvent_.style.pointerEvents="none",i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",i.viewport_.appendChild(i.overlayContainerStopEvent_),i.mapBrowserEventHandler_=null,i.moveTolerance_=e.moveTolerance,i.keyboardEventTarget_=n.keyboardEventTarget,i.targetChangeHandlerKeys_=null,i.controls=n.controls||new mr,i.interactions=n.interactions||new mr,i.overlays_=n.overlays,i.overlayIdIndex_={},i.renderer_=null,i.postRenderFunctions_=[],i.tileQueue_=new zr(i.getTilePriority.bind(i),i.handleTileChange_.bind(i)),i.addChangeListener(Zr,i.handleLayerGroupChanged_),i.addChangeListener(Nr,i.handleViewChanged_),i.addChangeListener(Ir,i.handleSizeChanged_),i.addChangeListener(kr,i.handleTargetChanged_),i.setProperties(n.values);var o=i;return!e.view||e.view instanceof oo||e.view.then(function(t){o.setView(new oo(t))}),i.controls.addEventListener(pr,(function(t){t.element.setMap(this)}).bind(i)),i.controls.addEventListener(dr,(function(t){t.element.setMap(null)}).bind(i)),i.interactions.addEventListener(pr,(function(t){t.element.setMap(this)}).bind(i)),i.interactions.addEventListener(dr,(function(t){t.element.setMap(null)}).bind(i)),i.overlays_.addEventListener(pr,(function(t){this.addOverlayInternal_(t.element)}).bind(i)),i.overlays_.addEventListener(dr,(function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}).bind(i)),i.controls.forEach((function(t){t.setMap(this)}).bind(i)),i.interactions.forEach((function(t){t.setMap(this)}).bind(i)),i.overlays_.forEach(i.addOverlayInternal_.bind(i)),i}return Wr(e,t),e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.handleLayerAdd_=function(t){Vr(t.layer,this)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_&&this.renderer_){var n=this.getCoordinateFromPixelInternal(t);return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,!1!==i.checkWrapped,e,null,void 0!==i.layerFilter?i.layerFilter:dt,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=[];return this.forEachFeatureAtPixel(t,function(t){i.push(t)},e),i},e.prototype.getAllLayers=function(){var t=[];return function e(i){i.forEach(function(i){i instanceof wr?e(i.getLayers()):t.push(i)})}(this.getLayers()),t},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_&&this.renderer_){var n=i||{};return this.renderer_.forEachLayerAtPixel(t,this.frameState_,void 0!==n.hitTolerance?n.hitTolerance:0,e,n.layerFilter||dt)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_||!this.renderer_)return!1;var i=this.getCoordinateFromPixelInternal(t);return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,void 0!==(e=void 0!==e?e:{}).hitTolerance?e.hitTolerance:0,!1!==e.checkWrapped,void 0!==e.layerFilter?e.layerFilter:dt,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(kr)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return Pi(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?nn(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(Zr)},e.prototype.setLayers=function(t){var e=this.getLayerGroup();if(t instanceof mr)e.setLayers(t);else{var i=e.getLayers();i.clear(),i.extend(t)}},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e];if(n.visible){var o=n.layer.getRenderer();if(o&&!o.ready)return!0;var r=n.layer.getSource();if(r&&r.loading)return!0}}return!1},e.prototype.getPixelFromCoordinate=function(t){var e=Ei(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},e.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?nn(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(Ir)},e.prototype.getView=function(){return this.get(Nr)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,e,i,n){return function(t,e,i,n,o){if(!t||!(i in t.wantedTiles))return Fr;if(!t.wantedTiles[i][e.getKey()])return Fr;var r=t.viewState.center,s=n[0]-r[0],a=n[1]-r[1];return 65536*Math.log(o)+Math.sqrt(s*s+a*a)/o}(this.frameState_,t,e,i,n)},e.prototype.handleBrowserEvent=function(t,e){var i=new Sr(e||t.type,this,t);this.handleMapBrowserEvent(i)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){var e=t.originalEvent,i=e.type;if(i===Pr||i===At||i===Tt){var n=this.getOwnerDocument(),o=this.viewport_.getRootNode?this.viewport_.getRootNode():n,r=e.target;if(this.overlayContainerStopEvent_.contains(r)||!(o===n?n.documentElement:o).contains(r))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t))for(var s=this.getInteractions().getArray().slice(),a=s.length-1;a>=0;a--){var h=s[a];if(h.getMap()===this&&h.getActive()&&this.getTargetElement()&&(!h.handleEvent(t)||t.propagationStopped))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var o=t.viewHints;if(o[0]||o[1]){var r=Date.now()-t.time>8;i=r?0:8,n=r?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(Po)&&this.renderer_.dispatchRenderEvent(Po,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Cr(Or,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Cr(Rr,this,t))));for(var s=this.postRenderFunctions_,a=0,h=s.length;a<h;++a)s[a](this,t);s.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)Ot(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Mt,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(At,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Bo(this.viewport_)}var i=this.getTargetElement();if(i){for(var n in i.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new Ar(this,this.moveTolerance_),Tr)this.mapBrowserEventHandler_.addEventListener(Tr[n],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Mt,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(At,this.boundHandleBrowserEvent_,!!en&&{passive:!1});var o=this.getOwnerDocument().defaultView,r=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[Lt(r,Tt,this.handleBrowserEvent,this),Lt(r,Pt,this.handleBrowserEvent,this),Lt(o,"resize",this.updateSize,this)]}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Ot(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ot(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Lt(t,st,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Lt(t,Ct,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ot),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new vr("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Lt(t,st,this.render,this),Lt(t,Ct,this.render,this),Lt(t,"addlayer",this.handleLayerAdd_,this),Lt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.handleLayerRemove_=function(t){Yr(t.layer)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e=this,i=this.getSize(),n=this.getView(),o=this.frameState_,r=null;if(void 0!==i&&Gr(i)&&n&&n.isDef()){var s=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Ye(a.center,a.resolution,a.rotation,i),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:s,wantedTiles:{},mapId:Ft(this),renderTargets:{}},a.nextCenter&&a.nextResolution){var h=isNaN(a.nextRotation)?a.rotation:a.nextRotation;r.nextExtent=Ye(a.nextCenter,a.nextResolution,h,i)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),o&&(!this.previousExtent_||!ti(this.previousExtent_)&&!ke(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Cr("movestart",this,o)),this.previousExtent_=Oe(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!ke(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Cr("moveend",this,r)),Se(r.extent,this.previousExtent_))),this.dispatchEvent(new Cr(Lr,this,r)),this.renderComplete_=this.hasListener(Rr)||this.hasListener(Or)||this.hasListener(Po)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){e.postRenderTimeoutHandle_=void 0,e.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){var e=this.getLayerGroup();e&&this.handleLayerRemove_(new vr("removelayer",e)),this.set(Zr,t)},e.prototype.setSize=function(t){this.set(Ir,t)},e.prototype.setTarget=function(t){this.set(kr,t)},e.prototype.setView=function(t){if(!t||t instanceof oo)this.set(Nr,t);else{this.set(Nr,new oo);var e=this;t.then(function(t){e.setView(new oo(t))})}},e.prototype.updateSize=function(){var t=this.getTargetElement(),e=void 0;if(t){var i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),o=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(n)||isNaN(o)||!Gr(e=[n,o])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0.")}this.setSize(e),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var e=void 0,i=getComputedStyle(this.viewport_);i.width&&i.height&&(e=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(e)}},e}(zt);var Hr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Kr=function(t){function e(e){var i=t.call(this)||this,n=e.element;return!n||e.target||n.style.pointerEvents||(n.style.pointerEvents="auto"),i.element=n||null,i.target_=null,i.map_=null,i.listenerKeys=[],e.render&&(i.render=e.render),e.target&&i.setTarget(e.target),i}return Hr(e,t),e.prototype.disposeInternal=function(){Bo(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Bo(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)Ot(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==gt&&this.listenerKeys.push(Lt(t,Lr,this.render,this)),t.render())},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(zt);var Jr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Qr=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this).ulElement_=document.createElement("ul"),i.collapsed_=void 0===n.collapsed||n.collapsed,i.userCollapsed_=i.collapsed_,i.overrideCollapsible_=void 0!==n.collapsible,i.collapsible_=void 0===n.collapsible||n.collapsible,i.collapsible_||(i.collapsed_=!1);var o=void 0!==n.className?n.className:"ol-attribution",r=void 0!==n.tipLabel?n.tipLabel:"Attributions",s=void 0!==n.expandClassName?n.expandClassName:o+"-expand",a=void 0!==n.collapseLabel?n.collapseLabel:"\u203a",h=void 0!==n.collapseClassName?n.collapseClassName:o+"-collapse";"string"==typeof a?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=a,i.collapseLabel_.className=h):i.collapseLabel_=a;var l=void 0!==n.label?n.label:"i";"string"==typeof l?(i.label_=document.createElement("span"),i.label_.textContent=l,i.label_.className=s):i.label_=l;var u=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_;i.toggleButton_=document.createElement("button"),i.toggleButton_.setAttribute("type","button"),i.toggleButton_.setAttribute("aria-expanded",String(!i.collapsed_)),i.toggleButton_.title=r,i.toggleButton_.appendChild(u),i.toggleButton_.addEventListener(St,i.handleClick_.bind(i),!1);var c=i.element;return c.className=o+" ol-unselectable "+Fo+(i.collapsed_&&i.collapsible_?" ol-collapsed":"")+(i.collapsible_?"":" ol-uncollapsible"),c.appendChild(i.toggleButton_),c.appendChild(i.ulElement_),i.renderedAttributions_=[],i.renderedVisible_=!0,i}return Jr(e,t),e.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],n=!0,o=t.layerStatesArray,r=0,s=o.length;r<s;++r){var a=o[r];if(Ao(a,t.viewState)){var h=a.layer.getSource();if(h){var l=h.getAttributions();if(l){var u=l(t);if(u)if(n=n&&!1!==h.getAttributionsCollapsible(),Array.isArray(u))for(var c=0,p=u.length;c<p;++c)u[c]in e||(i.push(u[c]),e[u[c]]=!0);else u in e||(i.push(u),e[u]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(n),i},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!pt(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(var n=0,o=e.length;n<o;++n){var r=document.createElement("li");r.innerHTML=e[n],this.ulElement_.appendChild(r)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?Uo(this.collapseLabel_,this.label_):Uo(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(Kr);var $r=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const ts=function(t){function e(e){var i=this,n=e||{};i=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;var o=void 0!==n.className?n.className:"ol-rotate",r=void 0!==n.label?n.label:"\u21e7",s=void 0!==n.compassClassName?n.compassClassName:"ol-compass";i.label_=null,"string"==typeof r?(i.label_=document.createElement("span"),i.label_.className=s,i.label_.textContent=r):(i.label_=r,i.label_.classList.add(s));var a=n.tipLabel?n.tipLabel:"Reset rotation",h=document.createElement("button");h.className=o+"-reset",h.setAttribute("type","button"),h.title=a,h.appendChild(i.label_),h.addEventListener(St,i.handleClick_.bind(i),!1);var l=i.element;return l.className=o+" ol-unselectable "+Fo,l.appendChild(h),i.callResetNorth_=n.resetNorth?n.resetNorth:void 0,i.duration_=void 0!==n.duration?n.duration:250,i.autoHide_=void 0===n.autoHide||n.autoHide,i.rotation_=void 0,i.autoHide_&&i.element.classList.add(No),i}return $r(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:zi}):t.setRotation(0))}},e.prototype.render=function(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var o=this.element.classList.contains(No);o||0!==i?o&&0!==i&&this.element.classList.remove(No):this.element.classList.add(No)}this.label_.style.transform=n}this.rotation_=i}},e}(Kr);var es=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const is=function(t){function e(e){var i=this,n=e||{};i=t.call(this,{element:document.createElement("div"),target:n.target})||this;var o=void 0!==n.className?n.className:"ol-zoom",r=void 0!==n.delta?n.delta:1,s=void 0!==n.zoomInClassName?n.zoomInClassName:o+"-in",a=void 0!==n.zoomOutClassName?n.zoomOutClassName:o+"-out",h=void 0!==n.zoomInLabel?n.zoomInLabel:"+",l=void 0!==n.zoomOutLabel?n.zoomOutLabel:"\u2013",u=void 0!==n.zoomInTipLabel?n.zoomInTipLabel:"Zoom in",c=void 0!==n.zoomOutTipLabel?n.zoomOutTipLabel:"Zoom out",p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=u,p.appendChild("string"==typeof h?document.createTextNode(h):h),p.addEventListener(St,i.handleClick_.bind(i,r),!1);var d=document.createElement("button");d.className=a,d.setAttribute("type","button"),d.title=c,d.appendChild("string"==typeof l?document.createTextNode(l):l),d.addEventListener(St,i.handleClick_.bind(i,-r),!1);var f=i.element;return f.className=o+" ol-unselectable "+Fo,f.appendChild(p),f.appendChild(d),i.duration_=void 0!==n.duration?n.duration:250,i}return es(e,t),e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getZoom();if(void 0!==i){var n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:zi})):e.setZoom(n)}}},e}(Kr);function ns(t){var e=t||{},i=new mr;return(void 0===e.zoom||e.zoom)&&i.push(new is(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new ts(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new Qr(e.attributionOptions)),i}const os="active";var rs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function ss(t,e,i,n){var o=t.getZoom();if(void 0!==o){var r=t.getConstrainedZoom(o+e),s=t.getResolutionForZoom(r);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:i,duration:void 0!==n?n:250,easing:zi})}}const as=function(t){function e(e){var i=t.call(this)||this;return e&&e.handleEvent&&(i.handleEvent=e.handleEvent),i.map_=null,i.setActive(!0),i}return rs(e,t),e.prototype.getActive=function(){return this.get(os)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(os,t)},e.prototype.setMap=function(t){this.map_=t},e}(zt);var hs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const ls=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.delta_=n.delta?n.delta:1,i.duration_=void 0!==n.duration?n.duration:250,i}return hs(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==Tr.DBLCLICK){var i=t.originalEvent,n=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;ss(t.map.getView(),o,n,this.duration_),i.preventDefault(),e=!0}return!e},e}(as);var us=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function cs(t){for(var e=t.length,i=0,n=0,o=0;o<e;o++)i+=t[o].clientX,n+=t[o].clientY;return[i/e,n/e]}const ps=function(t){function e(e){var i=this,n=e||{};return i=t.call(this,n)||this,n.handleDownEvent&&(i.handleDownEvent=n.handleDownEvent),n.handleDragEvent&&(i.handleDragEvent=n.handleDragEvent),n.handleMoveEvent&&(i.handleMoveEvent=n.handleMoveEvent),n.handleUpEvent&&(i.handleUpEvent=n.handleUpEvent),n.stopDown&&(i.stopDown=n.stopDown),i.handlingDownUpSequence=!1,i.targetPointers=[],i}return us(e,t),e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Tr.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Tr.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Tr.POINTERDOWN){var n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Tr.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){t.activePointers&&(this.targetPointers=t.activePointers)},e}(as);function ds(t){var e=arguments;return function(t){for(var i=!0,n=0,o=e.length;n<o&&(i=i&&e[n](t));++n);return i}}var fs=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},gs=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){var e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(t)},_s=dt,ms=function(t){var e=t.originalEvent;return 0==e.button&&!(Ki&&Ji&&e.ctrlKey)},ys=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},vs=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},xs=function(t){var e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},ws=function(t){var e=t.originalEvent;return be(void 0!==e,56),"mouse"==e.pointerType},bs=function(t){var e=t.originalEvent;return be(void 0!==e,56),e.isPrimary&&0===e.button},Cs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Ms=function(t){function e(e){var i=t.call(this,{stopDown:ft})||this,n=e||{};i.kinetic_=n.kinetic,i.lastCentroid=null,i.panning_=!1;var o=n.condition?n.condition:ds(ys,bs);return i.condition_=n.onFocusOnly?ds(gs,o):o,i.noKinetic_=!1,i}return Cs(e,t),e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e,i,n=this.targetPointers,o=cs(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(o[0],o[1]),this.lastCentroid){var r=[this.lastCentroid[0]-o[0],o[1]-this.lastCentroid[1]],s=t.map.getView();e=r,i=s.getResolution(),e[0]*=i,e[1]*=i,oi(r,s.getRotation()),s.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=o,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),o=this.kinetic_.getAngle(),r=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),a=e.getCoordinateFromPixelInternal([s[0]-n*Math.cos(o),s[1]-n*Math.sin(o)]);i.animateInternal({center:i.getConstrainedCenter(a),duration:500,easing:zi})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(ps);var Ss=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Ts=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,{stopDown:ft})||this).condition_=n.condition?n.condition:fs,i.lastAngle_=void 0,i.duration_=void 0!==n.duration?n.duration:250,i}return Ss(e,t),e.prototype.handleDragEvent=function(t){if(ws(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==Fi){var n=e.getSize(),o=t.pixel,r=Math.atan2(n[1]/2-o[1],o[0]-n[0]/2);void 0!==this.lastAngle_&&i.adjustRotationInternal(-(r-this.lastAngle_)),this.lastAngle_=r}}},e.prototype.handleUpEvent=function(t){return!ws(t)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){return!(!ws(t)||!ms(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0,0))},e}(ps);var Ps=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Es=function(t){function e(e){var i=t.call(this)||this;return i.geometry_=null,i.element_=document.createElement("div"),i.element_.style.position="absolute",i.element_.style.pointerEvents="auto",i.element_.className="ol-box "+e,i.map_=null,i.startPixel_=null,i.endPixel_=null,i}return Ps(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Qn([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(at);var As=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ls=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.coordinate=i,o.mapBrowserEvent=n,o}return As(e,t),e}(rt);const Rs=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.box_=new Es(n.className||"ol-dragbox"),i.minArea_=void 0!==n.minArea?n.minArea:64,n.onBoxEnd&&(i.onBoxEnd=n.onBoxEnd),i.startPixel_=null,i.condition_=n.condition?n.condition:ms,i.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:i.defaultBoxEndCondition,i}return As(e,t),e.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0],o=i[1]-e[1];return n*n+o*o>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Ls("boxdrag",t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Ls(e?"boxend":"boxcancel",t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ls("boxstart",t.coordinate,t)),!0)},e.prototype.onBoxEnd=function(t){},e}(ps);var Os=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Zs=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,{condition:n.condition?n.condition:vs,className:n.className||"ol-dragzoom",minArea:n.minArea})||this).duration_=void 0!==n.duration?n.duration:200,i.out_=void 0!==n.out&&n.out,i}return Os(e,t),e.prototype.onBoxEnd=function(t){var e=this.getMap().getView(),i=this.getGeometry();if(this.out_){var n=e.rotatedExtentForGeometry(i),o=e.getResolutionForExtentInternal(n),r=e.getResolution()/o;(i=i.clone()).scale(r*r)}e.fitInternal(i,{duration:this.duration_,easing:zi})},e}(Rs);var Is=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const ks=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.defaultCondition_=function(t){return ys(t)&&xs(t)},i.condition_=void 0!==n.condition?n.condition:i.defaultCondition_,i.duration_=void 0!==n.duration?n.duration:100,i.pixelDelta_=void 0!==n.pixelDelta?n.pixelDelta:128,i}return Is(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==Tt){var i=t.originalEvent,n=i.keyCode;if(this.condition_(t)&&(40==n||37==n||39==n||38==n)){var o=t.map.getView(),r=o.getResolution()*this.pixelDelta_,s=0,a=0;40==n?a=-r:37==n?s=-r:39==n?s=r:a=r;var h=[s,a];oi(h,o.getRotation()),function(t,e,i){var n=t.getCenterInternal();n&&t.animateInternal({duration:void 0!==i?i:250,easing:Gi,center:t.getConstrainedCenter([n[0]+e[0],n[1]+e[1]])})}(o,h,this.duration_),i.preventDefault(),e=!0}}return!e},e}(as);var Ns=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Fs=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.condition_=n.condition?n.condition:xs,i.delta_=n.delta?n.delta:1,i.duration_=void 0!==n.duration?n.duration:100,i}return Ns(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==Tt||t.type==Pt){var i=t.originalEvent,n=i.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var o=t.map,r=n=="+".charCodeAt(0)?this.delta_:-this.delta_;ss(o.getView(),r,void 0,this.duration_),i.preventDefault(),e=!0}}return!e},e}(as),Ds=function(){function t(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var o=this.points_[e]-this.points_[i],r=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(r,o),this.initialVelocity_=Math.sqrt(o*o+r*r)/n,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}();var qs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),zs="trackpad";const js=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,n)||this).totalDelta_=0,i.lastDelta_=0,i.maxDelta_=void 0!==n.maxDelta?n.maxDelta:1,i.duration_=void 0!==n.duration?n.duration:250,i.timeout_=void 0!==n.timeout?n.timeout:80,i.useAnchor_=void 0===n.useAnchor||n.useAnchor,i.constrainResolution_=void 0!==n.constrainResolution&&n.constrainResolution;var o=n.condition?n.condition:_s;return i.condition_=n.onFocusOnly?ds(gs,o):o,i.lastAnchor_=null,i.startTime_=void 0,i.mode_=void 0,i.trackpadEventGap_=400,i.deltaPerZoom_=300,i}return qs(e,t),e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==At)return!0;var e,i=t.map,n=t.originalEvent;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==At&&(e=n.deltaY,Hi&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=Qi),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var o=Date.now();void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?zs:"wheel");var r=i.getView();if(this.mode_===zs&&!r.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(r.getAnimating()&&r.cancelAnimations(),r.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),r.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=e;var s=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),s),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var i=-Yt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),ss(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(as);var Gs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Us=function(t){function e(e){var i=this,n=e||{},o=n;return o.stopDown||(o.stopDown=ft),(i=t.call(this,o)||this).anchor_=null,i.lastAngle_=void 0,i.rotating_=!1,i.rotationDelta_=0,i.threshold_=void 0!==n.threshold?n.threshold:.3,i.duration_=void 0!==n.duration?n.duration:250,i}return Gs(e,t),e.prototype.handleDragEvent=function(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],o=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var r=o-this.lastAngle_;this.rotationDelta_+=r,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=r}this.lastAngle_=o;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==Fi){var h=s.getViewport().getBoundingClientRect(),l=cs(this.targetPointers);l[0]-=h.left,l[1]-=h.top,this.anchor_=s.getCoordinateFromPixelInternal(l),this.rotating_&&(s.render(),a.adjustRotationInternal(e,this.anchor_))}},e.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(ps);var Bs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Ws=function(t){function e(e){var i=this,n=e||{},o=n;return o.stopDown||(o.stopDown=ft),(i=t.call(this,o)||this).anchor_=null,i.duration_=void 0!==n.duration?n.duration:400,i.lastDistance_=void 0,i.lastScaleDelta_=1,i}return Bs(e,t),e.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],o=i.clientX-n.clientX,r=i.clientY-n.clientY,s=Math.sqrt(o*o+r*r);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,h=a.getView();1!=e&&(this.lastScaleDelta_=e);var l=a.getViewport().getBoundingClientRect(),u=cs(this.targetPointers);u[0]-=l.left,u[1]-=l.top,this.anchor_=a.getCoordinateFromPixelInternal(u),a.render(),h.adjustResolutionInternal(e,this.anchor_)},e.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_,this.lastScaleDelta_>1?1:-1),1))},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(ps);var Ys=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Vs=function(t){function e(e){return(e=_t({},e)).controls||(e.controls=ns()),e.interactions||(e.interactions=function(t){var e={onFocusOnly:!0}||{},i=new mr,n=new Ds(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new Ts),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new ls({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new Ms({onFocusOnly:e.onFocusOnly,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new Us),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new Ws({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new ks),i.push(new Fs({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new js({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new Zs({duration:e.zoomDuration})),i}()),t.call(this,e)||this}return Ys(e,t),e.prototype.createRenderer=function(){return new cr(this)},e}(Xr);var Xs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hs="units",Ks="degrees",Js="metric",Qs=[1,2,5],$s=25.4/.28;const ta=function(t){function e(e){var i=this,n=e||{},o=void 0!==n.className?n.className:n.bar?"ol-scale-bar":"ol-scale-line";return(i=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this).innerElement_=document.createElement("div"),i.innerElement_.className=o+"-inner",i.element.className=o+" ol-unselectable",i.element.appendChild(i.innerElement_),i.viewState_=null,i.minWidth_=void 0!==n.minWidth?n.minWidth:64,i.maxWidth_=n.maxWidth,i.renderedVisible_=!1,i.renderedWidth_=void 0,i.renderedHTML_="",i.addChangeListener(Hs,i.handleUnitsChanged_),i.setUnits(n.units||Js),i.scaleBar_=n.bar||!1,i.scaleBarSteps_=n.steps||4,i.scaleBarText_=n.text||!1,i.dpi_=n.dpi||void 0,i}return Xs(e,t),e.prototype.getUnits=function(){return this.get(Hs)},e.prototype.handleUnitsChanged_=function(){this.updateElement_()},e.prototype.setUnits=function(t){this.set(Hs,t)},e.prototype.setDpi=function(t){this.dpi_=t},e.prototype.updateElement_=function(){var t=this.viewState_;if(t){var e=t.center,i=t.projection,n=this.getUnits(),o=gi(i,t.resolution,e,n==Ks?Ut.DEGREES:Ut.METERS),r=this.minWidth_*(this.dpi_||$s)/$s,s=void 0!==this.maxWidth_?this.maxWidth_*(this.dpi_||$s)/$s:void 0,a=r*o,h="";if(n==Ks){var l=Gt[Ut.DEGREES];(a*=l)<l/60?(h="\u2033",o*=3600):a<l?(h="\u2032",o*=60):h="\xb0"}else"imperial"==n?a<.9144?(h="in",o/=.0254):a<1609.344?(h="ft",o/=.3048):(h="mi",o/=1609.344):"nautical"==n?(o/=1852,h="NM"):n==Js?a<.001?(h="\u03bcm",o*=1e6):a<1?(h="mm",o*=1e3):a<1e3?h="m":(h="km",o/=1e3):"us"==n?a<.9144?(h="in",o*=39.37):a<1609.344?(h="ft",o/=.30480061):(h="mi",o/=1609.3472):be(!1,33);for(var u,c,p,d,f,g,_,m=3*Math.floor(Math.log(r*o)/Math.log(10));;){p=Math.floor(m/3);var y=Math.pow(10,p);if(u=Qs[(m%3+3)%3]*y,c=Math.round(u/o),isNaN(c))return this.element.style.display="none",void(this.renderedVisible_=!1);if(void 0!==s&&c>=s){u=d,c=f,p=g;break}if(c>=r)break;d=u,f=c,g=p,++m}_=this.scaleBar_?this.createScaleBar(c,u,h):u.toFixed(p<0?-p:0)+" "+h,this.renderedHTML_!=_&&(this.innerElement_.innerHTML=_,this.renderedHTML_=_),this.renderedWidth_!=c&&(this.innerElement_.style.width=c+"px",this.renderedWidth_=c),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.createScaleBar=function(t,e,i){for(var n="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),o=[],r=t/this.scaleBarSteps_,s="ol-scale-singlebar-odd",a=0;a<this.scaleBarSteps_;a++)0===a&&o.push(this.createMarker("absolute",a)),o.push('<div><div class="ol-scale-singlebar '+s+'" style="width: '+r+'px;"></div>'+this.createMarker("relative",a)+(a%2==0||2===this.scaleBarSteps_?this.createStepText(a,t,!1,e,i):"")+"</div>"),a===this.scaleBarSteps_-1&&o.push(this.createStepText(a+1,t,!0,e,i)),s="ol-scale-singlebar-odd"===s?"ol-scale-singlebar-even":"ol-scale-singlebar-odd";return'<div style="display: flex;">'+(this.scaleBarText_?'<div class="ol-scale-text" style="width: '+t+'px;">'+n+"</div>":"")+o.join("")+"</div>"},e.prototype.createMarker=function(t,e){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+("absolute"===t?3:-10)+'px;"></div>'},e.prototype.createStepText=function(t,e,i,n,o){var r=0===t?0:Math.round(n/this.scaleBarSteps_*t*100)/100;return'<div class="ol-scale-step-text" style="margin-left: '+(0===t?-3:e/this.scaleBarSteps_*-1)+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+(0===t?0:e/this.scaleBarSteps_*2)+"px;left: "+(i?e+"px":"unset")+';">'+r+(0===t?"":" "+o)+"</div>"},e.prototype.getScaleForResolution=function(){var t=gi(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,Ut.METERS),e=this.dpi_||$s;return parseFloat(t.toString())*(1e3/25.4)*e},e.prototype.render=function(t){var e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()},e}(Kr);var ea=6378137,ia=.0066943799901413165,na=484813681109536e-20,oa=Math.PI/2,ra=1e-10,sa=.017453292519943295,aa=57.29577951308232,ha=Math.PI/4,la=2*Math.PI,ua=3.14159265359,ca={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const pa={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var da=/[\s_\-\/\(\)]/g;function fa(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),o=e.toLowerCase().replace(da,""),r=-1;++r<n.length;)if((i=n[r]).toLowerCase().replace(da,"")===o)return t[i]}function ga(t){var e,i,n,o={},r=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t},{}),s={proj:"projName",datum:"datumCode",rf:function(t){o.rf=parseFloat(t)},lat_0:function(t){o.lat0=t*sa},lat_1:function(t){o.lat1=t*sa},lat_2:function(t){o.lat2=t*sa},lat_ts:function(t){o.lat_ts=t*sa},lon_0:function(t){o.long0=t*sa},lon_1:function(t){o.long1=t*sa},lon_2:function(t){o.long2=t*sa},alpha:function(t){o.alpha=parseFloat(t)*sa},gamma:function(t){o.rectified_grid_angle=parseFloat(t)},lonc:function(t){o.longc=t*sa},x_0:function(t){o.x0=parseFloat(t)},y_0:function(t){o.y0=parseFloat(t)},k_0:function(t){o.k0=parseFloat(t)},k:function(t){o.k0=parseFloat(t)},a:function(t){o.a=parseFloat(t)},b:function(t){o.b=parseFloat(t)},r_a:function(){o.R_A=!0},zone:function(t){o.zone=parseInt(t,10)},south:function(){o.utmSouth=!0},towgs84:function(t){o.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){o.to_meter=parseFloat(t)},units:function(t){o.units=t;var e=fa(pa,t);e&&(o.to_meter=e.to_meter)},from_greenwich:function(t){o.from_greenwich=t*sa},pm:function(t){var e=fa(ca,t);o.from_greenwich=(e||parseFloat(t))*sa},nadgrids:function(t){"@null"===t?o.datumCode="none":o.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(o.axis=t)},approx:function(){o.approx=!0}};for(e in r)i=r[e],e in s?"function"==typeof(n=s[e])?n(i):o[n]=i:o[e]=i;return"string"==typeof o.datumCode&&"WGS84"!==o.datumCode&&(o.datumCode=o.datumCode.toLowerCase()),o}var _a=/\s/,ma=/[A-Za-z]/,ya=/[A-Za-z84_]/,va=/[,\]]/,xa=/[\d\.E\-\+]/;function wa(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function ba(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var n=i.reduce(function(t,e){return Ca(e,t),t},e?{}:t);e&&(t[e]=n)}function Ca(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void Ca(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var n;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Ca(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Ca(t[3],e[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void ba(e,i,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return Ca(t,e[i]);return ba(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}function Ma(t){return.017453292519943295*t}function Sa(t){var e=new wa(t).output(),i=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",i]);var o={};return Ca(e,o),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):t.projName="object"==typeof t.PROJECTION?Object.keys(t.PROJECTION)[0]:t.PROJECTION,t.AXIS){for(var e="",i=0,n=t.AXIS.length;i<n;++i){var o=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==o[0].indexOf("north")||("y"===o[0]||"lat"===o[0])&&"north"===o[1]?e+="n":-1!==o[0].indexOf("south")||("y"===o[0]||"lat"===o[0])&&"south"===o[1]?e+="s":-1!==o[0].indexOf("east")||("x"===o[0]||"lon"===o[0])&&"east"===o[1]?e+="e":-1===o[0].indexOf("west")&&("x"!==o[0]&&"lon"!==o[0]||"west"!==o[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var r=t.GEOGCS;function s(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(r=t),r&&(t.datumCode=r.DATUM?r.DATUM.name.toLowerCase():r.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(t.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=r.DATUM.SPHEROID.a,t.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),r.DATUM&&r.DATUM.TOWGS84&&(t.datum_params=r.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ma],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ma],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",Ma],["lat0","latitude_of_origin",Ma],["lat0","standard_parallel_1",Ma],["lat1","standard_parallel_1",Ma],["lat2","standard_parallel_2",Ma],["azimuth","Azimuth"],["alpha","azimuth",Ma],["srsCode","name"]].forEach(function(e){return function(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],3===e.length&&(t[i]=e[2](t[i])))}(t,e)}),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=Ma(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(o),o}function Ta(t){var e=this;if(2===arguments.length){var i=arguments[1];Ta[t]="string"==typeof i?"+"===i.charAt(0)?ga(arguments[1]):Sa(arguments[1]):i}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?Ta.apply(e,t):Ta(t)});if("string"==typeof t){if(t in Ta)return Ta[t]}else"EPSG"in t?Ta["EPSG:"+t.EPSG]=t:"ESRI"in t?Ta["ESRI:"+t.ESRI]=t:"IAU2000"in t?Ta["IAU2000:"+t.IAU2000]=t:console.log(t);return}}wa.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;_a.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case 1:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},wa.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(va.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},wa.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},wa.prototype.number=function(t){if(!xa.test(t)){if(va.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},wa.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},wa.prototype.keyword=function(t){if(ya.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=1)}if(!va.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},wa.prototype.neutral=function(t){if(ma.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(xa.test(t))return this.word=t,void(this.state=3);if(!va.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},wa.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)},function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Ta);const Pa=Ta;var Ea=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Aa=["3857","900913","3785","102113"];function La(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}function Ra(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function Oa(t){return t<0?-1:1}function Za(t){return Math.abs(t)<=ua?t:t-Oa(t)*la}function Ia(t,e,i){var n=t*i;return n=Math.pow((1-n)/(1+n),.5*t),Math.tan(.5*(oa-e))/n}function ka(t,e){for(var i,n,o=.5*t,r=oa-2*Math.atan(e),s=0;s<=15;s++)if(i=t*Math.sin(r),r+=n=oa-2*Math.atan(e*Math.pow((1-i)/(1+i),o))-r,Math.abs(n)<=1e-10)return r;return-9999}function Na(t){return t}var Fa=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):Ra(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(t){var e,i,n=t.x,o=t.y;if(o*aa>90&&o*aa<-90&&n*aa>180&&n*aa<-180)return null;if(Math.abs(Math.abs(o)-oa)<=ra)return null;if(this.sphere)e=this.x0+this.a*this.k0*Za(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(ha+.5*o));else{var r=Math.sin(o),s=Ia(this.e,o,r);e=this.x0+this.a*this.k0*Za(n-this.long0),i=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n=t.x-this.x0,o=t.y-this.y0;if(this.sphere)i=oa-2*Math.atan(Math.exp(-o/(this.a*this.k0)));else{var r=Math.exp(-o/(this.a*this.k0));if(-9999===(i=ka(this.e,r)))return null}return e=Za(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:Na,inverse:Na,names:["longlat","identity"]}],Da={},qa=[];function za(t,e){var i=qa.length;return t.names?(qa[i]=t,t.names.forEach(function(t){Da[t.toLowerCase()]=i}),this):(console.log(e),!0)}const ja={start:function(){Fa.forEach(za)},add:za,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Da[e]&&qa[Da[e]]?qa[Da[e]]:void 0}};var Ga={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},Ua=Ga.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Ga.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Ba={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},Wa={};function Ya(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:Wa[t]||null,isNull:!1}}function Va(t){return t/3600*Math.PI/180}function Xa(t,e,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,i)))}function Ha(t){return t.map(function(t){return[Va(t.longitudeShift),Va(t.latitudeShift)]})}function Ka(t,e,i){return{name:Xa(t,e+8,e+16).trim(),parent:Xa(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,i),upperLatitude:t.getFloat64(e+88,i),lowerLongitude:t.getFloat64(e+104,i),upperLongitude:t.getFloat64(e+120,i),latitudeInterval:t.getFloat64(e+136,i),longitudeInterval:t.getFloat64(e+152,i),gridNodeCount:t.getInt32(e+168,i)}}function Ja(t,e,i,n){for(var o=e+176,r=[],s=0;s<i.gridNodeCount;s++){var a={latitudeShift:t.getFloat32(o+16*s,n),longitudeShift:t.getFloat32(o+16*s+4,n),latitudeAccuracy:t.getFloat32(o+16*s+8,n),longitudeAccuracy:t.getFloat32(o+16*s+12,n)};r.push(a)}return r}function Qa(t,e){if(!(this instanceof Qa))return new Qa(t);e=e||function(t){if(t)throw t};var i=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in Pa}(t))return Pa[t];if(function(t){return Ea.some(function(e){return t.indexOf(e)>-1})}(t)){var e=Sa(t);if(function(t){var e=fa(t,"authority");if(e){var i=fa(e,"epsg");return i&&Aa.indexOf(i)>-1}}(e))return Pa["EPSG:3857"];var i=function(t){var e=fa(t,"extension");if(e)return fa(e,"proj4")}(e);return i?ga(i):e}return function(t){return"+"===t[0]}(t)?ga(t):void 0}(t);if("object"==typeof i){var n=Qa.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var o=fa(Ba,i.datumCode);o&&(i.datum_params=i.datum_params||(o.towgs84?o.towgs84.split(","):null),i.ellps=o.ellipse,i.datumName=o.datumName?o.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var r,s,a,h,l,u,c=function(t,e,i,n,o){if(!t){var r=fa(Ga,n);r||(r=Ua),t=r.a,e=r.b,i=r.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<ra)&&(o=!0,e=t),{a:t,b:e,rf:i,sphere:o}}(i.a,i.b,i.rf,i.ellps,i.sphere),p=(l=((a=(r=c.a)*r)-(h=(s=c.b)*s))/a,u=0,i.R_A?(a=(r*=1-l*(.16666666666666666+l*(.04722222222222222+.022156084656084655*l)))*r,l=0):u=Math.sqrt(l),{es:l,e:u,ep2:(a-h)/h}),d=function(t){return void 0===t?null:t.split(",").map(Ya)}(i.nadgrids),f=i.datum||function(t,e,i,n,o,r,s){var a={};return a.datum_type=void 0===t||"none"===t?5:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=1),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=2,a.datum_params[3]*=na,a.datum_params[4]*=na,a.datum_params[5]*=na,a.datum_params[6]=a.datum_params[6]/1e6+1))),s&&(a.datum_type=3,a.grids=s),a.a=i,a.b=n,a.es=o,a.ep2=r,a}(i.datumCode,i.datum_params,c.a,c.b,p.es,p.ep2,d);La(this,i),La(this,n),this.a=c.a,this.b=c.b,this.rf=c.rf,this.sphere=c.sphere,this.es=p.es,this.e=p.e,this.ep2=p.ep2,this.datum=f,this.init(),e(null,this)}else e(t)}else e(t)}(Qa.projections=ja).start();const $a=Qa;function th(t,e,i){var n,o,r,s=t.x,a=t.y,h=t.z?t.z:0;if(a<-oa&&a>-1.001*oa)a=-oa;else if(a>oa&&a<1.001*oa)a=oa;else{if(a<-oa)return{x:-1/0,y:-1/0,z:t.z};if(a>oa)return{x:1/0,y:1/0,z:t.z}}return s>Math.PI&&(s-=2*Math.PI),o=Math.sin(a),r=Math.cos(a),{x:((n=i/Math.sqrt(1-e*(o*o)))+h)*r*Math.cos(s),y:(n+h)*r*Math.sin(s),z:(n*(1-e)+h)*o}}function eh(t,e,i,n){var o,r,s,a,h,l,u,c,p,d,f,g,_,m,y,v=t.x,x=t.y,w=t.z?t.z:0;if(o=Math.sqrt(v*v+x*x),r=Math.sqrt(v*v+x*x+w*w),o/i<1e-12){if(m=0,r/i<1e-12)return y=-n,{x:t.x,y:t.y,z:t.z}}else m=Math.atan2(x,v);s=w/r,c=(a=o/r)*(1-e)*(h=1/Math.sqrt(1-e*(2-e)*a*a)),p=s*h,_=0;do{_++,l=e*(u=i/Math.sqrt(1-e*p*p))/(u+(y=o*c+w*p-u*(1-e*p*p))),g=(f=s*(h=1/Math.sqrt(1-l*(2-l)*a*a)))*c-(d=a*(1-l)*h)*p,c=d,p=f}while(g*g>1e-24&&_<30);return{x:m,y:Math.atan(f/Math.abs(d)),z:y}}function ih(t){return 1===t||2===t}function nh(t,e,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var n={x:-i.x,y:i.y},o={x:Number.NaN,y:Number.NaN},r=[],s=0;s<t.grids.length;s++){var a=t.grids[s];if(r.push(a.name),a.isNull){o=n;break}if(null!==a.grid){var h=a.grid.subgrids[0],l=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4;if(!(h.ll[1]-l>n.y||h.ll[0]-l>n.x||h.ll[1]+(h.lim[1]-1)*h.del[1]+l<n.y||h.ll[0]+(h.lim[0]-1)*h.del[0]+l<n.x||(o=oh(n,e,h),isNaN(o.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(o.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*aa+" "+n.y*aa+" tried: '"+r+"'"),-1):(i.x=-o.x,i.y=o.y,0)}function oh(t,e,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var o={x:t.x,y:t.y};o.x-=i.ll[0],o.y-=i.ll[1],o.x=Za(o.x-Math.PI)+Math.PI;var r=rh(o,i);if(e){if(isNaN(r.x))return n;r.x=o.x-r.x,r.y=o.y-r.y;var s,a,h=9;do{if(a=rh(r,i),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}r.x+=(s={x:o.x-(a.x+r.x),y:o.y-(a.y+r.y)}).x,r.y+=s.y}while(h--&&Math.abs(s.x)>1e-12&&Math.abs(s.y)>1e-12);if(h<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=Za(r.x+i.ll[0]),n.y=r.y+i.ll[1]}else isNaN(r.x)||(n.x=t.x+r.x,n.y=t.y+r.y);return n}function rh(t,e){var i,n={x:t.x/e.del[0],y:t.y/e.del[1]},o=Math.floor(n.x),r=Math.floor(n.y),s=n.x-1*o,a=n.y-1*r,h={x:Number.NaN,y:Number.NaN};if(o<0||o>=e.lim[0])return h;if(r<0||r>=e.lim[1])return h;var l=e.cvs[i=r*e.lim[0]+o][0],u=e.cvs[i][1];i++;var c=e.cvs[i][0],p=e.cvs[i][1],d=e.cvs[i+=e.lim[0]][0],f=e.cvs[i][1];i--;var g=e.cvs[i][1],_=s*a,m=s*(1-a),y=(1-s)*(1-a),v=(1-s)*a;return h.x=y*l+m*c+v*e.cvs[i][0]+_*d,h.y=y*u+m*p+v*g+_*f,h}function sh(t,e,i){var n,o,r,s=i.x,a=i.y,h=i.z||0,l={};for(r=0;r<3;r++)if(!e||2!==r||void 0!==i.z)switch(0===r?(n=s,o=-1!=="ew".indexOf(t.axis[r])?"x":"y"):1===r?(n=a,o=-1!=="ns".indexOf(t.axis[r])?"y":"x"):(n=h,o="z"),t.axis[r]){case"e":l[o]=n;break;case"w":l[o]=-n;break;case"n":l[o]=n;break;case"s":l[o]=-n;break;case"u":void 0!==i[o]&&(l.z=n);break;case"d":void 0!==i[o]&&(l.z=-n);break;default:return null}return l}function ah(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function hh(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function lh(t,e,i,n){var o;if(Array.isArray(i)&&(i=ah(i)),function(t){hh(t.x),hh(t.y)}(i),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(i=lh(t,o=new $a("WGS84"),i,n),t=o),n&&"enu"!==t.axis&&(i=sh(t,!1,i)),"longlat"===t.projName)i={x:i.x*sa,y:i.y*sa,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=function(t,e,i){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return i;if(5===t.datum_type||5===e.datum_type)return i;var n=t.a,o=t.es;if(3===t.datum_type){if(0!==nh(t,!1,i))return;n=ea,o=ia}var r=e.a,s=e.b,a=e.es;return 3===e.datum_type&&(r=ea,s=6356752.314,a=ia),o!==a||n!==r||ih(t.datum_type)||ih(e.datum_type)?(i=th(i,o,n),ih(t.datum_type)&&(i=function(t,e,i){if(1===e)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(2===e){var n=i[3],o=i[4],r=i[5],s=i[6];return{x:s*(t.x-r*t.y+o*t.z)+i[0],y:s*(r*t.x+t.y-n*t.z)+i[1],z:s*(-o*t.x+n*t.y+t.z)+i[2]}}}(i,t.datum_type,t.datum_params)),ih(e.datum_type)&&(i=function(t,e,i){if(1===e)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(2===e){var n=i[3],o=i[4],r=i[5],s=i[6],a=(t.x-i[0])/s,h=(t.y-i[1])/s,l=(t.z-i[2])/s;return{x:a+r*h-o*l,y:-r*a+h+n*l,z:o*a-n*h+l}}}(i,e.datum_type,e.datum_params)),i=eh(i,a,r,s),3!==e.datum_type||0===nh(e,!0,i)?i:void 0):i}(t.datum,e.datum,i))return e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*aa,y:i.y*aa,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),n&&"enu"!==e.axis?sh(e,!0,i):i}var uh=$a("WGS84");function ch(t,e,i,n){var o,r,s;return Array.isArray(i)?(o=lh(t,e,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof o.z?[o.x,o.y,o.z].concat(i.splice(3)):[o.x,o.y,i[2]].concat(i.splice(3)):[o.x,o.y].concat(i.splice(2)):[o.x,o.y]):(r=lh(t,e,i,n),2===(s=Object.keys(i)).length||s.forEach(function(n){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;r[n]=i[n]}),r)}function ph(t){return t instanceof $a?t:t.oProj?t.oProj:$a(t)}const dh=function(t,e,i){t=ph(t);var n,o=!1;return void 0===e?(e=t,t=uh,o=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,e=t,t=uh,o=!0),e=ph(e),i?ch(t,e,i):(n={forward:function(i,n){return ch(t,e,i,n)},inverse:function(i,n){return ch(e,t,i,n)}},o&&(n.oProj=e),n)};var fh="AJSAJS",gh="AFAFAF",_h=65,mh=73,yh=79;const vh={forward:xh,inverse:function(t){var e=Mh(Th(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:wh};function xh(t,e){return e=e||5,function(t,e){var i,n,o,r,s,a,h,l,u,c,p,d="00000"+t.easting,f="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(u=t.easting,c=t.northing,p=Sh(t.zoneNumber),i=Math.floor(u/1e5),n=Math.floor(c/1e5)%20,r=fh.charCodeAt(o=p-1),s=gh.charCodeAt(o),l=!1,(a=r+i-1)>90&&(a=a-90+_h-1,l=!0),(a===mh||r<mh&&a>mh||(a>mh||r<mh)&&l)&&a++,(a===yh||r<yh&&a>yh||(a>yh||r<yh)&&l)&&++a===mh&&a++,a>90&&(a=a-90+_h-1),(h=s+n)>86?(h=h-86+_h-1,l=!0):l=!1,(h===mh||s<mh&&h>mh||(h>mh||s<mh)&&l)&&h++,(h===yh||s<yh&&h>yh||(h>yh||s<yh)&&l)&&++h===mh&&h++,h>86&&(h=h-86+_h-1),String.fromCharCode(a)+String.fromCharCode(h))+d.substr(d.length-5,e)+f.substr(f.length-5,e)}(function(t){var e,i,n,o,r,s,a,h=t.lat,l=t.lon,u=6378137,c=.9996,p=bh(h),d=bh(l);a=Math.floor((l+180)/6)+1,180===l&&(a=60),h>=56&&h<64&&l>=3&&l<12&&(a=32),h>=72&&h<84&&(l>=0&&l<9?a=31:l>=9&&l<21?a=33:l>=21&&l<33?a=35:l>=33&&l<42&&(a=37)),s=bh(6*(a-1)-180+3),e=.006739496752268451,i=u/Math.sqrt(1-.00669438*Math.sin(p)*Math.sin(p)),n=Math.tan(p)*Math.tan(p),o=e*Math.cos(p)*Math.cos(p);var f,g,_=c*i*((r=Math.cos(p)*(d-s))+(1-n+o)*r*r*r/6+(5-18*n+n*n+72*o-58*e)*r*r*r*r*r/120)+5e5,m=c*(u*(.9983242984503243*p-.002514607064228144*Math.sin(2*p)+2639046602129982e-21*Math.sin(4*p)-3.418046101696858e-9*Math.sin(6*p))+i*Math.tan(p)*(r*r/2+(5-n+9*o+4*o*o)*r*r*r*r/24+(61-58*n+n*n+600*o-2.2240339282485886)*r*r*r*r*r*r/720));return h<0&&(m+=1e7),{northing:Math.round(m),easting:Math.round(_),zoneNumber:a,zoneLetter:(f=h,g="Z",84>=f&&f>=72?g="X":72>f&&f>=64?g="W":64>f&&f>=56?g="V":56>f&&f>=48?g="U":48>f&&f>=40?g="T":40>f&&f>=32?g="S":32>f&&f>=24?g="R":24>f&&f>=16?g="Q":16>f&&f>=8?g="P":8>f&&f>=0?g="N":0>f&&f>=-8?g="M":-8>f&&f>=-16?g="L":-16>f&&f>=-24?g="K":-24>f&&f>=-32?g="J":-32>f&&f>=-40?g="H":-40>f&&f>=-48?g="G":-48>f&&f>=-56?g="F":-56>f&&f>=-64?g="E":-64>f&&f>=-72?g="D":-72>f&&f>=-80&&(g="C"),g)}}({lat:t[1],lon:t[0]}),e)}function wh(t){var e=Mh(Th(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function bh(t){return t*(Math.PI/180)}function Ch(t){return t/Math.PI*180}function Mh(t){var e=t.northing,i=t.easting,n=t.zoneLetter,o=t.zoneNumber;if(o<0||o>60)return null;var r,s,a,h,l,u,c,p,d,f=.9996,g=6378137,_=.00669438,m=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),y=i-5e5,v=e;n<"N"&&(v-=1e7),c=6*(o-1)-180+3,r=.006739496752268451,d=(p=v/f/6367449.145945056)+(3*m/2-27*m*m*m/32)*Math.sin(2*p)+(21*m*m/16-55*m*m*m*m/32)*Math.sin(4*p)+151*m*m*m/96*Math.sin(6*p),s=g/Math.sqrt(1-_*Math.sin(d)*Math.sin(d)),a=Math.tan(d)*Math.tan(d),h=r*Math.cos(d)*Math.cos(d),l=.99330562*g/Math.pow(1-_*Math.sin(d)*Math.sin(d),1.5),u=y/(s*f);var x=d-s*Math.tan(d)/l*(u*u/2-(5+3*a+10*h-4*h*h-9*r)*u*u*u*u/24+(61+90*a+298*h+45*a*a-1.6983531815716497-3*h*h)*u*u*u*u*u*u/720);x=Ch(x);var w,b=(u-(1+2*a+h)*u*u*u/6+(5-2*h+28*a-3*h*h+8*r+24*a*a)*u*u*u*u*u/120)/Math.cos(d);if(b=c+Ch(b),t.accuracy){var C=Mh({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});w={top:C.lat,right:C.lon,bottom:x,left:b}}else w={lat:x,lon:b};return w}function Sh(t){var e=t%6;return 0===e&&(e=6),e}function Th(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,o="",r=0;!/[A-Z]/.test(e=t.charAt(r));){if(r>=2)throw"MGRSPoint bad conversion from: "+t;o+=e,r++}var s=parseInt(o,10);if(0===r||r+3>i)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(r++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(r,r+=2);for(var h=Sh(s),l=function(t,e){for(var i=fh.charCodeAt(e-1),n=1e5,o=!1;i!==t.charCodeAt(0);){if(++i===mh&&i++,i===yh&&i++,i>90){if(o)throw"Bad character: "+t;i=_h,o=!0}n+=1e5}return n}(n.charAt(0),h),u=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=gh.charCodeAt(e-1),n=0,o=!1;i!==t.charCodeAt(0);){if(++i===mh&&i++,i===yh&&i++,i>86){if(o)throw"Bad character: "+t;i=_h,o=!0}n+=1e5}return n}(n.charAt(1),h);u<Ph(a);)u+=2e6;var c=i-r;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var p,d,f,g=c/2,_=0,m=0;return g>0&&(p=1e5/Math.pow(10,g),d=t.substring(r,r+g),_=parseFloat(d)*p,f=t.substring(r+g),m=parseFloat(f)*p),{easting:_+l,northing:m+u,zoneLetter:a,zoneNumber:s,accuracy:p}}function Ph(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Eh(t,e,i){if(!(this instanceof Eh))return new Eh(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Eh.fromMGRS=function(t){return new Eh(wh(t))},Eh.prototype.toMGRS=function(t){return xh([this.x,this.y],t)};const Ah=Eh;var Lh=.046875,Rh=.01953125,Oh=.01068115234375;function Zh(t){var e=[];e[0]=1-t*(.25+t*(Lh+t*(Rh+t*Oh))),e[1]=t*(.75-t*(Lh+t*(Rh+t*Oh)));var i=t*t;return e[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),e[3]=(i*=t)*(.3645833333333333-.005696614583333333*t),e[4]=i*t*.3076171875,e}function Ih(t,e,i,n){return n[0]*t-(i*=e)*(n[1]+(e*=e)*(n[2]+e*(n[3]+e*n[4])))}function kh(t,e,i){for(var n=1/(1-e),o=t,r=20;r;--r){var s=Math.sin(o),a=1-e*s*s;if(o-=a=(Ih(o,s,Math.cos(o),i)-t)*(a*Math.sqrt(a))*n,Math.abs(a)<ra)return o}return o}const Nh={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Zh(this.es),this.ml0=Ih(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,n,o=t.y,r=Za(t.x-this.long0),s=Math.sin(o),a=Math.cos(o);if(this.es){var h=a*r,l=Math.pow(h,2),u=this.ep2*Math.pow(a,2),c=Math.pow(u,2),p=Math.abs(a)>ra?Math.tan(o):0,d=Math.pow(p,2),f=Math.pow(d,2);e=1-this.es*Math.pow(s,2),h/=Math.sqrt(e);var g=Ih(o,s,a,this.en);i=this.a*(this.k0*h*(1+l/6*(1-d+u+l/20*(5-18*d+f+14*u-58*d*u+l/42*(61+179*f-f*d-479*d)))))+this.x0,n=this.a*(this.k0*(g-this.ml0+s*r*h/2*(1+l/12*(5-d+9*u+4*c+l/30*(61+f-58*d+270*u-330*d*u+l/56*(1385+543*f-f*d-3111*d))))))+this.y0}else{var _=a*Math.sin(r);if(Math.abs(Math.abs(_)-1)<ra)return 93;if(i=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,n=a*Math.cos(r)/Math.sqrt(1-Math.pow(_,2)),(_=Math.abs(n))>=1){if(_-1>ra)return 93;n=0}else n=Math.acos(n);o<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=i,t.y=n,t},inverse:function(t){var e,i,n,o,r=1/this.a*(t.x-this.x0),s=1/this.a*(t.y-this.y0);if(this.es)if(i=kh(e=this.ml0+s/this.k0,this.es,this.en),Math.abs(i)<oa){var a=Math.sin(i),h=Math.cos(i),l=Math.abs(h)>ra?Math.tan(i):0,u=this.ep2*Math.pow(h,2),c=Math.pow(u,2),p=Math.pow(l,2),d=Math.pow(p,2);e=1-this.es*Math.pow(a,2);var f=r*Math.sqrt(e)/this.k0,g=Math.pow(f,2);n=i-(e*=l)*g/(1-this.es)*.5*(1-g/12*(5+3*p-9*u*p+u-4*c-g/30*(61+90*p-252*u*p+45*d+46*u-g/56*(1385+3633*p+4095*d+1574*d*p)))),o=Za(this.long0+f*(1-g/6*(1+2*p+u-g/20*(5+28*p+24*d+8*u*p+6*u-g/42*(61+662*p+1320*d+720*d*p))))/h)}else n=oa*Oa(s),o=0;else{var _=Math.exp(r/this.k0),m=.5*(_-1/_),y=Math.cos(this.lat0+s/this.k0);e=Math.sqrt((1-Math.pow(y,2))/(1+Math.pow(m,2))),n=Math.asin(e),s<0&&(n=-n),o=0===m&&0===y?0:Za(Math.atan2(m,y)+this.long0)}return t.x=o,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function Fh(t){var e=Math.exp(t);return(e-1/e)/2}function Dh(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function qh(t,e){for(var i,n=2*Math.cos(2*e),o=t.length-1,r=t[o],s=0;--o>=0;)i=n*r-s+t[o],s=r,r=i;return e+i*Math.sin(2*e)}function zh(t,e,i){for(var n,o,r=Math.sin(e),s=Math.cos(e),a=Fh(i),h=function(t){var e=Math.exp(t);return(e+1/e)/2}(i),l=2*s*h,u=-2*r*a,c=t.length-1,p=t[c],d=0,f=0,g=0;--c>=0;)n=f,o=d,p=l*(f=p)-n-u*(d=g)+t[c],g=u*f-o+l*d;return[(l=r*h)*p-(u=s*a)*g,l*g+u*p]}const jh={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Nh.init.apply(this),this.forward=Nh.forward,this.inverse=Nh.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),this.cgb[1]=(i*=e)*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),this.cgb[2]=(i*=e)*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),this.cgb[3]=(i*=e)*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),this.cgb[4]=(i*=e)*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),this.cgb[5]=(i*=e)*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),this.utg[2]=(i*=e)*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),this.utg[3]=(i*=e)*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),this.utg[4]=(i*=e)*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),this.utg[5]=(i*=e)*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var n=qh(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var i,n=2*Math.cos(e),o=t.length-1,r=t[o],s=0;--o>=0;)i=n*r-s+t[o],s=r,r=i;return Math.sin(e)*i}(this.gtu,2*n))},forward:function(t){var e=Za(t.x-this.long0),i=t.y;i=qh(this.cbg,i);var n=Math.sin(i),o=Math.cos(i),r=Math.sin(e),s=Math.cos(e);i=Math.atan2(n,s*o),e=Math.atan2(r*o,Dh(n,o*s)),e=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,i=e-1;return 0===i?t:t*Math.log(e)/i}(e*(1+e/(Dh(1,e)+1))),t<0?-e:e}(Math.tan(e));var a,h,l=zh(this.gtu,2*i,2*e);return i+=l[0],e+=l[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*i+this.Zb)+this.y0):(a=1/0,h=1/0),t.x=a,t.y=h,t},inverse:function(t){var e,i,n=1/this.a*(t.x-this.x0),o=1/this.a*(t.y-this.y0);if(o=(o-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var r=zh(this.utg,2*o,2*n);o+=r[0],n+=r[1],n=Math.atan(Fh(n));var s=Math.sin(o),a=Math.cos(o),h=Math.sin(n),l=Math.cos(n);o=Math.atan2(s*l,Dh(h,l*a)),e=Za((n=Math.atan2(h,l*a))+this.long0),i=qh(this.cgb,o)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},Gh={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Za(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*sa,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,jh.init.apply(this),this.forward=jh.forward,this.inverse=jh.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function Uh(t,e){return Math.pow((1-t)/(1+t),e)}const Bh={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ha)/(Math.pow(Math.tan(.5*this.lat0+ha),this.C)*Uh(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+ha),this.C)*Uh(this.e*Math.sin(i),this.ratexp))-oa,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+ha)/this.K,1/this.C),o=20;o>0&&(i=2*Math.atan(n*Uh(this.e*Math.sin(t.y),-.5*this.e))-oa,!(Math.abs(i-t.y)<1e-14));--o)t.y=i;return o?(t.x=e,t.y=i,t):null},names:["gauss"]},Wh={init:function(){Bh.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,o;return t.x=Za(t.x-this.long0),Bh.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),t.x=(o=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n))*i*Math.sin(t.x),t.y=o*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,o,r;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,r=Math.sqrt(t.x*t.x+t.y*t.y)){var s=2*Math.atan2(r,this.R2);e=Math.sin(s),i=Math.cos(s),o=Math.asin(i*this.sinc0+t.y*e*this.cosc0/r),n=Math.atan2(t.x*e,r*this.cosc0*i-t.y*this.sinc0*e)}else o=this.phic0,n=0;return t.x=n,t.y=o,Bh.inverse.apply(this,[t]),t.x=Za(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Yh={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ra&&(this.k0=.5*(1+Oa(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ra&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ra&&(this.k0=.5*this.cons*Ra(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Ia(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ra(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-oa,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,o,r,s,a=t.x,h=t.y,l=Math.sin(h),u=Math.cos(h),c=Za(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=ra&&Math.abs(h+this.lat0)<=ra?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*l+this.coslat0*u*Math.cos(c)),t.x=this.a*e*u*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*l-this.sinlat0*u*Math.cos(c))+this.y0,t):(i=2*Math.atan(this.ssfn_(h,l,this.e))-oa,o=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=ra?(r=Ia(this.e,h*this.con,this.con*l),t.x=this.x0+(s=2*this.a*this.k0*r/this.cons)*Math.sin(a-this.long0),t.y=this.y0-this.con*s*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<ra?(e=2*this.a*this.k0/(1+o*Math.cos(c)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*o*Math.cos(c))),t.y=e*(this.cosX0*n-this.sinX0*o*Math.cos(c))+this.y0),t.x=e*o*Math.sin(c)+this.x0,t))},inverse:function(t){var e,i,n,o;t.x-=this.x0,t.y-=this.y0;var r=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(r/(2*this.a*this.k0));return e=this.long0,i=this.lat0,r<=ra?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/r),e=Math.abs(this.coslat0)<ra?Za(this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y)):Za(this.long0+Math.atan2(t.x*Math.sin(s),r*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=ra){if(r<=ra)return i=this.lat0,t.x=e=this.long0,t.y=i,t;t.x*=this.con,t.y*=this.con,i=this.con*ka(this.e,r*this.cons/(2*this.a*this.k0)),e=this.con*Za(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else n=2*Math.atan(r*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,r<=ra?o=this.X0:(o=Math.asin(Math.cos(n)*this.sinX0+t.y*Math.sin(n)*this.cosX0/r),e=Za(this.long0+Math.atan2(t.x*Math.sin(n),r*this.cosX0*Math.cos(n)-t.y*this.sinX0*Math.sin(n)))),i=-1*ka(this.e,Math.tan(.5*(oa+o)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(oa+t))*Math.pow((1-e)/(1+e),.5*i)}},Vh={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,o=2*n-Math.pow(n,2),r=this.e=Math.sqrt(o);this.R=this.k0*i*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+r*e)/(1-r*e));this.K=s-this.alpha*a+this.alpha*r/2*h},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=2*(Math.atan(Math.exp(-this.alpha*(e+i)+this.K))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),r=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(n)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(n)-Math.sin(this.b0)*Math.cos(n)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*r+this.x0,t},inverse:function(t){for(var e=(t.x-this.x0)/this.R,i=2*(Math.atan(Math.exp((t.y-this.y0)/this.R))-Math.PI/4),n=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(e)),o=Math.atan(Math.sin(e)/(Math.cos(this.b0)*Math.cos(e)-Math.sin(this.b0)*Math.tan(i))),r=this.lambda0+o/this.alpha,s=0,a=n,h=-1e3,l=0;Math.abs(a-h)>1e-7;){if(++l>20)return;s=1/this.alpha*(Math.log(Math.tan(Math.PI/4+n/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(a))/2)),h=a,a=2*Math.atan(Math.exp(s))-Math.PI/2}return t.x=r,t.y=a,t},names:["somerc"]};var Xh=1e-7;const Hh={init:function(){var t,e,i,n,o,r,s,a,h,l,u,c,p,d=0,f=0,g=0,_=0,m=0,y=0,v=0;this.no_off=(p="object"==typeof(c=this).PROJECTION?Object.keys(c.PROJECTION)[0]:c.PROJECTION,"no_uoff"in c||"no_off"in c||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(p)),this.no_rot="no_rot"in this;var x=!1;"alpha"in this&&(x=!0);var w=!1;if("rectified_grid_angle"in this&&(w=!0),x&&(v=this.alpha),w&&(d=this.rectified_grid_angle*sa),x||w)f=this.longc;else if(g=this.long1,m=this.lat1,_=this.long2,y=this.lat2,Math.abs(m-y)<=Xh||(t=Math.abs(m))<=Xh||Math.abs(t-oa)<=Xh||Math.abs(Math.abs(this.lat0)-oa)<=Xh||Math.abs(Math.abs(y)-oa)<=Xh)throw new Error;var b=1-this.es;e=Math.sqrt(b),Math.abs(this.lat0)>ra?(a=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*a*a,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/b),this.A=this.B*this.k0*e/t,(o=(n=this.B*e/(i*Math.sqrt(t)))*n-1)<=0?o=0:(o=Math.sqrt(o),this.lat0<0&&(o=-o)),this.E=o+=n,this.E*=Math.pow(Ia(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=o=1),x||w?(x?(u=Math.asin(Math.sin(v)/n),w||(d=v)):(u=d,v=Math.asin(n*Math.sin(u))),this.lam0=f-Math.asin(.5*(o-1/o)*Math.tan(u))/this.B):(r=Math.pow(Ia(this.e,m,Math.sin(m)),this.B),s=Math.pow(Ia(this.e,y,Math.sin(y)),this.B),o=this.E/r,h=(s-r)/(s+r),l=((l=this.E*this.E)-s*r)/(l+s*r),(t=g-_)<-Math.pi?_-=la:t>Math.pi&&(_+=la),this.lam0=Za(.5*(g+_)-Math.atan(l*Math.tan(.5*this.B*(g-_))/h)/this.B),u=Math.atan(2*Math.sin(this.B*Za(g-this.lam0))/(o-1/o)),d=v=Math.asin(n*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(v))),this.lat0<0&&(this.u_0=-this.u_0)),o=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(ha-o)),this.v_pole_s=this.ArB*Math.log(Math.tan(ha+o))},forward:function(t){var e,i,n,o,r,s,a,h,l={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-oa)>ra){if(e=.5*((r=this.E/Math.pow(Ia(this.e,t.y,Math.sin(t.y)),this.B))-(s=1/r)),i=.5*(r+s),o=Math.sin(this.B*t.x),n=(e*this.singam-o*this.cosgam)/i,Math.abs(Math.abs(n)-1)<ra)throw new Error;h=.5*this.ArB*Math.log((1-n)/(1+n)),s=Math.cos(this.B*t.x),a=Math.abs(s)<Xh?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+o*this.singam,s)}else h=t.y>0?this.v_pole_n:this.v_pole_s,a=this.ArB*t.y;return this.no_rot?(l.x=a,l.y=h):(l.x=h*this.cosrot+(a-=this.u_0)*this.sinrot,l.y=a*this.cosrot-h*this.sinrot),l.x=this.a*l.x+this.x0,l.y=this.a*l.y+this.y0,l},inverse:function(t){var e,i,n,o,r,s,a,h={};if(t.x=1/this.a*(t.x-this.x0),t.y=1/this.a*(t.y-this.y0),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),o=.5*((n=Math.exp(-this.BrA*i))-1/n),r=.5*(n+1/n),a=((s=Math.sin(this.BrA*e))*this.cosgam+o*this.singam)/r,Math.abs(Math.abs(a)-1)<ra)h.x=0,h.y=a<0?-oa:oa;else{if(h.y=this.E/Math.sqrt((1+a)/(1-a)),h.y=ka(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(o*this.cosgam-s*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},Kh={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ra)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=Ra(this.e,e,i),o=Ia(this.e,this.lat1,e),r=Math.sin(this.lat2),s=Math.cos(this.lat2),a=Ra(this.e,r,s),h=Ia(this.e,this.lat2,r),l=Ia(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>ra?Math.log(n/a)/Math.log(o/h):e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(o,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=ra&&(i=Oa(i)*(oa-2e-10));var n,o,r=Math.abs(Math.abs(i)-oa);if(r>ra)n=Ia(this.e,i,Math.sin(i)),o=this.a*this.f0*Math.pow(n,this.ns);else{if((r=i*this.ns)<=0)return null;o=0}var s=this.ns*Za(e-this.long0);return t.x=this.k0*(o*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-o*Math.cos(s))+this.y0,t},inverse:function(t){var e,i,n,o,r,s=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+a*a),i=1):(e=-Math.sqrt(s*s+a*a),i=-1);var h=0;if(0!==e&&(h=Math.atan2(i*s,i*a)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),-9999===(o=ka(this.e,n)))return null}else o=-oa;return r=Za(h/this.ns+this.long0),t.x=r,t.y=o,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},Jh={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,n,o,r,s,a,h=t.y,l=Za(t.x-this.long0);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),n=-l*this.alfa,o=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),r=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(o)),s=this.n*r,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(o/2+this.s45),this.n),t.y=a*Math.cos(s)/1,t.x=a*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,o,r,s,a,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),r=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/r,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(o)),i=Math.asin(Math.cos(n)*Math.sin(o)/Math.cos(e)),t.x=this.long0-i/this.alfa,s=e,a=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(a=1),s=t.y,l+=1}while(0===a&&l<15);return l>=15?null:t},names:["Krovak","krovak"]};function Qh(t,e,i,n,o){return t*o-e*Math.sin(2*o)+i*Math.sin(4*o)-n*Math.sin(6*o)}function $h(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function tl(t){return.375*t*(1+.25*t*(1+.46875*t))}function el(t){return.05859375*t*t*(1+.75*t)}function il(t){return t*t*t*(35/3072)}function nl(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function ol(t){return Math.abs(t)<oa?t:t-Oa(t)*Math.PI}function rl(t,e,i,n,o){var r,s;r=t/e;for(var a=0;a<15;a++)if(r+=s=(t-(e*r-i*Math.sin(2*r)+n*Math.sin(4*r)-o*Math.sin(6*r)))/(e-2*i*Math.cos(2*r)+4*n*Math.cos(4*r)-6*o*Math.cos(6*r)),Math.abs(s)<=1e-10)return r;return NaN}const sl={init:function(){this.sphere||(this.e0=$h(this.es),this.e1=tl(this.es),this.e2=el(this.es),this.e3=il(this.es),this.ml0=this.a*Qh(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n=t.x,o=t.y;if(n=Za(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(o)*Math.sin(n)),i=this.a*(Math.atan2(Math.tan(o),Math.cos(n))-this.lat0);else{var r=Math.sin(o),s=Math.cos(o),a=nl(this.a,this.e,r),h=Math.tan(o)*Math.tan(o),l=n*Math.cos(o),u=l*l,c=this.es*s*s/(1-this.es);e=a*l*(1-u*h*(1/6-(8-h+8*c)*u/120)),i=this.a*Qh(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*r/s*u*(.5+(5-h+6*c)*u/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,o=t.y/this.a;if(this.sphere){var r=o+this.lat0;e=Math.asin(Math.sin(r)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(r))}else{var s=rl(this.ml0/this.a+o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-oa)<=ra)return t.x=this.long0,t.y=oa,o<0&&(t.y*=-1),t;var a=nl(this.a,this.e,Math.sin(s)),h=a*a*a/this.a/this.a*(1-this.es),l=Math.pow(Math.tan(s),2),u=n*this.a/a,c=u*u;e=s-a*Math.tan(s)/h*u*u*(.5-(1+3*l)*u*u/24),i=u*(1-c*(l/3+(1+3*l)*l*c/15))/Math.cos(s)}return t.x=Za(i+this.long0),t.y=ol(e),t},names:["Cassini","Cassini_Soldner","cass"]};function al(t,e){var i;return t>1e-7?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}const hl={init:function(){var t,e=Math.abs(this.lat0);if(this.mode=Math.abs(e-oa)<ra?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<ra?this.EQUIT:this.OBLIQ,this.es>0)switch(this.qp=al(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,i=[];return i[0]=.3333333333333333*t,i[0]+=.17222222222222222*(e=t*t),i[1]=.06388888888888888*e,i[0]+=.10257936507936508*(e*=t),i[1]+=.0664021164021164*e,i[2]=.016415012942191543*e,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=al(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,o,r,s,a,h,l,u,c=t.x,p=t.y;if(c=Za(c-this.long0),this.sphere){if(r=Math.sin(p),u=Math.cos(p),n=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+u*n:1+this.sinph0*r+this.cosph0*u*n)<=ra)return null;e=(i=Math.sqrt(2/i))*u*Math.sin(c),i*=this.mode===this.EQUIT?r:this.cosph0*r-this.sinph0*u*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(p+this.lat0)<ra)return null;i=ha-.5*p,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(c),i*=n}}else{switch(a=0,h=0,l=0,n=Math.cos(c),o=Math.sin(c),r=Math.sin(p),s=al(this.e,r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,h=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:l=1+this.sinb1*a+this.cosb1*h*n;break;case this.EQUIT:l=1+h*n;break;case this.N_POLE:l=oa+p,s=this.qp-s;break;case this.S_POLE:l=p-oa,s=this.qp+s}if(Math.abs(l)<ra)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),i=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*a-this.sinb1*h*n):(l=Math.sqrt(2/(1+h*n)))*a*this.ymf,e=this.xmf*l*h*o;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(l=Math.sqrt(s))*o,i=n*(this.mode===this.S_POLE?l:-l)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,o,r,s,a,h,l,u,c=t.x/this.a,p=t.y/this.a;if(this.sphere){var d,f=0,g=0;if((i=.5*(d=Math.sqrt(c*c+p*p)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(g=Math.sin(i),f=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(d)<=ra?0:Math.asin(p*g/d),c*=g,p=f*d;break;case this.OBLIQ:i=Math.abs(d)<=ra?this.lat0:Math.asin(f*this.sinph0+p*g*this.cosph0/d),c*=g*this.cosph0,p=(f-Math.sin(i)*this.sinph0)*d;break;case this.N_POLE:p=-p,i=oa-i;break;case this.S_POLE:i-=oa}e=0!==p||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,p):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,p*=this.dd,(s=Math.sqrt(c*c+p*p))<ra)return t.x=this.long0,t.y=this.lat0,t;o=2*Math.asin(.5*s/this.rq),n=Math.cos(o),c*=o=Math.sin(o),this.mode===this.OBLIQ?(r=this.qp*(a=n*this.sinb1+p*o*this.cosb1/s),p=s*this.cosb1*n-p*this.sinb1*o):(r=this.qp*(a=p*o/s),p=s*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(p=-p),!(r=c*c+p*p))return t.x=this.long0,t.y=this.lat0,t;a=1-r/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(c,p),u=(h=Math.asin(a))+h,i=h+(l=this.apa)[0]*Math.sin(u)+l[1]*Math.sin(u+u)+l[2]*Math.sin(u+u+u)}return t.x=Za(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function ll(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}const ul={init:function(){Math.abs(this.lat1+this.lat2)<ra||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ra(this.e3,this.sin_po,this.cos_po),this.qs1=al(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ra(this.e3,this.sin_po,this.cos_po),this.qs2=al(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=al(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>ra?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=al(this.e3,this.sin_phi),o=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,r=this.ns0*Za(e-this.long0),s=o*Math.sin(r)+this.x0,a=this.rh-o*Math.cos(r)+this.y0;return t.x=s,t.y=a,t},inverse:function(t){var e,i,n,o,r;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),n=0,0!==e&&(n=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,r=this.sphere?Math.asin((this.c-i*i)/(2*this.ns0)):this.phi1z(this.e3,(this.c-i*i)/this.ns0),o=Za(n/this.ns0+this.long0),t.x=o,t.y=r,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,o,r,s=ll(.5*e);if(t<ra)return s;for(var a=t*t,h=1;h<=25;h++)if(s+=r=.5*(o=1-(n=t*(i=Math.sin(s)))*n)*o/Math.cos(s)*(e/(1-a)-i/o+.5/t*Math.log((1-n)/(1+n))),Math.abs(r)<=1e-7)return s;return null}},cl={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n,o,r,s,a,h=t.y;return n=Za(t.x-this.long0),e=Math.sin(h),i=Math.cos(h),o=Math.cos(n),(r=this.sin_p14*e+this.cos_p14*i*o)>0||Math.abs(r)<=ra?(s=this.x0+1*this.a*i*Math.sin(n)/r,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*o)/r):(s=this.x0+this.infinity_dist*i*Math.sin(n),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*o)),t.x=s,t.y=a,t},inverse:function(t){var e,i,n,o,r,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(o=Math.atan2(e,this.rc),i=Math.sin(o),s=ll((n=Math.cos(o))*this.sin_p14+t.y*i*this.cos_p14/e),r=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),r=Za(this.long0+r)):(s=this.phic0,r=0),t.x=r,t.y=s,t},names:["gnom"]},pl={init:function(){this.sphere||(this.k0=Ra(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n=t.y,o=Za(t.x-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var r=al(this.e,Math.sin(n));e=this.x0+this.a*this.k0*o,i=this.y0+this.a*r*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Za(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*oa:oa;for(var n,o,r,s,a=Math.asin(.5*e),h=0;h<30;h++)if(o=Math.sin(a),r=Math.cos(a),s=t*o,a+=n=Math.pow(1-s*s,2)/(2*r)*(e/(1-t*t)-o/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),Math.abs(n)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=Za(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]},dl={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.y,i=Za(t.x-this.long0),n=ol(e-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*n,t},inverse:function(t){var e=t.y;return t.x=Za(this.long0+(t.x-this.x0)/(this.a*this.rc)),t.y=ol(this.lat0+(e-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},fl={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=$h(this.es),this.e1=tl(this.es),this.e2=el(this.es),this.e3=il(this.es),this.ml0=this.a*Qh(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,o=t.y,r=Za(t.x-this.long0);if(n=r*Math.sin(o),this.sphere)Math.abs(o)<=ra?(e=this.a*r,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(o),i=this.a*(ol(o-this.lat0)+(1-Math.cos(n))/Math.tan(o)));else if(Math.abs(o)<=ra)e=this.a*r,i=-1*this.ml0;else{var s=nl(this.a,this.e,Math.sin(o))/Math.tan(o);e=s*Math.sin(n),i=this.a*Qh(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+s*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,n,o,r,s,a,h,l;if(n=t.x-this.x0,o=t.y-this.y0,this.sphere)if(Math.abs(o+this.a*this.lat0)<=ra)e=Za(n/this.a+this.long0),i=0;else{var u;for(a=n*n/this.a/this.a+(s=this.lat0+o/this.a)*s,h=s,r=20;r;--r)if(h+=l=-1*(s*(h*(u=Math.tan(h))+1)-h-.5*(h*h+a)*u)/((h-s)/u-1),Math.abs(l)<=ra){i=h;break}e=Za(this.long0+Math.asin(n*Math.tan(h)/this.a)/Math.sin(i))}else if(Math.abs(o+this.ml0)<=ra)i=0,e=Za(this.long0+n/this.a);else{var c,p,d,f,g;for(a=n*n/this.a/this.a+(s=(this.ml0+o)/this.a)*s,h=s,r=20;r;--r)if(g=this.e*Math.sin(h),c=Math.sqrt(1-g*g)*Math.tan(h),p=this.a*Qh(this.e0,this.e1,this.e2,this.e3,h),d=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=l=(s*(c*(f=p/this.a)+1)-f-.5*c*(f*f+a))/(this.es*Math.sin(2*h)*(f*f+a-2*s*f)/(4*c)+(s-f)*(c*d-2/Math.sin(2*h))-d),Math.abs(l)<=ra){i=h;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=Za(this.long0+Math.asin(n*c/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]},gl={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=(t.y-this.lat0)/na*1e-5,n=t.x-this.long0,o=1,r=0;for(e=1;e<=10;e++)r+=this.A[e]*(o*=i);var s,a=r,h=n,l=1,u=0,c=0,p=0;for(e=1;e<=6;e++)s=u*a+l*h,c=c+this.B_re[e]*(l=l*a-u*h)-this.B_im[e]*(u=s),p=p+this.B_im[e]*l+this.B_re[e]*u;return t.x=p*this.a+this.x0,t.y=c*this.a+this.y0,t},inverse:function(t){var e,i,n=(t.y-this.y0)/this.a,o=(t.x-this.x0)/this.a,r=1,s=0,a=0,h=0;for(e=1;e<=6;e++)i=s*n+r*o,a=a+this.C_re[e]*(r=r*n-s*o)-this.C_im[e]*(s=i),h=h+this.C_im[e]*r+this.C_re[e]*s;for(var l=0;l<this.iterations;l++){var u,c=a,p=h,d=n,f=o;for(e=2;e<=6;e++)u=p*a+c*h,d+=(e-1)*(this.B_re[e]*(c=c*a-p*h)-this.B_im[e]*(p=u)),f+=(e-1)*(this.B_im[e]*c+this.B_re[e]*p);c=1,p=0;var g=this.B_re[1],_=this.B_im[1];for(e=2;e<=6;e++)u=p*a+c*h,g+=e*(this.B_re[e]*(c=c*a-p*h)-this.B_im[e]*(p=u)),_+=e*(this.B_im[e]*c+this.B_re[e]*p);var m=g*g+_*_;a=(d*g+f*_)/m,h=(f*g-d*_)/m}var y=a,v=h,x=1,w=0;for(e=1;e<=9;e++)w+=this.D[e]*(x*=y);var b=this.lat0+w*na*1e5;return t.x=this.long0+v,t.y=b,t},names:["New_Zealand_Map_Grid","nzmg"]},_l={init:function(){},forward:function(t){var e=t.y,i=Za(t.x-this.long0),n=this.x0+this.a*i,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return t.x=n,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Za(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},ml={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Zh(this.es)},forward:function(t){var e,i,n=t.x,o=t.y;if(n=Za(n-this.long0),this.sphere){if(this.m)for(var r=this.n*Math.sin(o),s=20;s;--s){var a=(this.m*o+Math.sin(o)-r)/(this.m+Math.cos(o));if(o-=a,Math.abs(a)<ra)break}else o=1!==this.n?Math.asin(this.n*Math.sin(o)):o;e=this.a*this.C_x*n*(this.m+Math.cos(o)),i=this.a*this.C_y*o}else{var h=Math.sin(o),l=Math.cos(o);i=this.a*Ih(o,h,l,this.en),e=this.a*n*l/Math.sqrt(1-this.es*h*h)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=ll((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=ll(Math.sin(e)/this.n)),i=Za(i+this.long0),e=ol(e)):(e=kh(t.y/this.a,this.es,this.en),(n=Math.abs(e))<oa?(n=Math.sin(e),i=Za(this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)))):n-ra<oa&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},yl={init:function(){},forward:function(t){for(var e=t.y,i=Za(t.x-this.long0),n=e,o=Math.PI*Math.sin(e);;){var r=-(n+Math.sin(n)-o)/(1+Math.cos(n));if(n+=r,Math.abs(r)<ra)break}n/=2,Math.PI/2-Math.abs(e)<ra&&(i=0);var s=.900316316158*this.a*i*Math.cos(n)+this.x0,a=1.4142135623731*this.a*Math.sin(n)+this.y0;return t.x=s,t.y=a,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var n=Za(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var o=Math.asin(i);return t.x=n,t.y=o,t},names:["Mollweide","moll"]},vl={init:function(){Math.abs(this.lat1+this.lat2)<ra||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=$h(this.es),this.e1=tl(this.es),this.e2=el(this.es),this.e3=il(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Ra(this.e,this.sinphi,this.cosphi),this.ml1=Qh(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ra?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Ra(this.e,this.sinphi,this.cosphi),this.ml2=Qh(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Qh(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var o=Qh(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-o)}var r=this.ns*Za(i-this.long0),s=this.x0+e*Math.sin(r),a=this.y0+this.rh-e*Math.cos(r);return t.x=s,t.y=a,t},inverse:function(t){var e,i,n,o;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var r=0;return 0!==i&&(r=Math.atan2(e*t.x,e*t.y)),this.sphere?(o=Za(this.long0+r/this.ns),n=ol(this.g-i/this.a),t.x=o,t.y=n,t):(n=rl(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),o=Za(this.long0+r/this.ns),t.x=o,t.y=n,t)},names:["Equidistant_Conic","eqdc"]},xl={init:function(){this.R=this.a},forward:function(t){var e,i,n=t.y,o=Za(t.x-this.long0);Math.abs(n)<=ra&&(e=this.x0+this.R*o,i=this.y0);var r=ll(2*Math.abs(n/Math.PI));(Math.abs(o)<=ra||Math.abs(Math.abs(n)-oa)<=ra)&&(e=this.x0,i=n>=0?this.y0+Math.PI*this.R*Math.tan(.5*r):this.y0+Math.PI*this.R*-Math.tan(.5*r));var s=.5*Math.abs(Math.PI/o-o/Math.PI),a=s*s,h=Math.sin(r),l=Math.cos(r),u=l/(h+l-1),c=u*(2/h-1),p=c*c,d=Math.PI*this.R*(s*(u-p)+Math.sqrt(a*(u-p)*(u-p)-(p+a)*(u*u-p)))/(p+a);o<0&&(d=-d),e=this.x0+d;var f=a+u;return d=Math.PI*this.R*(c*f-s*Math.sqrt((p+a)*(a+1)-f*f))/(p+a),i=n>=0?this.y0+d:this.y0-d,t.x=e,t.y=i,t},inverse:function(t){var e,i,n,o,r,s,a,h,l,u,c,p;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,r=(n=t.x/c)*n+(o=t.y/c)*o,c=3*(o*o/(h=-2*(s=-Math.abs(o)*(1+r))+1+2*o*o+r*r)+(2*(a=s-2*o*o+n*n)*a*a/h/h/h-9*s*a/h/h)/27)/(l=(s-a*a/3/h)/h)/(u=2*Math.sqrt(-l/3)),Math.abs(c)>1&&(c=c>=0?1:-1),p=Math.acos(c)/3,i=t.y>=0?(-u*Math.cos(p+Math.PI/3)-a/3/h)*Math.PI:-(-u*Math.cos(p+Math.PI/3)-a/3/h)*Math.PI,e=Math.abs(n)<ra?this.long0:Za(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(n*n-o*o)+r*r))/2/n),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},wl={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,n,o,r,s,a,h,l,u,c,p,d,f,g,_,m,y,v,x,w,b,C=t.x,M=t.y,S=Math.sin(t.y),T=Math.cos(t.y),P=Za(C-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=ra?(t.x=this.x0+this.a*(oa-M)*Math.sin(P),t.y=this.y0-this.a*(oa-M)*Math.cos(P),t):Math.abs(this.sin_p12+1)<=ra?(t.x=this.x0+this.a*(oa+M)*Math.sin(P),t.y=this.y0+this.a*(oa+M)*Math.cos(P),t):(y=this.sin_p12*S+this.cos_p12*T*Math.cos(P),m=(_=Math.acos(y))?_/Math.sin(_):1,t.x=this.x0+this.a*m*T*Math.sin(P),t.y=this.y0+this.a*m*(this.cos_p12*S-this.sin_p12*T*Math.cos(P)),t):(e=$h(this.es),i=tl(this.es),n=el(this.es),o=il(this.es),Math.abs(this.sin_p12-1)<=ra?(r=this.a*Qh(e,i,n,o,oa),s=this.a*Qh(e,i,n,o,M),t.x=this.x0+(r-s)*Math.sin(P),t.y=this.y0-(r-s)*Math.cos(P),t):Math.abs(this.sin_p12+1)<=ra?(r=this.a*Qh(e,i,n,o,oa),s=this.a*Qh(e,i,n,o,M),t.x=this.x0+(r+s)*Math.sin(P),t.y=this.y0+(r+s)*Math.cos(P),t):(a=S/T,h=nl(this.a,this.e,this.sin_p12),l=nl(this.a,this.e,S),u=Math.atan((1-this.es)*a+this.es*h*this.sin_p12/(l*T)),v=0===(c=Math.atan2(Math.sin(P),this.cos_p12*Math.tan(u)-this.sin_p12*Math.cos(P)))?Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.abs(Math.abs(c)-Math.PI)<=ra?-Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.asin(Math.sin(P)*Math.cos(u)/Math.sin(c)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),d=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es),t.x=this.x0+(_=h*v*(1-(x=v*v)*(g=d*d)*(1-g)/6+(w=x*v)/8*(f=p*d)*(1-2*g)+(b=w*v)/120*(g*(4-7*g)-3*p*p*(1-7*g))-b*v/48*f))*Math.sin(c),t.y=this.y0+_*Math.cos(c),t))},inverse:function(t){var e,i,n,o,r,s,a,h,l,u,c,p,d,f,g,_,m,y,v,x,w,b,C;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*oa*this.a)return;return i=e/this.a,n=Math.sin(i),o=Math.cos(i),r=this.long0,Math.abs(e)<=ra?s=this.lat0:(s=ll(o*this.sin_p12+t.y*n*this.cos_p12/e),a=Math.abs(this.lat0)-oa,r=Math.abs(a)<=ra?Za(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)):Za(this.long0+Math.atan2(t.x*n,e*this.cos_p12*o-t.y*this.sin_p12*n))),t.x=r,t.y=s,t}return h=$h(this.es),l=tl(this.es),u=el(this.es),c=il(this.es),Math.abs(this.sin_p12-1)<=ra?(s=rl(((p=this.a*Qh(h,l,u,c,oa))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,h,l,u,c),r=Za(this.long0+Math.atan2(t.x,-1*t.y)),t.x=r,t.y=s,t):Math.abs(this.sin_p12+1)<=ra?(p=this.a*Qh(h,l,u,c,oa),s=rl(((e=Math.sqrt(t.x*t.x+t.y*t.y))-p)/this.a,h,l,u,c),r=Za(this.long0+Math.atan2(t.x,t.y)),t.x=r,t.y=s,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),d=nl(this.a,this.e,this.sin_p12),_=Math.cos(g),v=3*this.es*(1-(y=-(m=this.e*this.cos_p12*_)*m/(1-this.es)))*this.sin_p12*this.cos_p12*_/(1-this.es),b=1-y*(w=(x=e/d)-y*(1+y)*Math.pow(x,3)/6-v*(1+3*y)*Math.pow(x,4)/24)*w/2-x*w*w*w/6,f=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*_),r=Za(this.long0+Math.asin(Math.sin(g)*Math.sin(w)/Math.cos(f))),C=Math.sin(f),s=Math.atan2((C-this.es*b*this.sin_p12)*Math.tan(f),C*(1-this.es)),t.x=r,t.y=s,t)},names:["Azimuthal_Equidistant","aeqd"]},bl={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,o,r,s,a,h=t.y;return n=Za(t.x-this.long0),e=Math.sin(h),i=Math.cos(h),o=Math.cos(n),((r=this.sin_p14*e+this.cos_p14*i*o)>0||Math.abs(r)<=ra)&&(s=1*this.a*i*Math.sin(n),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*o)),t.x=s,t.y=a,t},inverse:function(t){var e,i,n,o,r,s,a;return t.x-=this.x0,t.y-=this.y0,i=ll((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),n=Math.sin(i),o=Math.cos(i),s=this.long0,Math.abs(e)<=ra?(a=this.lat0,t.x=s,t.y=a,t):(a=ll(o*this.sin_p14+t.y*n*this.cos_p14/e),r=Math.abs(this.lat0)-oa,Math.abs(r)<=ra?(s=Za(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)),t.x=s,t.y=a,t):(s=Za(this.long0+Math.atan2(t.x*n,e*this.cos_p14*o-t.y*this.sin_p14*n)),t.x=s,t.y=a,t))},names:["ortho"]};function Cl(t,e,i,n){var o;return t<ra?(n.value=1,o=0):(o=Math.atan2(e,i),Math.abs(o)<=ha?n.value=1:o>ha&&o<=oa+ha?(n.value=2,o-=oa):o>oa+ha||o<=-(oa+ha)?(n.value=3,o=o>=0?o-ua:o+ua):(n.value=4,o+=oa)),o}function Ml(t,e){var i=t+e;return i<-ua?i+=la:i>+ua&&(i-=la),i}const Sl={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=oa-ha/2?5:this.lat0<=-(oa-ha/2)?6:Math.abs(this.long0)<=ha?1:Math.abs(this.long0)<=oa+ha?this.long0>0?2:4:3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,o,r,s,a={x:0,y:0},h={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,5===this.face)o=oa-e,i>=ha&&i<=oa+ha?(h.value=1,n=i-oa):i>oa+ha||i<=-(oa+ha)?(h.value=2,n=i>0?i-ua:i+ua):i>-(oa+ha)&&i<=-ha?(h.value=3,n=i+oa):(h.value=4,n=i);else if(6===this.face)o=oa+e,i>=ha&&i<=oa+ha?(h.value=1,n=-i+oa):i<ha&&i>=-ha?(h.value=2,n=-i):i<-ha&&i>=-(oa+ha)?(h.value=3,n=-i-oa):(h.value=4,n=i>0?-i+ua:-i-ua);else{var l,u,c,p,d,f;2===this.face?i=Ml(i,+oa):3===this.face?i=Ml(i,+ua):4===this.face&&(i=Ml(i,-oa)),p=Math.sin(e),d=Math.cos(e),f=Math.sin(i),l=d*Math.cos(i),u=d*f,c=p,1===this.face?n=Cl(o=Math.acos(l),c,u,h):2===this.face?n=Cl(o=Math.acos(u),c,-l,h):3===this.face?n=Cl(o=Math.acos(-l),c,-u,h):4===this.face?n=Cl(o=Math.acos(-u),c,l,h):(o=n=0,h.value=1)}return s=Math.atan(12/ua*(n+Math.acos(Math.sin(n)*Math.cos(ha))-oa)),r=Math.sqrt((1-Math.cos(o))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(n))))),2===h.value?s+=oa:3===h.value?s+=ua:4===h.value&&(s+=1.5*ua),a.x=r*Math.cos(s),a.y=r*Math.sin(s),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,i,n,o,r,s,a,h,l,u,c,p,d={lam:0,phi:0},f={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?f.value=1:t.y>=0&&t.y>=Math.abs(t.x)?(f.value=2,e-=oa):t.x<0&&-t.x>=Math.abs(t.y)?(f.value=3,e=e<0?e+ua:e-ua):(f.value=4,e+=oa),l=ua/12*Math.tan(e),r=Math.sin(l)/(Math.cos(l)-1/Math.sqrt(2)),s=Math.atan(r),(a=1-(n=Math.cos(e))*n*(o=Math.tan(i))*o*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?a=-1:a>1&&(a=1),5===this.face)h=Math.acos(a),d.phi=oa-h,d.lam=1===f.value?s+oa:2===f.value?s<0?s+ua:s-ua:3===f.value?s-oa:s;else if(6===this.face)h=Math.acos(a),d.phi=h-oa,d.lam=1===f.value?-s+oa:2===f.value?-s:3===f.value?-s-oa:s<0?-s-ua:-s+ua;else{var g,_,m;l=(g=a)*g,_=(l+=(m=l>=1?0:Math.sqrt(1-l)*Math.sin(s))*m)>=1?0:Math.sqrt(1-l),2===f.value?(l=_,_=-m,m=l):3===f.value?(_=-_,m=-m):4===f.value&&(l=_,_=m,m=-l),2===this.face?(l=g,g=-_,_=l):3===this.face?(g=-g,_=-_):4===this.face&&(l=g,g=_,_=-l),d.phi=Math.acos(-m)-oa,d.lam=Math.atan2(_,g),2===this.face?d.lam=Ml(d.lam,-oa):3===this.face?d.lam=Ml(d.lam,-ua):4===this.face&&(d.lam=Ml(d.lam,+oa))}return 0!==this.es&&(u=d.phi<0?1:0,c=Math.tan(d.phi),p=this.b/Math.sqrt(c*c+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),u&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var Tl=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Pl=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],El=.8487,Al=1.3523,Ll=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};const Rl={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Za(t.x-this.long0),i=Math.abs(t.y),n=Math.floor(11.459155902616464*i);n<0?n=0:n>=18&&(n=17);var o={x:Ll(Tl[n],i=aa*(i-.08726646259971647*n))*e,y:Ll(Pl[n],i)};return t.y<0&&(o.y=-o.y),o.x=o.x*this.a*El+this.x0,o.y=o.y*this.a*Al+this.y0,o},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*El),y:Math.abs(t.y-this.y0)/(this.a*Al)};if(e.y>=1)e.x/=Tl[18][0],e.y=t.y<0?-oa:oa;else{var i=Math.floor(18*e.y);for(i<0?i=0:i>=18&&(i=17);;)if(Pl[i][0]>e.y)--i;else{if(!(Pl[i+1][0]<=e.y))break;++i}var n=Pl[i],o=5*(e.y-n[0])/(Pl[i+1][0]-n[0]);o=function(t,e,i,n){for(var o=e;n;--n){var r=t(o);if(o-=r,Math.abs(r)<1e-10)break}return o}(function(t){return(Ll(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)},o,0,100),e.x/=Ll(Tl[i],o),e.y=(5*i+o)*sa,t.y<0&&(e.y=-e.y)}return e.x=Za(e.x+this.long0),e},names:["Robinson","robin"]},Ol={init:function(){this.name="geocent"},forward:function(t){return th(t,this.es,this.a)},inverse:function(t){return eh(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var Zl={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const Il={init:function(){if(Object.keys(Zl).forEach((function(t){if(void 0===this[t])this[t]=Zl[t].def;else{if(Zl[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Zl[t].num&&(this[t]=parseFloat(this[t]))}Zl[t].degrees&&(this[t]=this[t]*sa)}).bind(this)),Math.abs(Math.abs(this.lat0)-oa)<ra?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<ra?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,n,o,r=Math.sin(t.y),s=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case 3:i=this.sinph0*r+this.cosph0*s*a;break;case 2:i=s*a;break;case 1:i=-r;break;case 0:i=r}switch(e=(i=this.pn1/(this.p-i))*s*Math.sin(t.x),this.mode){case 3:i*=this.cosph0*r-this.sinph0*s*a;break;case 2:i*=r;break;case 0:i*=-s*a;break;case 1:i*=s*a}return e=(e*this.cg-i*this.sg)*this.cw*(o=1/((n=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw)),i=n*o,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,n,o={x:t.x,y:t.y};t.x=(e=this.pn1*t.x*(n=1/(this.pn1-t.y*this.sw)))*this.cg+(i=this.pn1*t.y*this.cw*n)*this.sg,t.y=i*this.cg-e*this.sg;var r=Dh(t.x,t.y);if(Math.abs(r)<ra)o.x=0,o.y=t.y;else{var s,a;switch(a=1-r*r*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/r+r/this.pn1),s=Math.sqrt(1-a*a),this.mode){case 3:o.y=Math.asin(s*this.sinph0+t.y*a*this.cosph0/r),t.y=(s-this.sinph0*Math.sin(o.y))*r,t.x*=a*this.cosph0;break;case 2:o.y=Math.asin(t.y*a/r),t.y=s*r,t.x*=a;break;case 0:o.y=Math.asin(s),t.y=-t.y;break;case 1:o.y=-Math.asin(s)}o.x=Math.atan2(t.x,t.y)}return t.x=o.x+this.long0,t.y=o.y,t},names:["Tilted_Perspective","tpers"]},kl={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,n,o,r=t.x,s=t.y;if(r-=this.long0,"ellipse"===this.shape){s=Math.atan(this.radius_p2*Math.tan(s));var a=this.radius_p/Dh(this.radius_p*Math.cos(s),Math.sin(s));if(i=a*Math.cos(r)*Math.cos(s),n=a*Math.sin(r)*Math.cos(s),o=a*Math.sin(s),(this.radius_g-i)*i-n*n-o*o*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/Dh(o,e)),t.y=this.radius_g_1*Math.atan(o/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(o/Dh(n,e)))}else"sphere"===this.shape&&(e=Math.cos(s),i=Math.cos(r)*e,n=Math.sin(r)*e,o=Math.sin(s),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/Dh(o,e)),t.y=this.radius_g_1*Math.atan(o/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(o/Dh(n,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,n,o,r=-1,s=0,a=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),s=Math.tan(t.x/this.radius_g_1)*Dh(1,a)):(s=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Dh(1,s));var h=a/this.radius_p;if((n=(i=2*this.radius_g*r)*i-4*(e=s*s+h*h+r*r)*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;o=(-i-Math.sqrt(n))/(2*e),r=this.radius_g+o*r,s*=o,a*=o,t.x=Math.atan2(s,r),t.y=Math.atan(a*Math.cos(t.x)/r),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),s=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+a*a)):(s=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+s*s)),(n=(i=2*this.radius_g*r)*i-4*(e=s*s+a*a+r*r)*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;o=(-i-Math.sqrt(n))/(2*e),r=this.radius_g+o*r,s*=o,a*=o,t.x=Math.atan2(s,r),t.y=Math.atan(a*Math.cos(t.x)/r)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var Nl;dh.defaultDatum="WGS84",dh.Proj=$a,dh.WGS84=new dh.Proj("WGS84"),dh.Point=Ah,dh.toPoint=ah,dh.defs=Pa,dh.nadgrid=function(t,e){var i=new DataView(e),n=function(t){var e=t.getInt32(8,!1);return 11!==e&&(11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(i),o=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:Xa(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(i,n);o.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var r={header:o,subgrids:function(t,e,i){for(var n=[],o=0;o<e.nSubgrids;o++){var r=Ka(t,176,i),s=Ja(t,176,r,i),a=Math.round(1+(r.upperLongitude-r.lowerLongitude)/r.longitudeInterval),h=Math.round(1+(r.upperLatitude-r.lowerLatitude)/r.latitudeInterval);n.push({ll:[Va(r.lowerLongitude),Va(r.lowerLatitude)],del:[Va(r.longitudeInterval),Va(r.latitudeInterval)],lim:[a,h],count:r.gridNodeCount,cvs:Ha(s)})}return n}(i,o,n)};return Wa[t]=r,r},dh.transform=lh,dh.mgrs=vh,dh.version="__VERSION__",(Nl=dh).Proj.projections.add(Nh),Nl.Proj.projections.add(jh),Nl.Proj.projections.add(Gh),Nl.Proj.projections.add(Wh),Nl.Proj.projections.add(Yh),Nl.Proj.projections.add(Vh),Nl.Proj.projections.add(Hh),Nl.Proj.projections.add(Kh),Nl.Proj.projections.add(Jh),Nl.Proj.projections.add(sl),Nl.Proj.projections.add(hl),Nl.Proj.projections.add(ul),Nl.Proj.projections.add(cl),Nl.Proj.projections.add(pl),Nl.Proj.projections.add(dl),Nl.Proj.projections.add(fl),Nl.Proj.projections.add(gl),Nl.Proj.projections.add(_l),Nl.Proj.projections.add(ml),Nl.Proj.projections.add(yl),Nl.Proj.projections.add(vl),Nl.Proj.projections.add(xl),Nl.Proj.projections.add(wl),Nl.Proj.projections.add(bl),Nl.Proj.projections.add(Sl),Nl.Proj.projections.add(Rl),Nl.Proj.projections.add(Ol),Nl.Proj.projections.add(Il),Nl.Proj.projections.add(kl);const Fl=dh;function Dl(t){var e,i,n,o,r,s,a,h,l=Object.keys(t.defs),u=l.length;for(e=0;e<u;++e){var c=l[e];if(!fi(c)){var p=t.defs(c),d=p.units;d||"longlat"!==p.projName||(d=Ut.DEGREES),di(new Wt({code:c,axisOrientation:p.axis,metersPerUnit:p.to_meter,units:d}))}}for(e=0;e<u;++e){var f=l[e],g=fi(f);for(i=0;i<u;++i){var _=l[i],m=fi(_);if(!ve(f,_))if(t.defs[f]===t.defs[_])_i([g,m]);else{var y=t(f,_);n=g,o=m,r=Ri(g,m,y.forward),s=Ri(m,g,y.inverse),void 0,void 0,ye(a=fi(n),h=fi(o),yi(r)),ye(h,a,yi(s))}}}}const ql="preload",zl="useInterimTilesOnError";var jl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Gl=function(t){function e(e){var i=this,n=e||{},o=_t({},n);return delete o.preload,delete o.useInterimTilesOnError,(i=t.call(this,o)||this).setPreload(void 0!==n.preload?n.preload:0),i.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),i}return jl(e,t),e.prototype.getPreload=function(){return this.get(ql)},e.prototype.setPreload=function(t){this.set(ql,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(zl)},e.prototype.setUseInterimTilesOnError=function(t){this.set(zl,t)},e.prototype.getData=function(e){return t.prototype.getData.call(this,e)},e}(Lo);var Ul=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Bl=function(t){function e(e){var i=t.call(this)||this;return i.ready=!0,i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=e,i.declutterExecutorGroup=null,i}return Ul(e,t),e.prototype.getFeatures=function(t){return kt()},e.prototype.getData=function(t){return null},e.prototype.prepareFrame=function(t){return kt()},e.prototype.renderFrame=function(t,e){return kt()},e.prototype.loadedTileCallback=function(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,e,i){return(function(n,o){var r=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,o,r)}).bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){},e.prototype.getDataAtPixel=function(t,e,i){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){2===t.target.getState()&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return 2!=e&&3!=e&&t.addEventListener(Ct,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()},e.prototype.disposeInternal=function(){delete this.layer_,t.prototype.disposeInternal.call(this)},e}(It);var Wl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Yl=[],Vl=null;const Xl=function(t){function e(e){var i=t.call(this,e)||this;return i.container=null,i.tempTransform=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i.pixelContext_=null,i.frameState=null,i}return Wl(e,t),e.prototype.getImageData=function(t,e,i){var n,o;Vl||((n=document.createElement("canvas")).width=1,n.height=1,Vl=n.getContext("2d")),Vl.clearRect(0,0,1,1);try{Vl.drawImage(t,e,i,1,1,0,0,1,1),o=Vl.getImageData(0,0,1,1).data}catch(r){return Vl=null,null}return o},e.prototype.getBackground=function(t){var e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0},e.prototype.useContainer=function(t,e,i){var n,o,r=this.getLayer().getClassName();if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&pt(lo(t.style.backgroundColor),lo(i)))&&(s=t.firstElementChild)instanceof HTMLCanvasElement&&(o=s.getContext("2d")),o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(n=document.createElement("div")).className=r;var s,a=n.style;a.position="absolute",a.width="100%",a.height="100%",o=jo(),n.appendChild(s=o.canvas),(a=s.style).position="absolute",a.left="0",a.transformOrigin="top left",this.container=n,this.context=o}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)},e.prototype.clipUnrotated=function(t,e,i){var n=Ke(i),o=Je(i),r=Ue(i),s=Ge(i);nn(e.coordinateToPixelTransform,n),nn(e.coordinateToPixelTransform,o),nn(e.coordinateToPixelTransform,r),nn(e.coordinateToPixelTransform,s);var a=this.inversePixelTransform;nn(a,n),nn(a,o),nn(a,r),nn(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var o=new ko(t,this.inversePixelTransform,i,e);n.dispatchEvent(o)}},e.prototype.preRender=function(t,e){this.frameState=e,this.dispatchRenderEvent_("prerender",t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_("postrender",t,e)},e.prototype.getRenderTransform=function(t,e,i,n,o,r,s){var a=n/e;return on(this.tempTransform,o/2,r/2,a,-a,-i,-t[0]+s,-t[1])},e.prototype.getDataAtPixel=function(t,e,i){var n=nn(this.inversePixelTransform,t.slice()),o=this.context,r=this.getLayer().getExtent();if(r&&!Pe(r,nn(e.pixelToCoordinateTransform,t.slice())))return null;var s,a=Math.round(n[0]),h=Math.round(n[1]),l=this.pixelContext_;if(!l){var u=document.createElement("canvas");u.width=1,u.height=1,l=u.getContext("2d"),this.pixelContext_=l}l.clearRect(0,0,1,1);try{l.drawImage(o.canvas,a,h,1,1,0,0,1,1),s=l.getImageData(0,0,1,1).data}catch(c){return"SecurityError"===c.name?(this.pixelContext_=null,new Uint8Array):s}return 0===s[3]?null:s},e.prototype.disposeInternal=function(){delete this.frameState,t.prototype.disposeInternal.call(this)},e}(Bl);var Hl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Kl=function(t){function e(e,i,n){var o=t.call(this)||this,r=n||{};return o.tileCoord=e,o.state=i,o.interimTile=null,o.key="",o.transition_=void 0===r.transition?250:r.transition,o.transitionStarts_={},o.interpolate=!!r.interpolate,o}return Hl(e,t),e.prototype.changed=function(){this.dispatchEvent(Ct)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){kt()},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else this.transitionStarts_[t]=i=e;var n=e-i+1e3/60;return n>=this.transition_?1:qi(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(bt);var Jl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Ql=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.extent=e,r.pixelRatio_=n,r.resolution=i,r.state=o,r}return Jl(e,t),e.prototype.changed=function(){this.dispatchEvent(Ct)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return kt()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){kt()},e}(bt);var $l=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function tu(t,e,i){var n=t,o=!0,r=!1,s=!1,a=[Rt(n,"load",function(){s=!0,r||e()})];return n.src&&tn?(r=!0,n.decode().then(function(){o&&e()}).catch(function(t){o&&(s?e():i())})):a.push(Rt(n,"error",i)),function(){o=!1,a.forEach(Ot)}}!function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,n,0)||this;return a.src_=o,a.image_=new Image,null!==r&&(a.image_.crossOrigin=r),a.unlisten_=null,a.state=0,a.imageLoadFunction_=s,a}$l(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=3,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Xe(this.extent)/this.image_.height),this.state=2,this.unlistenImage_(),this.changed()},e.prototype.load=function(){0!=this.state&&3!=this.state||(this.state=1,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=tu(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=Xe(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}(Ql);var eu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const iu=function(t){function e(e,i,n,o,r,s){var a=t.call(this,e,i,s)||this;return a.crossOrigin_=o,a.src_=n,a.key=n,a.image_=new Image,null!==o&&(a.image_.crossOrigin=o),a.unlisten_=null,a.tileLoadFunction_=r,a}return eu(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){var t;this.state=3,this.unlistenImage_(),this.image_=((t=jo(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;this.state=t.naturalWidth&&t.naturalHeight?2:4,this.unlistenImage_(),this.changed()},e.prototype.load=function(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=tu(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Kl),nu=function(){function t(t,e,i,n,o,r){this.sourceProj_=t,this.targetProj_=e;var s={},a=wi(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=a(t)),s[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Qe(n)==Qe(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Qe(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Qe(this.targetProj_.getExtent()):null;var h=Ke(i),l=Je(i),u=Ue(i),c=Ge(i),p=this.transformInv_(h),d=this.transformInv_(l),f=this.transformInv_(u),g=this.transformInv_(c),_=10+(r?Math.max(0,Math.ceil(Xt(je(i)/(r*r*256*256)))):0);if(this.addQuad_(h,l,u,c,p,d,f,g,_),this.wrapsXInSource_){var m=1/0;this.triangles_.forEach(function(t,e,i){m=Math.min(m,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach((function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-m>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-m>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-m>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-m>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}).bind(this))}s={}}return t.prototype.addTriangle_=function(t,e,i,n,o,r){this.triangles_.push({source:[n,o,r],target:[t,e,i]})},t.prototype.addQuad_=function(t,e,i,n,o,r,s,a,h){var l=Ce([o,r,s,a]),u=this.sourceWorldWidth_?Qe(l)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&u>.5&&u<1,d=!1;if(h>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(d=Qe(Ce([t,e,i,n]))/this.targetWorldWidth_>.25||d),!p&&this.sourceProj_.isGlobal()&&u&&(d=u>.25||d)),!(!d&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3]))||$e(l,this.maxSourceExtent_)){var f=0;if(!(d||isFinite(o[0])&&isFinite(o[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(h>0)d=!0;else if(1!=(f=(isFinite(o[0])&&isFinite(o[1])?0:8)+(isFinite(r[0])&&isFinite(r[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1))&&2!=f&&4!=f&&8!=f)return;if(h>0){if(!d){var g,_=this.transformInv_([(t[0]+i[0])/2,(t[1]+i[1])/2]);g=p?(Qt(o[0],c)+Qt(s[0],c))/2-Qt(_[0],c):(o[0]+s[0])/2-_[0];var m=(o[1]+s[1])/2-_[1];d=g*g+m*m>this.errorThresholdSquared_}if(d){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var y=[(e[0]+i[0])/2,(e[1]+i[1])/2],v=this.transformInv_(y),x=[(n[0]+t[0])/2,(n[1]+t[1])/2],w=this.transformInv_(x);this.addQuad_(t,e,y,x,o,r,v,w,h-1),this.addQuad_(x,y,i,n,w,v,s,a,h-1)}else{var b=[(t[0]+e[0])/2,(t[1]+e[1])/2],C=this.transformInv_(b),M=[(i[0]+n[0])/2,(i[1]+n[1])/2],S=this.transformInv_(M);this.addQuad_(t,b,M,n,o,C,S,a,h-1),this.addQuad_(b,e,i,M,C,r,s,S,h-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&f)&&this.addTriangle_(t,i,n,o,s,a),0==(14&f)&&this.addTriangle_(t,i,e,o,s,r),f&&(0==(13&f)&&this.addTriangle_(e,n,t,r,a,o),0==(7&f)&&this.addTriangle_(e,n,i,r,a,s))}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(e,i,n){var o=e.source;Fe(t,o[0]),Fe(t,o[1]),Fe(t,o[2])}),t},t.prototype.getTriangles=function(){return this.triangles_},t}();var ou,ru={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},su={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0},au=[];function hu(t,e,i,n,o){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,o),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,o)),t.restore()}function lu(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function uu(t,e,i,n){var o=bi(i,e,t),r=gi(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(r*=s);var a=t.getMetersPerUnit();void 0!==a&&(r/=a);var h=t.getExtent();if(!h||Pe(h,o)){var l=gi(t,r,o)/r;isFinite(l)&&l>0&&(r/=l)}return r}var cu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const pu=function(t){function e(e,i,n,o,r,s,a,h,l,u,c,p){var d=t.call(this,r,0,{interpolate:!!p})||this;d.renderEdges_=void 0!==c&&c,d.pixelRatio_=a,d.gutter_=h,d.canvas_=null,d.sourceTileGrid_=i,d.targetTileGrid_=o,d.wrappedTileCoord_=s||r,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var f=o.getTileCoordExtent(d.wrappedTileCoord_),g=d.targetTileGrid_.getExtent(),_=d.sourceTileGrid_.getExtent(),m=g?He(f,g):f;if(0===je(m))return d.state=4,d;var y=e.getExtent();y&&(_=_?He(_,y):y);var v=o.getResolution(d.wrappedTileCoord_[0]),x=function(t,e,i,n){var o=Be(i),r=uu(t,e,o,n);return(!isFinite(r)||r<=0)&&ze(i,function(i){return r=uu(t,e,i,n),isFinite(r)&&r>0}),r}(e,n,m,v);if(!isFinite(x)||x<=0)return d.state=4,d;if(d.triangulation_=new nu(e,n,m,_,x*(void 0!==u?u:.5),v),0===d.triangulation_.getTriangles().length)return d.state=4,d;d.sourceZ_=i.getZForResolution(x);var w=d.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(w[1]=Yt(w[1],_[1],_[3]),w[3]=Yt(w[3],_[1],_[3])):w=He(w,_)),je(w)){for(var b=i.getTileRangeForExtentAndZ(w,d.sourceZ_),C=b.minX;C<=b.maxX;C++)for(var M=b.minY;M<=b.maxY;M++){var S=l(d.sourceZ_,C,M,a);S&&d.sourceTiles_.push(S)}0===d.sourceTiles_.length&&(d.state=4)}else d.state=4;return d}return cu(e,t),e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach((function(e,i,n){e&&2==e.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}).bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=3;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],o="number"==typeof i?i:i[1],r=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,i,n,o,r,s,a,h,l,u,c){var p=jo(Math.round(i*t),Math.round(i*e),au);if(c||_t(p,ru),0===h.length)return p.canvas;function d(t){return Math.round(t*i)/i}p.scale(i,i),p.globalCompositeOperation="lighter";var f=[1/0,1/0,-1/0,-1/0];h.forEach(function(t,e,i){Ne(f,t.extent)});var g=Qe(f),_=Xe(f),m=jo(Math.round(i*g/n),Math.round(i*_/n));c||_t(m,ru);var y=i/n;h.forEach(function(t,e,i){var n=t.extent[0]-f[0],o=-(t.extent[3]-f[3]),r=Qe(t.extent),s=Xe(t.extent);t.image.width>0&&t.image.height>0&&m.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,n*y,o*y,r*y,s*y)});var v=Ke(s);return a.getTriangles().forEach(function(t,e,o){var s=t.source,a=t.target,h=s[0][0],l=s[0][1],u=s[1][0],g=s[1][1],_=s[2][0],y=s[2][1],x=d((a[0][0]-v[0])/r),w=d(-(a[0][1]-v[1])/r),b=d((a[1][0]-v[0])/r),C=d(-(a[1][1]-v[1])/r),M=d((a[2][0]-v[0])/r),S=d(-(a[2][1]-v[1])/r),T=h,P=l;h=0,l=0;var E=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,o=Math.abs(t[i][i]),r=i+1;r<e;r++){var s=Math.abs(t[r][i]);s>o&&(o=s,n=r)}if(0===o)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var h=i+1;h<e;h++)for(var l=-t[h][i]/t[i][i],u=i;u<e+1;u++)i==u?t[h][u]=0:t[h][u]+=l*t[i][u]}for(var c=new Array(e),p=e-1;p>=0;p--){c[p]=t[p][e]/t[p][p];for(var d=p-1;d>=0;d--)t[d][e]-=t[d][p]*c[p]}return c}([[u-=T,g-=P,0,0,b-x],[_-=T,y-=P,0,0,M-x],[0,0,u,g,C-w],[0,0,_,y,S-w]]);if(E){if(p.save(),p.beginPath(),function(){if(void 0===ou){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",hu(t,4,5,4,0),hu(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;ou=lu(e,0)||lu(e,4)||lu(e,8)}return ou}()||!c){p.moveTo(b,C);for(var A=x-b,L=w-C,R=0;R<4;R++)p.lineTo(b+d((R+1)*A/4),C+d(R*L/3)),3!=R&&p.lineTo(b+d((R+1)*A/4),C+d((R+1)*L/3));p.lineTo(M,S)}else p.moveTo(b,C),p.lineTo(x,w),p.lineTo(M,S);p.clip(),p.transform(E[0],E[2],E[1],E[3],x,w),p.translate(f[0]-T,f[3]-P),p.scale(n/i,-n/i),p.drawImage(m.canvas,0,0),p.restore()}}),u&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach(function(t,e,i){var n=t.target,o=(n[0][0]-v[0])/r,s=-(n[0][1]-v[1])/r,a=(n[1][0]-v[0])/r,h=-(n[1][1]-v[1])/r,l=(n[2][0]-v[0])/r,u=-(n[2][1]-v[1])/r;p.beginPath(),p.moveTo(a,h),p.lineTo(o,s),p.lineTo(l,u),p.closePath(),p.stroke()}),p.restore()),p.canvas}(n,o,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),r,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()},e.prototype.load=function(){if(0==this.state){this.state=1,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((function(e,i,n){var o=e.getState();if(0==o||1==o){t++;var r=Lt(e,Ct,function(i){var n=e.getState();2!=n&&3!=n&&4!=n||(Ot(r),0==--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}}).bind(this)),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t,e,i){0==t.getState()&&t.load()})}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Ot),this.sourcesListenerKeys_=null},e.prototype.release=function(){this.canvas_&&(Go(this.canvas_.getContext("2d")),au.push(this.canvas_),this.canvas_=null),t.prototype.release.call(this)},e}(Kl);var du=function(){function t(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function fu(t,e,i,n,o){return void 0!==o?(o.minX=t,o.maxX=e,o.minY=i,o.maxY=n,o):new du(t,e,i,n)}const gu=du;var _u=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const mu=function(t){function e(e){var i=t.call(this,e)||this;return i.extentChanged=!0,i.renderedExtent_=null,i.renderedProjection=null,i.renderedTiles=[],i.newTiles_=!1,i.tmpExtent=[1/0,1/0,-1/0,-1/0],i.tmpTileRange_=new gu(0,0,0,0),i}return _u(e,t),e.prototype.isDrawableTile=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return 2==i||4==i||3==i&&!n},e.prototype.getTile=function(t,e,i,n){var o=n.pixelRatio,r=n.viewState.projection,s=this.getLayer(),a=s.getSource().getTile(t,e,i,o,r);return 3==a.getState()&&(s.getUseInterimTilesOnError()?s.getPreload()>0&&(this.newTiles_=!0):a.setState(2)),this.isDrawableTile(a)||(a=a.getInterimTile()),a},e.prototype.getData=function(t){var e=this.frameState;if(!e)return null;var i=this.getLayer(),n=nn(e.pixelToCoordinateTransform,t.slice()),o=i.getExtent();if(o&&!Pe(o,n))return null;for(var r=e.pixelRatio,s=e.viewState.projection,a=e.viewState,h=i.getRenderSource(),l=h.getTileGridForProjection(a.projection),u=h.getTilePixelRatio(e.pixelRatio),c=l.getZForResolution(a.resolution);c>=l.getMinZoom();--c){var p=l.getTileCoordForCoordAndZ(n,c),d=h.getTile(c,p[1],p[2],r,s);if(!(d instanceof iu||d instanceof pu))return null;if(2===d.getState()){var f=l.getOrigin(c),g=Br(l.getTileSize(c)),_=l.getResolution(c),m=Math.floor(u*((n[0]-f[0])/_-p[1]*g[0])),y=Math.floor(u*((f[1]-n[1])/_-p[2]*g[1])),v=Math.round(u*h.getGutterForProjection(a.projection));return this.getImageData(d.getImage(),m+v,y+v)}}return null},e.prototype.loadedTileCallback=function(e,i,n){return!!this.isDrawableTile(n)&&t.prototype.loadedTileCallback.call(this,e,i,n)},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,e){var i=t.layerStatesArray[t.layerIndex],n=t.viewState,o=n.projection,r=n.resolution,s=n.center,a=n.rotation,h=t.pixelRatio,l=this.getLayer(),u=l.getSource(),c=u.getRevision(),p=u.getTileGridForProjection(o),d=p.getZForResolution(r,u.zDirection),f=p.getResolution(d),g=t.extent,_=t.viewState.resolution,m=u.getTilePixelRatio(h),y=Math.round(Qe(g)/_*h),v=Math.round(Xe(g)/_*h),x=i.extent&&Li(i.extent);x&&(g=He(g,Li(i.extent)));var w=f*y/2/m,b=f*v/2/m,C=[s[0]-w,s[1]-b,s[0]+w,s[1]+b],M=p.getTileRangeForExtentAndZ(g,d),S={};S[d]={};var T=this.createLoadedTileFinder(u,o,S),P=this.tmpExtent,E=this.tmpTileRange_;this.newTiles_=!1;for(var A=a?Ve(n.center,_,a,t.size):void 0,L=M.minX;L<=M.maxX;++L)for(var R=M.minY;R<=M.maxY;++R)if(!a||p.tileCoordIntersectsViewport([d,L,R],A)){var O=this.getTile(d,L,R,t);if(this.isDrawableTile(O)){var Z=Ft(this);if(2==O.getState()&&(S[d][O.tileCoord.toString()]=O,(it=O.inTransition(Z))&&1!==i.opacity&&(O.endTransition(Z),it=!1),this.newTiles_||!it&&-1!==this.renderedTiles.indexOf(O)||(this.newTiles_=!0)),1===O.getAlpha(Z,t.time))continue}var I=p.getTileCoordChildTileRange(O.tileCoord,E,P),k=!1;I&&(k=T(d+1,I)),k||p.forEachTileCoordParentTileRange(O.tileCoord,T,E,P)}var N=f/r*h/m;on(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,a,-y/2,-v/2);var F=sn(this.pixelTransform);this.useContainer(e,F,this.getBackground(t));var D=this.context,q=D.canvas;rn(this.inversePixelTransform,this.pixelTransform),on(this.tempTransform,y/2,v/2,N,N,0,-y/2,-v/2),q.width!=y||q.height!=v?(q.width=y,q.height=v):this.containerReused||D.clearRect(0,0,y,v),x&&this.clipUnrotated(D,t,x),u.getInterpolate()||_t(D,ru),this.preRender(D,t),this.renderedTiles.length=0;var z,j,G,U=Object.keys(S).map(Number);U.sort(ht),1!==i.opacity||this.containerReused&&!u.getOpaque(t.viewState.projection)?(z=[],j=[]):U=U.reverse();for(var B=U.length-1;B>=0;--B){var W=U[B],Y=u.getTilePixelSize(W,h,o),V=p.getResolution(W)/f,X=Y[0]*V*N,H=Y[1]*V*N,K=p.getTileCoordForCoordAndZ(Ke(C),W),J=p.getTileCoordExtent(K),Q=nn(this.tempTransform,[m*(J[0]-C[0])/f,m*(C[3]-J[3])/f]),$=m*u.getGutterForProjection(o),tt=S[W];for(var et in tt){var it,nt=(O=tt[et]).tileCoord,ot=K[1]-nt[1],rt=Math.round(Q[0]-(ot-1)*X),st=K[2]-nt[2],at=Math.round(Q[1]-(st-1)*H),lt=rt-(L=Math.round(Q[0]-ot*X)),ut=at-(R=Math.round(Q[1]-st*H)),ct=d===W,pt=!1;if(!(it=ct&&1!==O.getAlpha(Ft(this),t.time)))if(z){G=[L,R,L+lt,R,L+lt,R+ut,L,R+ut];for(var dt=0,ft=z.length;dt<ft;++dt)if(d!==W&&W<j[dt]){var gt=z[dt];$e([L,R,L+lt,R+ut],[gt[0],gt[3],gt[4],gt[7]])&&(pt||(D.save(),pt=!0),D.beginPath(),D.moveTo(G[0],G[1]),D.lineTo(G[2],G[3]),D.lineTo(G[4],G[5]),D.lineTo(G[6],G[7]),D.moveTo(gt[6],gt[7]),D.lineTo(gt[4],gt[5]),D.lineTo(gt[2],gt[3]),D.lineTo(gt[0],gt[1]),D.clip())}z.push(G),j.push(W)}else D.clearRect(L,R,lt,ut);this.drawTileImage(O,t,L,R,lt,ut,$,ct),z&&!it?(pt&&D.restore(),this.renderedTiles.unshift(O)):this.renderedTiles.push(O),this.updateUsedTiles(t.usedTiles,u,O)}}return this.renderedRevision=c,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!ke(this.renderedExtent_,C),this.renderedExtent_=C,this.renderedPixelRatio=h,this.renderedProjection=o,this.manageTilePyramid(t,u,p,h,o,g,d,l.getPreload()),this.scheduleExpireCache(t,u),this.postRender(D,t),i.extent&&D.restore(),_t(D,su),F!==q.style.transform&&(q.style.transform=F),this.container},e.prototype.drawTileImage=function(t,e,i,n,o,r,s,a){var h=this.getTileImage(t);if(h){var l=Ft(this),u=e.layerStatesArray[e.layerIndex],c=u.opacity*(a?t.getAlpha(l,e.time):1),p=c!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(h,s,s,h.width-2*s,h.height-2*s,i,n,o,r),p&&this.context.restore(),c!==u.opacity?e.animate=!0:a&&t.endTransition(l)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=(function(t,e,i){var n=Ft(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}).bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i){var n=Ft(e);n in t||(t[n]={}),t[n][i.getKey()]=!0},e.prototype.manageTilePyramid=function(t,e,i,n,o,r,s,a,h){var l=Ft(e);l in t.wantedTiles||(t.wantedTiles[l]={});var u,c,p,d,f,g,_=t.wantedTiles[l],m=t.tileQueue,y=i.getMinZoom(),v=t.viewState.rotation,x=v?Ve(t.viewState.center,t.viewState.resolution,v,t.size):void 0,w=0;for(g=y;g<=s;++g)for(c=i.getTileRangeForExtentAndZ(r,g,c),p=i.getResolution(g),d=c.minX;d<=c.maxX;++d)for(f=c.minY;f<=c.maxY;++f)v&&!i.tileCoordIntersectsViewport([g,d,f],x)||(s-g<=a?(++w,0==(u=e.getTile(g,d,f,n,o)).getState()&&(_[u.getKey()]=!0,m.isKeyQueued(u.getKey())||m.enqueue([u,l,i.getTileCoordCenter(u.tileCoord),p])),void 0!==h&&h(u)):e.useTile(g,d,f,o));e.updateCacheSize(w,o)},e}(Xl);var yu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const vu=function(t){function e(e){return t.call(this,e)||this}return yu(e,t),e.prototype.createRenderer=function(){return new mu(this)},e}(Gl),xu=function(){function t(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},t.prototype.expireCache=function(t){for(;this.canExpireCache();)this.pop()},t.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},t.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},t.prototype.get=function(t,e){var i=this.entries_[t];return be(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_},t.prototype.remove=function(t){var e=this.entries_[t];return be(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},t.prototype.getCount=function(){return this.count_},t.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},t.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},t.prototype.peekLast=function(){return this.oldest_.value_},t.prototype.peekLastKey=function(){return this.oldest_.key_},t.prototype.peekFirstKey=function(){return this.newest_.key_},t.prototype.peek=function(t){if(this.containsKey(t))return this.entries_[t].value_},t.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},t.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},t.prototype.set=function(t,e){be(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},t.prototype.setSize=function(t){this.highWaterMark=t},t}();function wu(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function bu(t,e,i){return t+"/"+e+"/"+i}function Cu(t){return bu(t[0],t[1],t[2])}function Mu(t){return(t[1]<<t[0])+t[2]}var Su=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Tu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Su(e,t),e.prototype.expireCache=function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=(e=this.peekFirstKey(),e.split("/").map(Number))[0];this.forEach((function(e){e.tileCoord[0]!==t&&(this.remove(Cu(e.tileCoord)),e.release())}).bind(this))}var e},e}(xu);var Pu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Eu(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const Au=function(t){function e(e){var i=t.call(this)||this;i.projection=fi(e.projection),i.attributions_=Eu(e.attributions),i.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,i.loading=!1,i.state_=void 0!==e.state?e.state:"ready",i.wrapX_=void 0!==e.wrapX&&e.wrapX,i.interpolate_=!!e.interpolate,i.viewResolver=null,i.viewRejector=null;var n=i;return i.viewPromise_=new Promise(function(t,e){n.viewResolver=t,n.viewRejector=e}),i}return Pu(e,t),e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return kt()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getInterpolate=function(){return this.interpolate_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=Eu(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(zt);var Lu=[0,0,0];const Ru=function(){function t(t){var e,i,n;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,be((i=function(t,e){return e-t}||ht,(e=this.resolutions_).every(function(t,n){if(0===n)return!0;var o=i(e[n-1],t);return!(o>0||0===o)})),17),!t.origins)for(var o=0,r=this.resolutions_.length-1;o<r;++o)if(n){if(this.resolutions_[o]/this.resolutions_[o+1]!==n){n=void 0;break}}else n=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,be(this.origins_.length==this.resolutions_.length,20));var s=t.extent;void 0===s||this.origin_||this.origins_||(this.origin_=Ke(s)),be(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,be(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,be(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==s?s:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){var i=new gu(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(s){var n=this.getTileRangeForExtentAndZ(s,e);i.minX=Math.max(n.minX,i.minX),i.maxX=Math.min(n.maxX,i.maxX),i.minY=Math.max(n.minY,i.minY),i.maxY=Math.min(n.maxY,i.maxY)}return i},this):s&&this.calculateTileRanges_(s)}return t.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),o=n.minX,r=n.maxX;o<=r;++o)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,o,s])},t.prototype.forEachTileCoordParentTileRange=function(t,e,i,n){var o,r,s=null,a=t[0]-1;for(2===this.zoomFactor_?(o=t[1],r=t[2]):s=this.getTileCoordExtent(t,n);a>=this.minZoom;){if(e(a,2===this.zoomFactor_?fu(o=Math.floor(o/2),o,r=Math.floor(r/2),r,i):this.getTileRangeForExtentAndZ(s,a,i)))return!0;--a}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],o=2*t[2];return fu(n,n+1,o,o+1,e)}var r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null},t.prototype.getTileRangeForTileCoordAndZ=function(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;var n=t[0],o=t[1],r=t[2];if(e===n)return fu(o,r,o,r,i);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,e-n),a=Math.floor(o*s),h=Math.floor(r*s);return e<n?fu(a,a,h,h,i):fu(a,Math.floor(s*(o+1))-1,h,Math.floor(s*(r+1))-1,i)}var l=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,e,i)},t.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),o=this.getResolution(t),r=Br(this.getTileSize(t),this.tmpSize_);return Re(n[0]+e.minX*r[0]*o,n[1]+e.minY*r[1]*o,n[0]+(e.maxX+1)*r[0]*o,n[1]+(e.maxY+1)*r[1]*o,i)},t.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=Lu;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var o=n[1],r=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),fu(o,n[1],r,n[2],i)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Br(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]},t.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),o=Br(this.getTileSize(t[0]),this.tmpSize_),r=i[0]+t[1]*o[0]*n,s=i[1]-(t[2]+1)*o[1]*n;return Re(r,s,r+o[0]*n,s+o[1]*n,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,o){var r=this.getZForResolution(i),s=i/this.getResolution(r),a=this.getOrigin(r),h=Br(this.getTileSize(r),this.tmpSize_),l=s*(t-a[0])/i/h[0],u=s*(a[1]-e)/i/h[1];return n?(l=ie(l,5)-1,u=ie(u,5)-1):(l=ee(l,5),u=ee(u,5)),wu(r,l,u,o)},t.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,o){var r=this.getOrigin(i),s=this.getResolution(i),a=Br(this.getTileSize(i),this.tmpSize_),h=(t-r[0])/s/a[0],l=(r[1]-e)/s/a[1];return n?(h=ie(h,5)-1,l=ie(l,5)-1):(h=ee(h,5),l=ee(l,5)),wu(i,h,l,o)},t.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null},t.prototype.getZForResolution=function(t,e){return Yt(lt(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},t.prototype.tileCoordIntersectsViewport=function(t,e){return Un(e,0,e.length,2,this.getTileCoordExtent(t))},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i},t}();function Ou(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){var o=Zu(t,void 0,i);return new Ru({extent:t,origin:We(t,"top-left"),resolutions:o,tileSize:i})}(Iu(t),0,void 0)}(t),t.setDefaultTileGrid(e)),e}function Zu(t,e,i,n){for(var o=void 0!==e?e:42,r=Xe(t),s=Qe(t),a=Br(void 0!==i?i:256),h=n>0?n:Math.max(s/a[0],r/a[1]),l=o+1,u=new Array(l),c=0;c<l;++c)u[c]=h/Math.pow(2,c);return u}function Iu(t){var e=(t=fi(t)).getExtent();if(!e){var i=180*Gt[Ut.DEGREES]/t.getMetersPerUnit();e=Re(-i,-i,i,i)}return e}var ku=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Nu=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate})||this;return i.opaque_=void 0!==e.opaque&&e.opaque,i.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,i.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,i.tileGrid&&Br(i.tileGrid.getTileSize(i.tileGrid.getMinZoom()),[256,256]),i.tileCache=new Tu(e.cacheSize||0),i.tmpSize=[0,0],i.key_=e.key||"",i.tileOptions={transition:e.transition,interpolate:e.interpolate},i.zDirection=e.zDirection?e.zDirection:0,i}return ku(e,t),e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var o=this.getTileCacheForProjection(t);if(!o)return!1;for(var r,s,a,h=!0,l=i.minX;l<=i.maxX;++l)for(var u=i.minY;u<=i.maxY;++u)s=bu(e,l,u),a=!1,o.containsKey(s)&&(a=2===(r=o.get(s)).getState())&&(a=!1!==n(r)),a||(h=!1);return h},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},e.prototype.getTile=function(t,e,i,n,o){return kt()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Ou(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return be(null===e||vi(e,t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n=this.getTileGridForProjection(i),o=this.getTilePixelRatio(e),r=Br(n.getTileSize(t),this.tmpSize);return 1==o?r:Ur(r,o,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],o=t.getTileCoordCenter(e),r=Iu(i);if(Pe(r,o))return e;var s=Qe(r),a=Math.ceil((r[0]-o[0])/s);return o[0]+=s*a,t.getTileCoordForCoordAndZ(o,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],o=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var r=e.getFullTileRange(i);return!r||r.containsXY(n,o)}(t,n)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,e){var i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)},e.prototype.useTile=function(t,e,i,n){},e}(Au),Fu=function(t){function e(e,i){var n=t.call(this,e)||this;return n.tile=i,n}return ku(e,t),e}(rt);const Du=Nu;function qu(t,e){var i=/\{z\}/g,n=/\{x\}/g,o=/\{y\}/g,r=/\{-y\}/g;return function(s,a,h){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(o,s[2].toString()).replace(r,function(){var t=e.getFullTileRange(s[0]);return be(t,55),(t.getHeight()-s[2]-1).toString()}):void 0}}var zu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const ju=function(t){function e(i){var n=t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,opaque:i.opaque,projection:i.projection,state:i.state,tileGrid:i.tileGrid,tilePixelRatio:i.tilePixelRatio,wrapX:i.wrapX,transition:i.transition,interpolate:i.interpolate,key:i.key,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this;return n.generateTileUrlFunction_=n.tileUrlFunction===e.prototype.tileUrlFunction,n.tileLoadFunction=i.tileLoadFunction,i.tileUrlFunction&&(n.tileUrlFunction=i.tileUrlFunction),n.urls=null,i.urls?n.setUrls(i.urls):i.url&&n.setUrl(i.url),n.tileLoadingKeys_={},n}return zu(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=Ft(i),o=i.getState();1==o?(this.tileLoadingKeys_[n]=!0,e="tileloadstart"):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=3==o?"tileloaderror":2==o?"tileloadend":void 0),null!=e&&this.dispatchEvent(new Fu(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=function(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n=i[1].charCodeAt(0),o=i[2].charCodeAt(0),r=void 0;for(r=n;r<=o;++r)e.push(t.replace(i[0],String.fromCharCode(r)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=qu(t[o],e);return function(t){return 1===t.length?t[0]:function(e,i,n){if(e){var o=Qt(Mu(e),t.length);return t[o](e,i,n)}}}(n)}(t,this.tileGrid),e):this.setKey(e)},e.prototype.tileUrlFunction=function(t,e,i){},e.prototype.useTile=function(t,e,i){var n=bu(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(Du);var Gu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Uu(t,e){t.getImage().src=e}const Bu=function(t){function e(e){var i=this,n=void 0===e.imageSmoothing||e.imageSmoothing;return void 0!==e.interpolate&&(n=e.interpolate),(i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Uu,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:n,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this).crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,i.tileClass=void 0!==e.tileClass?e.tileClass:iu,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i}return Gu(e,t),e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var o=this.tileCacheForProjection[n];o.expireCache(o==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!vi(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getKey=function(){var e=t.prototype.getKey.call(this);return this.getInterpolate()||(e+=":disable-interpolation"),e},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!vi(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!vi(e,t)){var i=Ft(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Ou(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||vi(e,t))return this.tileCache;var i=Ft(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Tu(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,n,o,r){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,o),h=a?this.tileUrlFunction(a,n,o):void 0,l=new this.tileClass(s,void 0!==h?0:4,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=r,l.addEventListener(Ct,this.handleTileChange.bind(this)),l},e.prototype.getTile=function(t,e,i,n,o){var r=this.getProjection();if(r&&o&&!vi(r,o)){var s=this.getTileCacheForProjection(o),a=[t,e,i],h=void 0,l=Cu(a);s.containsKey(l)&&(h=s.get(l));var u=this.getKey();if(h&&h.key==u)return h;var c=this.getTileGridForProjection(r),p=this.getTileGridForProjection(o),d=this.getTileCoordForTileUrlFunction(a,o),f=new pu(r,c,o,p,a,d,this.getTilePixelRatio(n),this.getGutter(),(function(t,e,i,n){return this.getTileInternal(t,e,i,n,r)}).bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return f.key=u,h?(f.interimTile=h,f.refreshInterimChain(),s.replace(l,f)):s.set(l,f),f}return this.getTileInternal(t,e,i,n,r||o)},e.prototype.getTileInternal=function(t,e,i,n,o){var r=null,s=bu(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if((r=this.tileCache.get(s)).key!=a){var h=r;(r=this.createTile_(t,e,i,n,o,a)).interimTile=0==h.getState()?h.interimTile:h,r.refreshInterimChain(),this.tileCache.replace(s,r)}}else r=this.createTile_(t,e,i,n,o,a),this.tileCache.set(s,r);return r},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=fi(t);if(i){var n=Ft(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(ju);var Wu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Yu=function(t){function e(e){var i=this,n=e||{},o=void 0===n.imageSmoothing||n.imageSmoothing;void 0!==n.interpolate&&(o=n.interpolate);var r=void 0!==n.projection?n.projection:"EPSG:3857",s=void 0!==n.tileGrid?n.tileGrid:function(t){var e=t||{},i=e.extent||fi("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Zu(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Ru(n)}({extent:Iu(r),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});return(i=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:o,opaque:n.opaque,projection:r,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:s,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this).gutter_=void 0!==n.gutter?n.gutter:0,i}return Wu(e,t),e.prototype.getGutter=function(){return this.gutter_},e}(Bu);var Vu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Xu=function(t){function e(e){var i=e||{},n=void 0===i.imageSmoothing||i.imageSmoothing;return void 0!==i.interpolate&&(n=i.interpolate),t.call(this,{attributions:void 0!==i.attributions?i.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'],attributionsCollapsible:!1,cacheSize:i.cacheSize,crossOrigin:void 0!==i.crossOrigin?i.crossOrigin:"anonymous",interpolate:n,maxZoom:void 0!==i.maxZoom?i.maxZoom:19,opaque:void 0===i.opaque||i.opaque,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileLoadFunction:i.tileLoadFunction,transition:i.transition,url:void 0!==i.url?i.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",wrapX:i.wrapX,zDirection:i.zDirection})||this}return Vu(e,t),e}(Yu);var Hu="1.3.0";function Ku(t,e){var i=[];Object.keys(e).forEach(function(t){null!=e[t]&&i.push(t+"="+encodeURIComponent(e[t]))});var n=i.join("&");return(t=-1===(t=t.replace(/[?&]$/,"")).indexOf("?")?t+"?":t+"&")+n}var Ju=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Qu=function(t){function e(e){var i=this,n=e||{},o=void 0===n.imageSmoothing||n.imageSmoothing;void 0!==n.interpolate&&(o=n.interpolate);var r=n.params||{};return(i=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:o,opaque:!(!("TRANSPARENT"in r)||r.TRANSPARENT),projection:n.projection,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileClass:n.tileClass,tileGrid:n.tileGrid,tileLoadFunction:n.tileLoadFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,zDirection:n.zDirection})||this).gutter_=void 0!==n.gutter?n.gutter:0,i.params_=r,i.v13_=!0,i.serverType_=n.serverType,i.hidpi_=void 0===n.hidpi||n.hidpi,i.tmpExtent_=[1/0,1/0,-1/0,-1/0],i.updateV13_(),i.setKey(i.getKeyForParams_()),i}return Ju(e,t),e.prototype.getFeatureInfoUrl=function(t,e,i,n){var o=fi(i),r=this.getProjection(),s=this.getTileGrid();s||(s=this.getTileGridForProjection(o));var a=s.getZForResolution(e,this.zDirection),h=s.getTileCoordForCoordAndZ(t,a);if(!(s.getResolutions().length<=h[0])){var l=s.getResolution(h[0]),u=s.getTileCoordExtent(h,this.tmpExtent_),c=Br(s.getTileSize(h[0]),this.tmpSize),p=this.gutter_;0!==p&&(c=jr(c,p,this.tmpSize),u=Me(u,l*p,u)),r&&r!==o&&(l=uu(r,o,t,l),u=Ci(u,o,r),t=bi(t,o,r));var d={SERVICE:"WMS",VERSION:Hu,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};_t(d,this.params_,n);var f=Math.floor((t[0]-u[0])/l),g=Math.floor((u[3]-t[1])/l);return d[this.v13_?"I":"X"]=f,d[this.v13_?"J":"Y"]=g,this.getRequestUrl_(h,c,u,1,r||o,d)}},e.prototype.getLegendUrl=function(t,e){if(void 0!==this.urls[0]){var i={SERVICE:"WMS",VERSION:Hu,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){var n=this.params_.LAYERS;if(Array.isArray(n)&&1!==n.length)return;i.LAYER=n}if(void 0!==t){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;i.SCALE=t*o/28e-5}return _t(i,e),Ku(this.urls[0],i)}},e.prototype.getGutter=function(){return this.gutter_},e.prototype.getParams=function(){return this.params_},e.prototype.getRequestUrl_=function(t,e,i,n,o,r){var s=this.urls;if(s){if(r.WIDTH=e[0],r.HEIGHT=e[1],r[this.v13_?"CRS":"SRS"]=o.getCode(),"STYLES"in this.params_||(r.STYLES=""),1!=n)switch(this.serverType_){case"geoserver":var a=90*n+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+a:r.FORMAT_OPTIONS="dpi:"+a;break;case"mapserver":r.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":r.DPI=90*n;break;default:be(!1,52)}var h=o.getAxisOrientation(),l=i;if(this.v13_&&"ne"==h.substr(0,2)){var u=void 0;u=i[0],l[0]=i[1],l[1]=u,u=i[2],l[2]=i[3],l[3]=u}return r.BBOX=l.join(","),Ku(1==s.length?s[0]:s[Qt(Mu(t),s.length)],r)}},e.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},e.prototype.getKeyForParams_=function(){var t=0,e=[];for(var i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")},e.prototype.updateParams=function(t){_t(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},e.prototype.updateV13_=function(){this.v13_=function(t,e){for(var i=(""+t).split("."),n="1.3".split("."),o=0;o<Math.max(i.length,n.length);o++){var r=parseInt(i[o]||"0",10),s=parseInt(n[o]||"0",10);if(r>s)return 1;if(s>r)return-1}return 0}(this.params_.VERSION||Hu)>=0},e.prototype.tileUrlFunction=function(t,e,i){var n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),!(n.getResolutions().length<=t[0])){1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);var o=n.getResolution(t[0]),r=n.getTileCoordExtent(t,this.tmpExtent_),s=Br(n.getTileSize(t[0]),this.tmpSize),a=this.gutter_;0!==a&&(s=jr(s,a,this.tmpSize),r=Me(r,o*a,r)),1!=e&&(s=Ur(s,e,this.tmpSize));var h={SERVICE:"WMS",VERSION:Hu,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return _t(h,this.params_),this.getRequestUrl_(t,s,r,e,i,h)}},e}(Bu);function $u(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"button",5),a.NdJ("click",function(){a.CHM(t);const e=a.oxw();return e.showPanel=!e.showPanel}),a._UZ(1,"i",6),a.qZA()}}function tc(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"tr"),a.TgZ(1,"td"),a.TgZ(2,"input",7),a.NdJ("change",function(e){const i=a.CHM(t).$implicit;return a.oxw().switchLayer(e,i.name)}),a.qZA(),a.qZA(),a.TgZ(3,"td"),a._uU(4),a.qZA(),a.TgZ(5,"td"),a.TgZ(6,"button",8),a.NdJ("click",function(){const e=a.CHM(t).$implicit;return a.oxw().zoomToLayer(e.fullName)}),a._UZ(7,"i",9),a.qZA(),a.qZA(),a.TgZ(8,"td"),a.TgZ(9,"a",10),a._UZ(10,"i",11),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=e.$implicit,i=a.oxw();a.xp6(4),a.Oqu(t.fullName),a.xp6(5),a.Q6J("href",i.getDdownloadShapefileUrl(t.fullName),a.LSH)}}let ec=(()=>{class t{constructor(t){this.httpClient=t,this.map=null,this.capabilites=null,this.layerItems=[],this.showPanel=!1}setMap(t){this.map=t,this.reRenderLayers()}getCapabilities(){this.httpClient.get(`${this.configs.geoserverUrl}/wms?service=wms&version=1.1.1&request=GetCapabilities`,{responseType:"text"}).subscribe(t=>{var e,i;const n=new(d())(t).toJSON();this.capabilites=null===(i=null===(e=null==n?void 0:n.Capability)||void 0===e?void 0:e.Layer)||void 0===i?void 0:i.Layer},t=>{console.error("Request failed with error")},()=>{})}reRenderLayers(){this.layerItems=[];let t=this.map.getLayers().getArray();for(let e=0;e<t.length;e++)"wms"==t[e].get("type")&&this.layerItems.push({name:t[e].get("name"),fullName:t[e].get("full-name")})}switchLayer(t,e){let i=this.map.getLayers().getArray();for(let n=0;n<i.length;n++)i[n].get("name")==e&&(i[n].set("visible",t.target.checked),this.map.updateSize())}zoomToLayer(t){var e;const i=null===(e=this.capabilites)||void 0===e?void 0:e.filter(e=>e.Name===t)[0];if(i){var n=bi(null==i?void 0:i.LatLonBoundingBox,"EPSG:4326","EPSG:900913");this.map.getView().setCenter([n[0],n[1]]),this.map.getView().setZoom(12)}}getDdownloadShapefileUrl(t){let e=t.split(":");return`${this.configs.geoserverUrl}/${e[0]}/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=${t}&outputFormat=SHAPE-ZIP`}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(h.eN))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-ol-map-layers"]],inputs:{configs:"configs"},decls:6,vars:4,consts:[["class","btn btn-primary btn-sm map-layers-btn",3,"click",4,"ngIf"],[1,"map-layers-pnl"],["title","close panel",3,"click"],[1,"fa","fa-arrow-left"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary","btn-sm","map-layers-btn",3,"click"],[1,"fa","fa-bars"],["type","checkbox","checked","",3,"change"],["title","zoom to layer",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fa","fa-eye"],["title","download shapefile","download","",3,"href"],[1,"fa","fa-download"]],template:function(t,e){1&t&&(a.YNc(0,$u,2,0,"button",0),a.TgZ(1,"div",1),a.TgZ(2,"button",2),a.NdJ("click",function(){return e.showPanel=!1}),a._UZ(3,"i",3),a.qZA(),a.TgZ(4,"table"),a.YNc(5,tc,11,2,"tr",4),a.qZA(),a.qZA()),2&t&&(a.Q6J("ngIf",!e.showPanel),a.xp6(1),a.Udp("display",e.showPanel?"block":"none"),a.xp6(4),a.Q6J("ngForOf",e.layerItems))},directives:[n.O5,n.sg],styles:[".map-layers-btn[_ngcontent-%COMP%]{background-color:#7596b4}.map-layers-btn[_ngcontent-%COMP%], .map-layers-pnl[_ngcontent-%COMP%]{position:absolute;z-index:1;top:75px;left:10px}.map-layers-pnl[_ngcontent-%COMP%]{padding:10px;background-color:#fff}"]}),t})();function ic(t,e,i,n,o,r,s){try{var a=t[r](s),h=a.value}catch(l){return void i(l)}a.done?e(h):Promise.resolve(h).then(n,o)}class nc extends ps{constructor(){super({handleDownEvent:t=>{const e=t.map.forEachFeatureAtPixel(t.pixel,function(t){return t});return e&&(this.coordinate_=t.coordinate,this.feature_=e,"new"!=this.feature_.get("action")&&this.feature_.set("action","modify")),!!e},handleDragEvent:t=>{const e=t.coordinate[0]-this.coordinate_[0],i=t.coordinate[1]-this.coordinate_[1];this.feature_.getGeometry().translate(e,i),this.coordinate_[0]=t.coordinate[0],this.coordinate_[1]=t.coordinate[1]},handleMoveEvent:t=>{if(this.cursor_){const e=t.map.forEachFeatureAtPixel(t.pixel,function(t){return t}),i=t.map.getTargetElement();e?i.style.cursor!=this.cursor_&&(this.previousCursor_=i.style.cursor,i.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}},handleUpEvent:()=>(this.coordinate_=null,this.feature_=null,!1)}),this.coordinate_=null,this.cursor_=null,this.previousCursor_=null,this.feature_=null,this.coordinate_=null,this.cursor_="pointer",this.feature_=null,this.previousCursor_=void 0}}var oc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const rc=function(t){function e(e,i,n){var o=t.call(this)||this;return void 0!==n&&void 0===i?o.setFlatCoordinates(n,e):o.setCenterAndRadius(e,i||0,n),o}return oc(e,t),e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,n){var o=this.flatCoordinates,r=t-o[0],s=e-o[1],a=r*r+s*s;if(a<n){if(0===a)for(var h=0;h<this.stride;++h)i[h]=o[h];else{var l=this.getRadius()/Math.sqrt(a);for(i[0]=o[0]+l*r,i[1]=o[1]+l*s,h=2;h<this.stride;++h)i[h]=o[h]}return i.length=this.stride,a}return n},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,n=t-i[0],o=e-i[1];return n*n+o*o<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return Re(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return"Circle"},e.prototype.intersectsExtent=function(t){if($e(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||t[1]<=e[1]&&t[3]>=e[1]||ze(t,this.intersectsCoordinate.bind(this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(var o=1;o<e;++o)n[e+o]=t[o];this.setFlatCoordinates(this.layout,n),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,o=wn(n,0,t);n[o++]=n[0]+e;for(var r=1,s=this.stride;r<s;++r)n[o++]=n[r];n.length=o,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter(hn(i,0,i.length,n,t,e,i)),this.changed()},e.prototype.translate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter(ln(i,0,i.length,n,t,e,i)),this.changed()},e}(gn);var sc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const ac=function(t){function e(e){var i=t.call(this)||this;return i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addChangeListener(i.geometryName_,i.handleGeometryChanged_),e&&("function"==typeof e.getSimplifiedGeometry?i.setGeometry(e):i.setProperties(e)),i}return sc(e,t),e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Ot(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Lt(t,Ct,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){var e,i;this.style_=t,this.styleFunction_=t?"function"==typeof(e=t)?e:(Array.isArray(e)?i=e:(be("function"==typeof e.getZIndex,41),i=[e]),function(){return i}):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(zt);function hc(t,e,i,n,o,r,s){var a,h,l=(i-e)/n;if(1===l)a=e;else if(2===l)a=e,h=o;else if(0!==l){for(var u=t[e],c=t[e+1],p=0,d=[0],f=e+n;f<i;f+=n){var g=t[f],_=t[f+1];p+=Math.sqrt((g-u)*(g-u)+(_-c)*(_-c)),d.push(p),u=g,c=_}var m=o*p,y=function(t,e,i){for(var n,o,r=ht,s=0,a=t.length,h=!1;s<a;)(o=+r(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,h=!o);return h?s:~s}(d,m);y<0?(h=(m-d[-y-2])/(d[-y-1]-d[-y-2]),a=e+(-y-2)*n):a=e+y*n}var v=s>1?s:2,x=r||new Array(v);for(f=0;f<v;++f)x[f]=void 0===a?NaN:void 0===h?t[a+f]:$t(t[a+f],t[a+n+f],h);return x}function lc(t,e,i,n,o,r){if(i==e)return null;var s;if(o<t[e+n-1])return r?((s=t.slice(e,e+n))[n-1]=o,s):null;if(t[i-1]<o)return r?((s=t.slice(i-n,i))[n-1]=o,s):null;if(o==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,h=i/n;a<h;){var l=a+h>>1;o<t[(l+1)*n-1]?h=l:a=l+1}var u=t[a*n-1];if(o==u)return t.slice((a-1)*n,(a-1)*n+n);var c=(o-u)/(t[(a+1)*n-1]-u);s=[];for(var p=0;p<n-1;++p)s.push($t(t[(a-1)*n+p],t[a*n+p],c));return s.push(o),s}function uc(t,e,i,n){for(var o=t[e],r=t[e+1],s=0,a=e+n;a<i;a+=n){var h=t[a],l=t[a+1];s+=Math.sqrt((h-o)*(h-o)+(l-r)*(l-r)),o=h,r=l}return s}var cc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const pc=function(t){function e(e,i){var n=t.call(this)||this;return n.flatMidpoint_=null,n.flatMidpointRevision_=-1,n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return cc(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?ct(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,n){return n<Te(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){return this.layout!=Wi&&this.layout!=Yi?null:lc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,void 0!==e&&e)},e.prototype.getCoordinates=function(){return En(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return hc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)},e.prototype.getLength=function(){return uc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,Ui)},e.prototype.getType=function(){return"LineString"},e.prototype.intersectsExtent=function(t){return Gn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=bn(this.flatCoordinates,0,t,this.stride),this.changed()},e}(gn);var dc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const fc=function(t){function e(e,i,n){var o=t.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(e[0]))o.setCoordinates(e,i);else if(void 0!==i&&n)o.setFlatCoordinates(i,e),o.ends_=n;else{for(var r=o.getLayout(),s=e,a=[],h=[],l=0,u=s.length;l<u;++l){var c=s[l];0===l&&(r=c.getLayout()),ct(a,c.getFlatCoordinates()),h.push(a.length)}o.setFlatCoordinates(r,a),o.ends_=h}return o}return dc(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?ct(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,n){return n<Te(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){return this.layout!=Wi&&this.layout!=Yi||0===this.flatCoordinates.length?null:function(t,e,i,n,o,r,s){if(s)return lc(t,e,i[i.length-1],n,o,r);var a;if(o<t[n-1])return r?((a=t.slice(0,n))[n-1]=o,a):null;if(t[t.length-1]<o)return r?((a=t.slice(t.length-n))[n-1]=o,a):null;for(var h=0,l=i.length;h<l;++h){var u=i[h];if(e!=u){if(o<t[e+n-1])return null;if(o<=t[u-1])return lc(t,e,u,n,o,!1);e=u}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,void 0!==e&&e,void 0!==i&&i)},e.prototype.getCoordinates=function(){return An(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new pc(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],o=0,r=0,s=e.length;r<s;++r){var a=e[r],h=new pc(t.slice(o,a),i);n.push(h),o=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,o=this.stride,r=0,s=n.length;r<s;++r){var a=n[r];ct(t,hc(e,i,a,o,.5)),i=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,o,r,s,a){for(var h=0,l=i.length;h<l;++h){var u=i[h];s=Mn(t,e,u,n,o,r,s),a.push(s),e=u}return s}(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,Ui,n)},e.prototype.getType=function(){return"MultiLineString"},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){if(Gn(t,e,i[r],n,o))return!0;e=i[r]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=Cn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(gn);var gc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const _c=function(t){function e(e,i){var n=t.call(this)||this;return i&&!Array.isArray(e[0])?n.setFlatCoordinates(i,e):n.setCoordinates(e,i),n}return gc(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?ct(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,n){if(n<Te(this.getExtent(),t,e))return n;for(var o=this.flatCoordinates,r=this.stride,s=0,a=o.length;s<a;s+=r){var h=Kt(t,e,o[s],o[s+1]);if(h<n){n=h;for(var l=0;l<r;++l)i[l]=o[s+l];i.length=r}}return n},e.prototype.getCoordinates=function(){return En(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){return t<0||(this.flatCoordinates?this.flatCoordinates.length/this.stride:0)<=t?null:new Nn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],o=0,r=t.length;o<r;o+=i){var s=new Nn(t.slice(o,o+i),e);n.push(s)}return n},e.prototype.getType=function(){return"MultiPoint"},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,o=e.length;n<o;n+=i)if(Ae(t,e[n],e[n+1]))return!0;return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=bn(this.flatCoordinates,0,t,this.stride),this.changed()},e}(gn);var mc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const yc=function(t){function e(e,i,n){var o=t.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var r=o.getLayout(),s=e,a=[],h=[],l=0,u=s.length;l<u;++l){var c=s[l];0===l&&(r=c.getLayout());for(var p=a.length,d=c.getEnds(),f=0,g=d.length;f<g;++f)d[f]+=p;ct(a,c.getFlatCoordinates()),h.push(d)}i=r,e=a,n=h}return void 0!==i&&n?(o.setFlatCoordinates(i,e),o.endss_=n):o.setCoordinates(e,i),o}return mc(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;ct(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,o=(e=t.getEnds().slice()).length;n<o;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();var o=new e(this.flatCoordinates.slice(),this.layout,i);return o.applyProperties(this),o},e.prototype.closestPointXY=function(t,e,i,n){return n<Te(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];o=yn(t,e,a,n,o),e=a[a.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,o,r,s,a,h,l,u){for(var c=[NaN,NaN],p=0,d=i.length;p<d;++p){var f=i[p];l=xn(t,e,f,n,o,!0,s,a,h,l,c),e=f[f.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,o,r){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var h=i[s];if(qn(t,e,h,n,o,r))return!0;e=h[h.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var o=0,r=0,s=i.length;r<s;++r){var a=i[r];o+=On(t,e,a,n),e=a[a.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Hn(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,Ln(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,i,n){for(var o=[],r=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var h=i[s];r=Ie(t,e,h[0],n),o.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=h[h.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,i,n,o){for(var r=[],s=0,a=i.length;s<a;++s){var h=i[s];r=zn(t,e,h,n,o,2*s,r),e=h[h.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new _c(this.getFlatInteriorPoints().slice(),Wi)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];if(!Vn(t,e,a,n,void 0))return!1;a.length&&(e=a[a.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Hn(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,o,r,s,a){for(var h=0,l=i.length;h<l;++h){var u=i[h],c=[];s=Pn(t,e,u,n,o,r,s,c),a.push(c),e=u[u.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,Ui,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),o=n[n.length-1];if(0!==e)for(var r=0,s=n.length;r<s;++r)n[r]-=e;return new Qn(this.flatCoordinates.slice(e,o),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],o=0,r=0,s=i.length;r<s;++r){var a=i[r].slice(),h=a[a.length-1];if(0!==o)for(var l=0,u=a.length;l<u;++l)a[l]-=o;var c=new Qn(e.slice(o,h),t,a);n.push(c),o=h}return n},e.prototype.getType=function(){return"MultiPolygon"},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r];if(Bn(t,e,a,n,o))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,o){for(var r=o||[],s=0,a=0,h=i.length;a<h;++a){var l=Cn(t,e,i[a],n,r[s]);r[s++]=l,e=l[l.length-1]}return r.length=s,r}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(gn);var vc=i(8782);const xc=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Br(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}return t.prototype.clone=function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getDeclutterMode=function(){return this.declutterMode_},t.prototype.getAnchor=function(){return kt()},t.prototype.getImage=function(t){return kt()},t.prototype.getHitDetectionImage=function(){return kt()},t.prototype.getPixelRatio=function(t){return 1},t.prototype.getImageState=function(){return kt()},t.prototype.getImageSize=function(){return kt()},t.prototype.getOrigin=function(){return kt()},t.prototype.getSize=function(){return kt()},t.prototype.setDisplacement=function(t){this.displacement_=t},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=Br(t)},t.prototype.listenImageChange=function(t){kt()},t.prototype.load=function(){kt()},t.prototype.unlistenImageChange=function(t){kt()},t}();function wc(t){return Array.isArray(t)?co(t):t}var bc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Cc=function(t){function e(e){var i=this;return(i=t.call(this,{opacity:1,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0],declutterMode:e.declutterMode})||this).canvas_=void 0,i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius_=void 0!==e.radius?e.radius:e.radius1,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.size_=null,i.renderOptions_=null,i.render(),i}return bc(e,t),e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return i.setOpacity(this.getOpacity()),i},e.prototype.getAnchor=function(){var t=this.size_;if(!t)return null;var e=this.getDisplacement();return[t[0]/2-e[0],t[1]/2+e[1]]},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.setFill=function(t){this.fill_=t,this.render()},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var e=this.canvas_[t];if(!e){var i=this.renderOptions_,n=jo(i.size*t,i.size*t);this.draw_(i,n,t),this.canvas_[t]=e=n.canvas}return e},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return 2},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.setStroke=function(t){this.stroke_=t,this.render()},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;var n=this.radius_,o=void 0===this.radius2_?n:this.radius2_;if(n<o){var r=n;n=o,o=r}var s=2*Math.PI/(void 0===this.radius2_?this.points_:2*this.points_),a=o*Math.sin(s),h=n-Math.sqrt(o*o-a*a),l=Math.sqrt(a*a+h*h),u=l/a;if("miter"===t&&u<=i)return u*e;var c=e/2/u,p=e/2*(h/l),d=Math.sqrt((n+c)*(n+c)+p*p)-n;if(void 0===this.radius2_||"bevel"===t)return 2*d;var f=n*Math.sin(s),g=o-Math.sqrt(n*n-f*f),_=Math.sqrt(f*f+g*g)/f;return _<=i?2*Math.max(d,_*e/2-o-n):2*d},e.prototype.createRenderOptions=function(){var t,e=Ho,i=0,n=null,o=0,r=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=Ko),t=wc(t),void 0===(r=this.stroke_.getWidth())&&(r=1),n=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset(),void 0===(e=this.stroke_.getLineJoin())&&(e=Ho),void 0===(i=this.stroke_.getMiterLimit())&&(i=10));var s=this.calculateLineJoinSize_(e,r,i),a=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:r,size:Math.ceil(2*a+s),lineDash:n,lineDashOffset:o,lineJoin:e,miterLimit:i}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]},e.prototype.draw_=function(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){var n=this.fill_.getColor();null===n&&(n=Yo),e.fillStyle=wc(n),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var e=this.fill_.getColor(),i=0;if("string"==typeof e&&(e=lo(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){var n=jo(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var e=this.points_,i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{var n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);for(var o=this.angle_-Math.PI/2,r=2*Math.PI/e,s=0;s<e;s++){var a=o+s*r,h=s%2==0?i:n;t.lineTo(h*Math.cos(a),h*Math.sin(a))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Yo,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())},e}(xc);var Mc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Sc=function(t){function e(e){var i=e||{};return t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,scale:void 0!==i.scale?i.scale:1,rotation:void 0!==i.rotation?i.rotation:0,rotateWithView:void 0!==i.rotateWithView&&i.rotateWithView,displacement:void 0!==i.displacement?i.displacement:[0,0],declutterMode:i.declutterMode})||this}return Mc(e,t),e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return i.setOpacity(this.getOpacity()),i},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Cc),Tc=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),Pc=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}();var Ec=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Oc,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.hitDetectionRenderer_=void 0!==e.hitDetectionRenderer?e.hitDetectionRenderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.setHitDetectionRenderer=function(t){this.hitDetectionRenderer_=t},t.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Oc,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}(),Ac=null;function Lc(t,e){if(!Ac){var i=new Tc({color:"rgba(255,255,255,0.4)"}),n=new Pc({color:"#3399CC",width:1.25});Ac=[new Ec({image:new Sc({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return Ac}function Rc(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t.Polygon=[new Ec({fill:new Tc({color:[255,255,255,.5]})})],t.MultiPolygon=t.Polygon,t.LineString=[new Ec({stroke:new Pc({color:e,width:5})}),new Ec({stroke:new Pc({color:i,width:3})})],t.MultiLineString=t.LineString,t.Circle=t.Polygon.concat(t.LineString),t.Point=[new Ec({image:new Sc({radius:6,fill:new Tc({color:i}),stroke:new Pc({color:e,width:1.5})}),zIndex:1/0})],t.MultiPoint=t.Point,t.GeometryCollection=t.Polygon.concat(t.LineString,t.Point),t}function Oc(t){return t.getGeometry()}const Zc=Ec;var Ic=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),kc="renderOrder";const Nc=function(t){function e(e){var i=this,n=e||{},o=_t({},n);return delete o.style,delete o.renderBuffer,delete o.updateWhileAnimating,delete o.updateWhileInteracting,(i=t.call(this,o)||this).declutter_=void 0!==n.declutter&&n.declutter,i.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(n.style),i.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,i.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,i}return Ic(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(kc)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new vc(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(kc,t)},e.prototype.setStyle=function(t){var e,i,n;this.style_=void 0!==t?t:Lc,this.styleFunction_=null===t?void 0:("function"==typeof(e=this.style_)?i=e:(Array.isArray(e)?n=e:(be("function"==typeof e.getZIndex,41),n=[e]),i=function(){return n}),i),this.changed()},e}(Lo);var Fc={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Dc=[Fc.FILL],qc=[Fc.STROKE],zc=[Fc.BEGIN_PATH],jc=[Fc.CLOSE_PATH];const Gc=Fc,Uc=function(){function t(){}return t.prototype.drawCustom=function(t,e,i,n){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,e){},t.prototype.drawFeature=function(t,e){},t.prototype.drawGeometryCollection=function(t,e){},t.prototype.drawLineString=function(t,e){},t.prototype.drawMultiLineString=function(t,e){},t.prototype.drawMultiPoint=function(t,e){},t.prototype.drawMultiPolygon=function(t,e){},t.prototype.drawPoint=function(t,e){},t.prototype.drawPolygon=function(t,e){},t.prototype.drawText=function(t,e){},t.prototype.setFillStrokeStyle=function(t,e){},t.prototype.setImageStyle=function(t,e){},t.prototype.setTextStyle=function(t,e){},t}();var Bc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Wc=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.tolerance=e,r.maxExtent=i,r.pixelRatio=o,r.maxLineWidth=0,r.resolution=n,r.beginGeometryInstruction1_=null,r.beginGeometryInstruction2_=null,r.bufferedMaxExtent_=null,r.instructions=[],r.coordinates=[],r.tmpCoordinate_=[],r.hitDetectionInstructions=[],r.state={},r}return Bc(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},e.prototype.appendFlatPointCoordinates=function(t,e){for(var i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,o=this.coordinates,r=o.length,s=0,a=t.length;s<a;s+=e)n[0]=t[s],n[1]=t[s+1],Pe(i,n)&&(o[r++]=n[0],o[r++]=n[1]);return r},e.prototype.appendFlatLineCoordinates=function(t,e,i,n,o,r){var s=this.coordinates,a=s.length,h=this.getBufferedMaxExtent();r&&(e+=n);var l,u,c,p=t[e],d=t[e+1],f=this.tmpCoordinate_,g=!0;for(l=e+n;l<i;l+=n)f[0]=t[l],f[1]=t[l+1],(c=Le(h,f))!==u?(g&&(s[a++]=p,s[a++]=d,g=!1),s[a++]=f[0],s[a++]=f[1]):1===c?(s[a++]=f[0],s[a++]=f[1],g=!1):g=!0,p=f[0],d=f[1],u=c;return(o&&g||l===e+n)&&(s[a++]=p,s[a++]=d),a},e.prototype.drawCustomCoordinates_=function(t,e,i,n,o){for(var r=0,s=i.length;r<s;++r){var a=i[r],h=this.appendFlatLineCoordinates(t,e,a,n,!1,!1);o.push(h),e=a}return e},e.prototype.drawCustom=function(t,e,i,n){this.beginGeometry(t,e);var o,r,s,a,h,l=t.getType(),u=t.getStride(),c=this.coordinates.length;switch(l){case"MultiPolygon":o=t.getOrientedFlatCoordinates(),a=[];var p=t.getEndss();h=0;for(var d=0,f=p.length;d<f;++d){var g=[];h=this.drawCustomCoordinates_(o,h,p[d],u,g),a.push(g)}this.instructions.push([Gc.CUSTOM,c,a,t,i,Ln]),this.hitDetectionInstructions.push([Gc.CUSTOM,c,a,t,n||i,Ln]);break;case"Polygon":case"MultiLineString":s=[],o="Polygon"==l?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),h=this.drawCustomCoordinates_(o,0,t.getEnds(),u,s),this.instructions.push([Gc.CUSTOM,c,s,t,i,An]),this.hitDetectionInstructions.push([Gc.CUSTOM,c,s,t,n||i,An]);break;case"LineString":case"Circle":o=t.getFlatCoordinates(),r=this.appendFlatLineCoordinates(o,0,o.length,u,!1,!1),this.instructions.push([Gc.CUSTOM,c,r,t,i,En]),this.hitDetectionInstructions.push([Gc.CUSTOM,c,r,t,n||i,En]);break;case"MultiPoint":o=t.getFlatCoordinates(),(r=this.appendFlatPointCoordinates(o,u))>c&&(this.instructions.push([Gc.CUSTOM,c,r,t,i,En]),this.hitDetectionInstructions.push([Gc.CUSTOM,c,r,t,n||i,En]));break;case"Point":o=t.getFlatCoordinates(),this.coordinates.push(o[0],o[1]),this.instructions.push([Gc.CUSTOM,c,r=this.coordinates.length,t,i]),this.hitDetectionInstructions.push([Gc.CUSTOM,c,r,t,n||i])}this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[Gc.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Gc.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,o=e.length,r=-1;for(t=0;t<o;++t)(n=(i=e[t])[0])==Gc.END_GEOMETRY?r=t:n==Gc.BEGIN_GEOMETRY&&(i[2]=t,ut(this.hitDetectionInstructions,r,t),r=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=wc(n||Yo)}else i.fillStyle=void 0;if(e){var o=e.getColor();i.strokeStyle=wc(o||Ko);var r=e.getLineCap();i.lineCap=void 0!==r?r:Vo;var s=e.getLineDash();i.lineDash=s?s.slice():Xo;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var h=e.getLineJoin();i.lineJoin=void 0!==h?h:Ho;var l=e.getWidth();i.lineWidth=void 0!==l?l:1;var u=e.getMiterLimit();i.miterLimit=void 0!==u?u:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[Gc.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[Gc.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,o=t.lineDash,r=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||o!=t.currentLineDash&&!pt(t.currentLineDash,o)||t.currentLineDashOffset!=r||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=o,t.currentLineDashOffset=r,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=h)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[Gc.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){return this.bufferedMaxExtent_||(this.bufferedMaxExtent_=Se(this.maxExtent),this.maxLineWidth>0&&Me(this.bufferedMaxExtent_,this.resolution*(this.maxLineWidth+1)/2,this.bufferedMaxExtent_)),this.bufferedMaxExtent_},e}(Uc);var Yc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Vc=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.hitDetectionImage_=null,r.image_=null,r.imagePixelRatio_=void 0,r.anchorX_=void 0,r.anchorY_=void 0,r.height_=void 0,r.opacity_=void 0,r.originX_=void 0,r.originY_=void 0,r.rotateWithView_=void 0,r.rotation_=void 0,r.scale_=void 0,r.width_=void 0,r.declutterMode_=void 0,r.declutterImageWithText_=void 0,r}return Yc(e,t),e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.appendFlatPointCoordinates(i,n);this.instructions.push([Gc.DRAW_IMAGE,o,r,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Gc.DRAW_IMAGE,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.appendFlatPointCoordinates(i,n);this.instructions.push([Gc.DRAW_IMAGE,o,r,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Gc.DRAW_IMAGE,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),o=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=o[0],this.originY_=o[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e},e}(Wc);var Xc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Hc=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Xc(e,t),e.prototype.drawFlatCoordinates_=function(t,e,i,n){var o=this.coordinates.length,r=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),s=[Gc.MOVE_TO_LINE_TO,o,r];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state;if(void 0!==i.strokeStyle&&void 0!==i.lineWidth){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Gc.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Xo,0],zc);var n=t.getFlatCoordinates(),o=t.getStride();this.drawFlatCoordinates_(n,0,n.length,o),this.hitDetectionInstructions.push(qc),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state;if(void 0!==i.strokeStyle&&void 0!==i.lineWidth){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Gc.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],zc);for(var n=t.getEnds(),o=t.getFlatCoordinates(),r=t.getStride(),s=0,a=0,h=n.length;a<h;++a)s=this.drawFlatCoordinates_(o,s,n[a],r);this.hitDetectionInstructions.push(qc),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(qc),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(qc),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(zc)},e}(Wc);var Kc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Jc=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Kc(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var o=this.state,r=void 0!==o.fillStyle,s=void 0!==o.strokeStyle,a=i.length;this.instructions.push(zc),this.hitDetectionInstructions.push(zc);for(var h=0;h<a;++h){var l=i[h],u=this.coordinates.length,c=this.appendFlatLineCoordinates(t,e,l,n,!0,!s),p=[Gc.MOVE_TO_LINE_TO,u,c];this.instructions.push(p),this.hitDetectionInstructions.push(p),s&&(this.instructions.push(jc),this.hitDetectionInstructions.push(jc)),e=l}return r&&(this.instructions.push(Dc),this.hitDetectionInstructions.push(Dc)),s&&(this.instructions.push(qc),this.hitDetectionInstructions.push(qc)),e},e.prototype.drawCircle=function(t,e){var i=this.state;if(void 0!==i.fillStyle||void 0!==i.strokeStyle){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Gc.SET_FILL_STYLE,Yo]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Gc.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var n=t.getFlatCoordinates(),o=t.getStride(),r=this.coordinates.length;this.appendFlatLineCoordinates(n,0,n.length,o,!1,!1);var s=[Gc.CIRCLE,r];this.instructions.push(zc,s),this.hitDetectionInstructions.push(zc,s),void 0!==i.fillStyle&&(this.instructions.push(Dc),this.hitDetectionInstructions.push(Dc)),void 0!==i.strokeStyle&&(this.instructions.push(qc),this.hitDetectionInstructions.push(qc)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var i=this.state;if(void 0!==i.fillStyle||void 0!==i.strokeStyle){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Gc.SET_FILL_STYLE,Yo]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Gc.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var n=t.getEnds(),o=t.getOrientedFlatCoordinates(),r=t.getStride();this.drawFlatCoordinatess_(o,0,n,r),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state;if(void 0!==i.fillStyle||void 0!==i.strokeStyle){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Gc.SET_FILL_STYLE,Yo]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Gc.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var n=t.getEndss(),o=t.getOrientedFlatCoordinates(),r=t.getStride(),s=0,a=0,h=n.length;a<h;++a)s=this.drawFlatCoordinatess_(o,s,n[a],r);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var i=this.coordinates,n=0,o=i.length;n<o;++n)i[n]=Sn(i[n],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(Wc);function Qc(t,e,i,n,o){var r,s,a,h,l,u,c,p,d,f=i,g=i,_=0,m=0,y=i;for(r=i;r<n;r+=o){var v=e[r],x=e[r+1];void 0!==h&&(p=v-h,d=x-l,a=Math.sqrt(p*p+d*d),void 0!==u&&(m+=s,Math.acos((u*p+c*d)/(s*a))>t&&(m>_&&(_=m,f=y,g=r),m=0,y=r-o)),s=a,u=p,c=d),h=v,l=x}return(m+=a)>_?[y,r]:[f,g]}var $c=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),tp={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},ep={Circle:Jc,Default:Wc,Image:Vc,LineString:Hc,Polygon:Jc,Text:function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.labels_=null,r.text_="",r.textOffsetX_=0,r.textOffsetY_=0,r.textRotateWithView_=void 0,r.textRotation_=0,r.textFillState_=null,r.fillStates={},r.textStrokeState_=null,r.strokeStates={},r.textState_={},r.textStates={},r.textKey_="",r.fillKey_="",r.strokeKey_="",r.declutterImageWithText_=void 0,r}return $c(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textState_;if(""!==this.text_&&i&&(this.textFillState_||this.textStrokeState_)){var n=this.coordinates,o=n.length,r=t.getType(),s=null,a=t.getStride();if("line"!==i.placement||"LineString"!=r&&"MultiLineString"!=r&&"Polygon"!=r&&"MultiPolygon"!=r){var h=i.overflow?null:[];switch(r){case"Point":case"MultiPoint":s=t.getFlatCoordinates();break;case"LineString":s=t.getFlatMidpoint();break;case"Circle":s=t.getCenter();break;case"MultiLineString":s=t.getFlatMidpoints(),a=2;break;case"Polygon":s=t.getFlatInteriorPoint(),i.overflow||h.push(s[2]/this.resolution),a=3;break;case"MultiPolygon":var l=t.getFlatInteriorPoints();for(s=[],x=0,w=l.length;x<w;x+=3)i.overflow||h.push(l[x+2]/this.resolution),s.push(l[x],l[x+1]);if(0===s.length)return;a=2}if((E=this.appendFlatPointCoordinates(s,a))===o)return;if(h&&(E-o)/2!=s.length/a){var u=o/2;h=h.filter(function(t,e){var i=n[2*(u+e)]===s[e*a]&&n[2*(u+e)+1]===s[e*a+1];return i||--u,i})}this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var c=i.padding;if(c!=$o&&(i.scale[0]<0||i.scale[1]<0)){var p=i.padding[0],d=i.padding[1],f=i.padding[2],g=i.padding[3];i.scale[0]<0&&(d=-d,g=-g),i.scale[1]<0&&(p=-p,f=-f),c=[p,d,f,g]}var _=this.pixelRatio;this.instructions.push([Gc.DRAW_IMAGE,o,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,c==$o?$o:c.map(function(t){return t*_}),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);var m=1/_;this.hitDetectionInstructions.push([Gc.DRAW_IMAGE,o,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[m,m],NaN,void 0,this.declutterImageWithText_,c,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]),this.endGeometry(e)}else{if(!$e(this.getBufferedMaxExtent(),t.getExtent()))return;var y=void 0;if(s=t.getFlatCoordinates(),"LineString"==r)y=[s.length];else if("MultiLineString"==r)y=t.getEnds();else if("Polygon"==r)y=t.getEnds().slice(0,1);else if("MultiPolygon"==r){var v=t.getEndss();y=[];for(var x=0,w=v.length;x<w;++x)y.push(v[x][0])}this.beginGeometry(t,e);for(var b=i.textAlign,C=0,M=void 0,S=0,T=y.length;S<T;++S){if(null==b){var P=Qc(i.maxAngle,s,C,y[S],a);C=P[0],M=P[1]}else M=y[S];for(x=C;x<M;x+=a)n.push(s[x],s[x+1]);var E;C=y[S],this.drawChars_(o,E=n.length),o=E}this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var o=this.textKey_;o in this.textStates||(this.textStates[o]={font:e.font,textAlign:e.textAlign||Jo,justify:e.justify,textBaseline:e.textBaseline||Qo,scale:e.scale});var r=this.fillKey_;i&&(r in this.fillStates||(this.fillStates[r]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e){var i=this.textStrokeState_,n=this.textState_,o=this.strokeKey_,r=this.textKey_,s=this.fillKey_;this.saveTextStates_();var a=this.pixelRatio,h=tp[n.textBaseline],l=this.textOffsetY_*a,u=this.text_,c=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Gc.DRAW_CHARS,t,e,h,n.overflow,s,n.maxAngle,a,l,o,c*a,u,r,1]),this.hitDetectionInstructions.push([Gc.DRAW_CHARS,t,e,h,n.overflow,s,n.maxAngle,1,l,o,c,u,r,1/a])},e.prototype.setTextStyle=function(t,e){var i,n,o;if(t){var r=t.getFill();r?((n=this.textFillState_)||(this.textFillState_=n={}),n.fillStyle=wc(r.getColor()||Yo)):this.textFillState_=n=null;var s=t.getStroke();if(s){(o=this.textStrokeState_)||(this.textStrokeState_=o={});var a=s.getLineDash(),h=s.getLineDashOffset(),l=s.getWidth(),u=s.getMiterLimit();o.lineCap=s.getLineCap()||Vo,o.lineDash=a?a.slice():Xo,o.lineDashOffset=void 0===h?0:h,o.lineJoin=s.getLineJoin()||Ho,o.lineWidth=void 0===l?1:l,o.miterLimit=void 0===u?10:u,o.strokeStyle=wc(s.getColor()||Ko)}else this.textStrokeState_=o=null;i=this.textState_;var c=t.getFont()||Wo;rr(c);var p=t.getScaleArray();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Qo,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||$o,i.scale=void 0===p?[1,1]:p;var d=t.getOffsetX(),f=t.getOffsetY(),g=t.getRotateWithView(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===d?0:d,this.textOffsetY_=void 0===f?0:f,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===_?0:_,this.strokeKey_=o?("string"==typeof o.strokeStyle?o.strokeStyle:Ft(o.strokeStyle))+o.lineCap+o.lineDashOffset+"|"+o.lineWidth+o.lineJoin+o.miterLimit+"["+o.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+Ft(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e},e}(Wc)};const ip=function(){function t(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}return t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var n in i){var o=i[n].finish();t[e][n]=o}}return t},t.prototype.getBuilder=function(t,e){var i=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[i];void 0===n&&(this.buildersByZIndex_[i]=n={});var o=n[e];return void 0===o&&(o=new(0,ep[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=o),o},t}();function np(t,e,i,n,o,r,s,a,h,l,u,c){var p=t[e],d=t[e+1],f=0,g=0,_=0,m=0;function y(){f=p,g=d,p=t[e+=n],d=t[e+1],m+=_,_=Math.sqrt((p-f)*(p-f)+(d-g)*(d-g))}do{y()}while(e<i-n&&m+_<r);for(var v=0===_?0:(r-m)/_,x=$t(f,p,v),w=$t(g,d,v),b=e-n,C=m,M=r+a*h(l,o,u);e<i-n&&m+_<M;)y();var S,T=$t(f,p,v=0===_?0:(M-m)/_),P=$t(g,d,v);if(c){var E=[x,w,T,P];hn(E,0,4,2,c,E,E),S=E[0]>E[2]}else S=x>T;var A,L=Math.PI,R=[],O=b+n===e;if(_=0,m=C,p=t[e=b],d=t[e+1],O)return y(),A=Math.atan2(d-g,p-f),S&&(A+=A>0?-L:L),R[0]=[j=(T+x)/2,G=(P+w)/2,(M-r)/2,A,o],R;for(var Z=0,I=(o=o.replace(/\n/g," ")).length;Z<I;){y();var k=Math.atan2(d-g,p-f);if(S&&(k+=k>0?-L:L),void 0!==A){var N=k-A;if(N+=N>L?-2*L:N<-L?2*L:0,Math.abs(N)>s)return null}A=k;for(var F=Z,D=0;Z<I;++Z){var q=a*h(l,o[S?I-Z-1:Z],u);if(e+n<i&&m+_<r+D+q/2)break;D+=q}if(Z!==F){var z=S?o.substring(I-F,I-Z):o.substring(F,Z),j=$t(f,p,v=0===_?0:(r+D/2-m)/_),G=$t(g,d,v);R.push([j,G,D/2,k,z]),r+=D}}return R}var op=[1/0,1/0,-1/0,-1/0],rp=[],sp=[],ap=[],hp=[];function lp(t){return t[3].declutterBox}var up=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function cp(t,e){return"start"!==e&&"end"!==e||up.test(t)||(e="start"===e?"left":"right"),tp[e]}function pp(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const dp=function(){function t(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,e,i,n){var o=t+e+i+n;if(this.labels_[o])return this.labels_[o];var r=n?this.strokeStates[n]:null,s=i?this.fillStates[i]:null,a=this.textStates[e],h=this.pixelRatio,l=[a.scale[0]*h,a.scale[1]*h],u=Array.isArray(t),c=a.justify?tp[a.justify]:cp(Array.isArray(t)?t[0]:t,a.textAlign||Jo),p=n&&r.lineWidth?r.lineWidth:0,d=u?t:t.split("\n").reduce(pp,[]),f=function(t,e){for(var i=[],n=[],o=[],r=0,s=0,a=0,h=0,l=0,u=e.length;l<=u;l+=2){var c=e[l];if("\n"!==c&&l!==u){var p=e[l+1]||t.font,d=hr(p,c);i.push(d),s+=d;var f=sr(p);n.push(f),h=Math.max(h,f)}else r=Math.max(r,s),o.push(s),s=0,a+=h}return{width:r,height:a,widths:i,heights:n,lineWidths:o}}(a,d),g=f.widths,_=f.heights,m=f.lineWidths,y=f.width+p,v=[],x=(y+2)*l[0],w=(f.height+p)*l[1],b={width:x<0?Math.floor(x):Math.ceil(x),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:v};1==l[0]&&1==l[1]||v.push("scale",l),n&&(v.push("strokeStyle",r.strokeStyle),v.push("lineWidth",p),v.push("lineCap",r.lineCap),v.push("lineJoin",r.lineJoin),v.push("miterLimit",r.miterLimit),($i?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(v.push("setLineDash",[r.lineDash]),v.push("lineDashOffset",r.lineDashOffset))),i&&v.push("fillStyle",s.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");for(var C,M=.5-c,S=c*y+M*p,T=[],P=[],E=0,A=0,L=0,R=0,O=0,Z=d.length;O<Z;O+=2){var I=d[O];if("\n"!==I){var k=d[O+1]||a.font;k!==C&&(n&&T.push("font",k),i&&P.push("font",k),C=k),E=Math.max(E,_[L]);var N=[I,S+M*g[L]+c*(g[L]-m[R]),.5*(p+E)+A];S+=g[L],n&&T.push("strokeText",N),i&&P.push("fillText",N),++L}else A+=E,E=0,S=c*y+M*p,++R}return Array.prototype.push.apply(v,T),Array.prototype.push.apply(v,P),this.labels_[o]=b,b},t.prototype.replayTextBackground_=function(t,e,i,n,o,r,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,o),t.lineTo.apply(t,e),r&&(this.alignFill_=r[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},t.prototype.calculateImageOrLabelDimensions_=function(t,e,i,n,o,r,s,a,h,l,u,c,p,d,f,g){var _,m=i-(s*=c[0]),y=n-(a*=c[1]),v=o+h>t?t-h:o,x=r+l>e?e-l:r,w=d[3]+v*c[0]+d[1],b=d[0]+x*c[1]+d[2],C=m-d[3],M=y-d[0];return(f||0!==u)&&(rp[0]=C,hp[0]=C,rp[1]=M,sp[1]=M,sp[0]=C+w,ap[0]=sp[0],ap[1]=M+b,hp[1]=ap[1]),0!==u?(nn(_=on([1,0,0,1,0,0],i,n,1,1,u,-i,-n),rp),nn(_,sp),nn(_,ap),nn(_,hp),Re(Math.min(rp[0],sp[0],ap[0],hp[0]),Math.min(rp[1],sp[1],ap[1],hp[1]),Math.max(rp[0],sp[0],ap[0],hp[0]),Math.max(rp[1],sp[1],ap[1],hp[1]),op)):Re(Math.min(C,C+w),Math.min(M,M+b),Math.max(C,C+w),Math.max(M,M+b),op),p&&(m=Math.round(m),y=Math.round(y)),{drawImageX:m,drawImageY:y,drawImageW:v,drawImageH:x,originX:h,originY:l,declutterBox:{minX:op[0],minY:op[1],maxX:op[2],maxY:op[3],value:g},canvasTransform:_,scale:c}},t.prototype.replayImageOrLabel_=function(t,e,i,n,o,r,s){var a=n.declutterBox,h=t.canvas,l=s?s[2]*n.scale[0]/2:0;return a.minX-l<=h.width/e&&a.maxX+l>=0&&a.minY-l<=h.height/e&&a.maxY+l>=0&&(!(!r&&!s)&&this.replayTextBackground_(t,rp,sp,ap,hp,r,s),function(t,e,i,n,o,r,s,a,h,l,u){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(h,l),t.scale(u[0],u[1]),function(t,e){for(var i=t.contextInstructions,n=0,o=i.length;n<o;n+=2)Array.isArray(i[n+1])?e[i[n]].apply(e,i[n+1]):e[i[n]]=i[n+1]}(n,t)):u[0]<0||u[1]<0?(t.translate(h,l),t.scale(u[0],u[1]),t.drawImage(n,o,r,s,a,0,0,s,a)):t.drawImage(n,o,r,s,a,h,l,s*u[0],a*u[1]),t.restore()}(t,n.canvasTransform,o,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0},t.prototype.fill_=function(t){if(this.alignFill_){var e=nn(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},t.prototype.drawLabelWithPointPlacement_=function(t,e,i,n){var o=this.textStates[e],r=this.createLabel(t,e,n,i),s=this.strokeStates[i],a=this.pixelRatio,h=cp(Array.isArray(t)?t[0]:t,o.textAlign||Jo),l=tp[o.textBaseline||Qo],u=s&&s.lineWidth?s.lineWidth:0;return{label:r,anchorX:h*(r.width/a-2*o.scale[0])+2*(.5-h)*u,anchorY:l*r.height/a+2*(.5-l)*u}},t.prototype.execute_=function(t,e,i,n,o,r,s,a){var h,l,u;this.pixelCoordinates_&&pt(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=an(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(l=this.renderedTransform_)[0]=(u=i)[0],l[1]=u[1],l[2]=u[2],l[3]=u[3],l[4]=u[4],l[5]=u[5]);for(var c,p,d,f,g,_,m,y,v,x,w,b,C,M,S,T,P=0,E=n.length,A=0,L=0,R=0,O=null,Z=null,I=this.coordinateCache_,k=this.viewRotation_,N=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,F={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:k},D=this.instructions!=n||this.overlaps?0:200;P<E;){var q=n[P];switch(q[0]){case Gc.BEGIN_GEOMETRY:T=q[3],(C=q[1]).getGeometry()?void 0===s||$e(s,T.getExtent())?++P:P=q[2]+1:P=q[2];break;case Gc.BEGIN_PATH:L>D&&(this.fill_(t),L=0),R>D&&(t.stroke(),R=0),L||R||(t.beginPath(),f=NaN,g=NaN),++P;break;case Gc.CIRCLE:var z=h[A=q[1]],j=h[A+1],G=h[A+2]-z,U=h[A+3]-j,B=Math.sqrt(G*G+U*U);t.moveTo(z+B,j),t.arc(z,j,B,0,2*Math.PI,!0),++P;break;case Gc.CLOSE_PATH:t.closePath(),++P;break;case Gc.CUSTOM:A=q[1],c=q[2];var W=q[4],Y=6==q.length?q[5]:void 0;F.geometry=q[3],F.feature=C,P in I||(I[P]=[]);var V=I[P];Y?Y(h,A,c,2,V):(V[0]=h[A],V[1]=h[A+1],V.length=2),W(V,F),++P;break;case Gc.DRAW_IMAGE:A=q[1],c=q[2],p=q[4],d=q[5];var X=q[6],H=q[7],K=q[8],J=q[9],Q=q[10],$=q[11],tt=q[12],et=q[13],it=q[14],nt=q[15];if(!(y=q[3])&&q.length>=20){var ot=this.drawLabelWithPointPlacement_(v=q[19],x=q[20],w=q[21],b=q[22]);q[3]=y=ot.label,q[4]=p=(ot.anchorX-q[23])*this.pixelRatio,q[5]=d=(ot.anchorY-q[24])*this.pixelRatio,q[6]=X=y.height,q[13]=et=y.width}var rt=void 0;q.length>25&&(rt=q[25]);var st=void 0,at=void 0,ht=void 0;q.length>17?(st=q[16],at=q[17],ht=q[18]):(st=$o,at=!1,ht=!1),Q&&N?$+=k:Q||N||($-=k);for(var lt=0;A<c;A+=2)if(!(rt&&rt[lt++]<et/this.pixelRatio)){var ut=[t,e,y,Nt=this.calculateImageOrLabelDimensions_(y.width,y.height,h[A],h[A+1],et,X,p,d,K,J,$,tt,o,st,at||ht,C),H,at?O:null,ht?Z:null];if(a){if("none"===it)continue;if("obstacle"===it){a.insert(Nt.declutterBox);continue}var ct=void 0,dt=void 0;if(nt){var ft=c-A;if(!nt[ft]){nt[ft]=ut;continue}if(ct=nt[ft],delete nt[ft],dt=lp(ct),a.collides(dt))continue}if(a.collides(Nt.declutterBox))continue;ct&&(a.insert(dt),this.replayImageOrLabel_.apply(this,ct)),a.insert(Nt.declutterBox)}this.replayImageOrLabel_.apply(this,ut)}++P;break;case Gc.DRAW_CHARS:var gt=q[1],_t=q[2],mt=q[3],yt=q[4];b=q[5];var vt=q[6],xt=q[7],wt=q[8];w=q[9];var bt=q[10];v=q[11];var Ct=[q[13],q[13]],Mt=this.textStates[x=q[12]],St=Mt.font,Tt=[Mt.scale[0]*xt,Mt.scale[1]*xt],Pt=void 0;St in this.widths_?Pt=this.widths_[St]:this.widths_[St]=Pt={};var Et=uc(h,gt,_t,2),At=Math.abs(Tt[0])*lr(St,v,Pt);if(yt||At<=Et){var Lt=np(h,gt,_t,2,v,(Et-At)*tp[this.textStates[x].textAlign],vt,Math.abs(Tt[0]),lr,St,Pt,N?0:this.viewRotation_);t:if(Lt){var Rt=[],Ot=void 0,Zt=void 0,It=void 0,kt=void 0;if(w)for(Ot=0,Zt=Lt.length;Ot<Zt;++Ot){It=this.createLabel((kt=Lt[Ot])[4],x,"",w);var Nt=this.calculateImageOrLabelDimensions_(It.width,It.height,kt[0],kt[1],It.width,It.height,p=kt[2]+(Tt[0]<0?-bt:bt),d=mt*It.height+2*(.5-mt)*bt*Tt[1]/Tt[0]-wt,0,0,kt[3],Ct,!1,$o,!1,C);if(a&&a.collides(Nt.declutterBox))break t;Rt.push([t,e,It,Nt,1,null,null])}if(b)for(Ot=0,Zt=Lt.length;Ot<Zt;++Ot){if(It=this.createLabel((kt=Lt[Ot])[4],x,b,""),Nt=this.calculateImageOrLabelDimensions_(It.width,It.height,kt[0],kt[1],It.width,It.height,p=kt[2],d=mt*It.height-wt,0,0,kt[3],Ct,!1,$o,!1,C),a&&a.collides(Nt.declutterBox))break t;Rt.push([t,e,It,Nt,1,null,null])}a&&a.load(Rt.map(lp));for(var Ft=0,Dt=Rt.length;Ft<Dt;++Ft)this.replayImageOrLabel_.apply(this,Rt[Ft])}}++P;break;case Gc.END_GEOMETRY:if(void 0!==r){var qt=r(C=q[1],T);if(qt)return qt}++P;break;case Gc.FILL:D?L++:this.fill_(t),++P;break;case Gc.MOVE_TO_LINE_TO:for(c=q[2],m=(S=h[(A=q[1])+1])+.5|0,(_=(M=h[A])+.5|0)===f&&m===g||(t.moveTo(M,S),f=_,g=m),A+=2;A<c;A+=2)_=(M=h[A])+.5|0,m=(S=h[A+1])+.5|0,A!=c-2&&_===f&&m===g||(t.lineTo(M,S),f=_,g=m);++P;break;case Gc.SET_FILL_STYLE:O=q,this.alignFill_=q[2],L&&(this.fill_(t),L=0,R&&(t.stroke(),R=0)),t.fillStyle=q[1],++P;break;case Gc.SET_STROKE_STYLE:Z=q,R&&(t.stroke(),R=0),this.setStrokeStyle_(t,q),++P;break;case Gc.STROKE:D?R++:t.stroke(),++P;break;default:++P}}L&&this.fill_(t),R&&t.stroke()},t.prototype.execute=function(t,e,i,n,o,r){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,o,void 0,void 0,r)},t.prototype.executeHitDetection=function(t,e,i,n,o){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,o)},t}();var fp=["Polygon","Circle","LineString","Image","Text","Default"],gp=function(){function t(t,e,i,n,o,r){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=r,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(o)}return t.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},t.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];void 0===i&&(this.executorsByZIndex_[e]=i={});var n=t[e];for(var o in n)i[o]=new dp(this.resolution_,this.pixelRatio_,this.overlaps_,n[o])}},t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[e],n=0,o=t.length;n<o;++n)if(t[n]in i)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o,r){var s=2*(n=Math.round(n))+1,a=on(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=jo(s,s));var l,u=this.hitDetectionContext_;u.canvas.width!==s||u.canvas.height!==s?(u.canvas.width=s,u.canvas.height=s):h||u.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(Fe(l=[1/0,1/0,-1/0,-1/0],t),Me(l,e*(this.renderBuffer_+n),l));var c,p=function(t){if(void 0!==_p[t])return _p[t];for(var e=2*t+1,i=t*t,n=new Array(i+1),o=0;o<=t;++o)for(var r=0;r<=t;++r){var s=o*o+r*r;if(s>i)break;var a=n[s];a||(n[s]=a=[]),a.push(4*((t+o)*e+(t+r))+3),o>0&&a.push(4*((t-o)*e+(t+r))+3),r>0&&(a.push(4*((t+o)*e+(t-r))+3),o>0&&a.push(4*((t-o)*e+(t-r))+3))}for(var h=[],l=(o=0,n.length);o<l;++o)n[o]&&h.push.apply(h,n[o]);return _p[t]=h,h}(n);function d(t,e){for(var i=u.getImageData(0,0,s,s).data,a=0,h=p.length;a<h;a++)if(i[p[a]]>0){if(!r||"Image"!==c&&"Text"!==c||-1!==r.indexOf(t)){var l=(p[a]-3)/4,d=n-l%s,f=n-(l/s|0),g=o(t,e,d*d+f*f);if(g)return g}u.clearRect(0,0,s,s);break}}var f,g,_,m,y,v=Object.keys(this.executorsByZIndex_).map(Number);for(v.sort(ht),f=v.length-1;f>=0;--f){var x=v[f].toString();for(_=this.executorsByZIndex_[x],g=fp.length-1;g>=0;--g)if(void 0!==(m=_[c=fp[g]])&&(y=m.executeHitDetection(u,a,i,d,l)))return y}},t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var i=e[0],n=e[1],o=e[2],r=e[3],s=[i,n,i,r,o,r,o,n];return an(s,0,8,2,t,s),s},t.prototype.isEmpty=function(){return vt(this.executorsByZIndex_)},t.prototype.execute=function(t,e,i,n,o,r,s){var a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(ht),this.maxExtent_&&(t.save(),this.clip(t,i));var h,l,u,c,p,d,f=r||fp;for(s&&a.reverse(),h=0,l=a.length;h<l;++h){var g=a[h].toString();for(p=this.executorsByZIndex_[g],u=0,c=f.length;u<c;++u)void 0!==(d=p[f[u]])&&d.execute(t,e,i,n,o,s)}this.maxExtent_&&t.restore()},t}(),_p={};const mp=gp;var yp=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const vp=function(t){function e(e,i,n,o,r,s,a){var h=t.call(this)||this;return h.context_=e,h.pixelRatio_=i,h.extent_=n,h.transform_=o,h.viewRotation_=r,h.squaredTolerance_=s,h.userTransform_=a,h.contextFillState_=null,h.contextStrokeState_=null,h.contextTextState_=null,h.fillState_=null,h.strokeState_=null,h.image_=null,h.imageAnchorX_=0,h.imageAnchorY_=0,h.imageHeight_=0,h.imageOpacity_=0,h.imageOriginX_=0,h.imageOriginY_=0,h.imageRotateWithView_=!1,h.imageRotation_=0,h.imageScale_=[0,0],h.imageWidth_=0,h.text_="",h.textOffsetX_=0,h.textOffsetY_=0,h.textRotateWithView_=!1,h.textRotation_=0,h.textScale_=[0,0],h.textFillState_=null,h.textStrokeState_=null,h.textState_=null,h.pixelCoordinates_=[],h.tmpLocalTransform_=[1,0,0,1,0,0],h}return yp(e,t),e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var o=an(t,e,i,n,this.transform_,this.pixelCoordinates_),r=this.context_,s=this.tmpLocalTransform_,a=r.globalAlpha;1!=this.imageOpacity_&&(r.globalAlpha=a*this.imageOpacity_);var h=this.imageRotation_;this.imageRotateWithView_&&(h+=this.viewRotation_);for(var l=0,u=o.length;l<u;l+=2){var c=o[l]-this.imageAnchorX_,p=o[l+1]-this.imageAnchorY_;if(0!==h||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var d=c+this.imageAnchorX_,f=p+this.imageAnchorY_;on(s,d,f,1,1,h,-d,-f),r.setTransform.apply(r,s),r.translate(d,f),r.scale(this.imageScale_[0],this.imageScale_[1]),r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),r.setTransform(1,0,0,1,0,0)}else r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,p,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(r.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var o=an(t,e,i,n,this.transform_,this.pixelCoordinates_),r=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a=o[e]+this.textOffsetX_,h=o[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_[0]||1!=this.textScale_[1]){var l=on(this.tmpLocalTransform_,a,h,1,1,s,-a,-h);r.setTransform.apply(r,l),r.translate(a,h),r.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&r.strokeText(this.text_,0,0),this.textFillState_&&r.fillText(this.text_,0,0),r.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&r.strokeText(this.text_,a,h),this.textFillState_&&r.fillText(this.text_,a,h)}}},e.prototype.moveToLineTo_=function(t,e,i,n,o){var r=this.context_,s=an(t,e,i,n,this.transform_,this.pixelCoordinates_);r.moveTo(s[0],s[1]);var a=s.length;o&&(a-=2);for(var h=2;h<a;h+=2)r.lineTo(s[h],s[h+1]);return o&&r.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var o=0,r=i.length;o<r;++o)e=this.moveToLineTo_(t,e,i[o],n,!0);return e},e.prototype.drawCircle=function(t){if($e(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var o=t.getStride();return an(n,0,n.length,o,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],o=Math.sqrt(i*i+n*n),r=this.context_;r.beginPath(),r.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&$e(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),$e(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if($e(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),o=0,r=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,h=r.length;a<h;++a)o=this.moveToLineTo_(n,o,r[a],s,!1);i.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),$e(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),$e(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,o=t.getEndss(),r=t.getStride();e.beginPath();for(var s=0,a=o.length;s<a;++s)n=this.drawRings_(i,n,o[s],r);this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(pt(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Jo;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){var i=this;if(t){var n=t.getColor();this.fillState_={fillStyle:wc(n||Yo)}}else this.fillState_=null;if(e){var o=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),a=e.getLineDashOffset(),h=e.getLineJoin(),l=e.getWidth(),u=e.getMiterLimit(),c=s||Xo;this.strokeState_={lineCap:void 0!==r?r:Vo,lineDash:1===this.pixelRatio_?c:c.map(function(t){return t*i.pixelRatio_}),lineDashOffset:(a||0)*this.pixelRatio_,lineJoin:void 0!==h?h:Ho,lineWidth:(void 0!==l?l:1)*this.pixelRatio_,miterLimit:void 0!==u?u:10,strokeStyle:wc(o||Ko)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){var e;if(t&&(e=t.getSize())){var i=t.getAnchor(),n=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*this.pixelRatio_,this.imageAnchorY_=i[1]*this.pixelRatio_,this.imageHeight_=e[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=e[0]*this.pixelRatio_}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:wc(i||Yo)}}else this.textFillState_=null;var n=t.getStroke();if(n){var o=n.getColor(),r=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),h=n.getLineJoin(),l=n.getWidth(),u=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==r?r:Vo,lineDash:s||Xo,lineDashOffset:a||0,lineJoin:void 0!==h?h:Ho,lineWidth:void 0!==l?l:1,miterLimit:void 0!==u?u:10,strokeStyle:wc(o||Ko)}}else this.textStrokeState_=null;var c=t.getFont(),p=t.getOffsetX(),d=t.getOffsetY(),f=t.getRotateWithView(),g=t.getRotation(),_=t.getScaleArray(),m=t.getText(),y=t.getTextAlign(),v=t.getTextBaseline();this.textState_={font:void 0!==c?c:Wo,textAlign:void 0!==y?y:Jo,textBaseline:void 0!==v?v:Qo},this.text_=void 0!==m?Array.isArray(m)?m.reduce(function(t,e,i){return t+(i%2?" ":e)},""):m:"",this.textOffsetX_=void 0!==p?this.pixelRatio_*p:0,this.textOffsetY_=void 0!==d?this.pixelRatio_*d:0,this.textRotateWithView_=void 0!==f&&f,this.textRotation_=void 0!==g?g:0,this.textScale_=[this.pixelRatio_*_[0],this.pixelRatio_*_[1]]}else this.text_=""},e}(Uc),xp="fraction",wp="pixels",bp="bottom-left",Cp="bottom-right",Mp="top-left",Sp="top-right";var Tp=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pp=null,Ep=function(t){function e(e,i,n,o,r,s){var a=t.call(this)||this;return a.hitDetectionImage_=null,a.image_=e||new Image,null!==o&&(a.image_.crossOrigin=o),a.canvas_={},a.color_=s,a.unlisten_=null,a.imageState_=r,a.size_=n,a.src_=i,a}return Tp(e,t),e.prototype.isTainted_=function(){if(void 0===this.tainted_&&2===this.imageState_){Pp||(Pp=jo(1,1)),Pp.drawImage(this.image_,0,0);try{Pp.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Pp=null,this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(Ct)},e.prototype.handleImageError_=function(){this.imageState_=3,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=2,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],i=jo(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(0==this.imageState_){this.imageState_=1;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=tu(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(this.color_&&!this.canvas_[t]&&2===this.imageState_){var e=document.createElement("canvas");this.canvas_[t]=e,e.width=Math.ceil(this.image_.width*t),e.height=Math.ceil(this.image_.height*t);var i=e.getContext("2d");if(i.scale(t,t),i.drawImage(this.image_,0,0),i.globalCompositeOperation="multiply","multiply"===i.globalCompositeOperation||this.isTainted_())i.fillStyle=ao(this.color_),i.fillRect(0,0,e.width/t,e.height/t),i.globalCompositeOperation="destination-in",i.drawImage(this.image_,0,0);else{for(var n=i.getImageData(0,0,e.width,e.height),o=n.data,r=this.color_[0]/255,s=this.color_[1]/255,a=this.color_[2]/255,h=this.color_[3],l=0,u=o.length;l<u;l+=4)o[l]*=r,o[l+1]*=s,o[l+2]*=a,o[l+3]*=h;i.putImageData(n,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(bt),Ap=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Lp=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{opacity:void 0!==n.opacity?n.opacity:1,rotation:void 0!==n.rotation?n.rotation:0,scale:void 0!==n.scale?n.scale:1,displacement:void 0!==n.displacement?n.displacement:[0,0],rotateWithView:void 0!==n.rotateWithView&&n.rotateWithView,declutterMode:n.declutterMode})||this).anchor_=void 0!==n.anchor?n.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==n.anchorOrigin?n.anchorOrigin:Mp,i.anchorXUnits_=void 0!==n.anchorXUnits?n.anchorXUnits:xp,i.anchorYUnits_=void 0!==n.anchorYUnits?n.anchorYUnits:xp,i.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null;var o=void 0!==n.img?n.img:null;i.imgSize_=n.imgSize;var r=n.src;be(!(void 0!==r&&o),4),be(!o||o&&i.imgSize_,5),void 0!==r&&0!==r.length||!o||(r=o.src||Ft(o)),be(void 0!==r&&r.length>0,6);var s=void 0!==n.src?0:2;return i.color_=void 0!==n.color?lo(n.color):null,i.iconImage_=function(t,e,i,n,o,r){var s=fo.get(e,n,r);return s||(s=new Ep(t,e,i,n,o,r),fo.set(e,n,r,s)),s}(o,r,void 0!==i.imgSize_?i.imgSize_:null,i.crossOrigin_,s,i.color_),i.offset_=void 0!==n.offset?n.offset:[0,0],i.offsetOrigin_=void 0!==n.offsetOrigin?n.offsetOrigin:Mp,i.origin_=null,i.size_=void 0!==n.size?n.size:null,i}return Ap(e,t),e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})},e.prototype.getAnchor=function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if(this.anchorXUnits_==xp||this.anchorYUnits_==xp){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==xp&&(t[0]*=e[0]),this.anchorYUnits_==xp&&(t[1]*=e[1])}if(this.anchorOrigin_!=Mp){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Sp&&this.anchorOrigin_!=Cp||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=bp&&this.anchorOrigin_!=Cp||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}var i=this.getDisplacement();return[t[0]-i[0],t[1]+i[1]]},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Mp){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),this.offsetOrigin_!=Sp&&this.offsetOrigin_!=Cp||(t[0]=i[0]-e[0]-t[0]),this.offsetOrigin_!=bp&&this.offsetOrigin_!=Cp||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(Ct,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(Ct,t)},e}(xc);var Rp=.5,Op={Point:function(t,e,i,n,o){var r,s=i.getImage(),a=i.getText();if(s){if(2!=s.getImageState())return;var h=t;if(o){var l=s.getDeclutterMode();if("none"!==l)if(h=o,"obstacle"===l){var u=t.getBuilder(i.getZIndex(),"Image");u.setImageStyle(s,r),u.drawPoint(e,n)}else a&&a.getText()&&(r={})}var c=h.getBuilder(i.getZIndex(),"Image");c.setImageStyle(s,r),c.drawPoint(e,n)}if(a&&a.getText()){var p=t;o&&(p=o);var d=p.getBuilder(i.getZIndex(),"Text");d.setTextStyle(a,r),d.drawText(e,n)}},LineString:function(t,e,i,n,o){var r=i.getStroke();if(r){var s=t.getBuilder(i.getZIndex(),"LineString");s.setFillStrokeStyle(null,r),s.drawLineString(e,n)}var a=i.getText();if(a&&a.getText()){var h=(o||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(a),h.drawText(e,n)}},Polygon:function(t,e,i,n,o){var r=i.getFill(),s=i.getStroke();if(r||s){var a=t.getBuilder(i.getZIndex(),"Polygon");a.setFillStrokeStyle(r,s),a.drawPolygon(e,n)}var h=i.getText();if(h&&h.getText()){var l=(o||t).getBuilder(i.getZIndex(),"Text");l.setTextStyle(h),l.drawText(e,n)}},MultiPoint:function(t,e,i,n,o){var r,s=i.getImage(),a=i.getText();if(s){if(2!=s.getImageState())return;var h=t;if(o){var l=s.getDeclutterMode();if("none"!==l)if(h=o,"obstacle"===l){var u=t.getBuilder(i.getZIndex(),"Image");u.setImageStyle(s,r),u.drawMultiPoint(e,n)}else a&&a.getText()&&(r={})}var c=h.getBuilder(i.getZIndex(),"Image");c.setImageStyle(s,r),c.drawMultiPoint(e,n)}if(a&&a.getText()){var p=t;o&&(p=o);var d=p.getBuilder(i.getZIndex(),"Text");d.setTextStyle(a,r),d.drawText(e,n)}},MultiLineString:function(t,e,i,n,o){var r=i.getStroke();if(r){var s=t.getBuilder(i.getZIndex(),"LineString");s.setFillStrokeStyle(null,r),s.drawMultiLineString(e,n)}var a=i.getText();if(a&&a.getText()){var h=(o||t).getBuilder(i.getZIndex(),"Text");h.setTextStyle(a),h.drawText(e,n)}},MultiPolygon:function(t,e,i,n,o){var r=i.getFill(),s=i.getStroke();if(s||r){var a=t.getBuilder(i.getZIndex(),"Polygon");a.setFillStrokeStyle(r,s),a.drawMultiPolygon(e,n)}var h=i.getText();if(h&&h.getText()){var l=(o||t).getBuilder(i.getZIndex(),"Text");l.setTextStyle(h),l.drawText(e,n)}},GeometryCollection:function(t,e,i,n,o){var r,s,a=e.getGeometriesArray();for(r=0,s=a.length;r<s;++r)(0,Op[a[r].getType()])(t,a[r],i,n,o)},Circle:function(t,e,i,n,o){var r=i.getFill(),s=i.getStroke();if(r||s){var a=t.getBuilder(i.getZIndex(),"Circle");a.setFillStrokeStyle(r,s),a.drawCircle(e,n)}var h=i.getText();if(h&&h.getText()){var l=(o||t).getBuilder(i.getZIndex(),"Text");l.setTextStyle(h),l.drawText(e,n)}}};function Zp(t,e){return parseInt(Ft(t),10)-parseInt(Ft(e),10)}function Ip(t,e){return.5*t/e}function kp(t,e,i,n,o,r,s){var a=!1,h=i.getImage();if(h){var l=h.getImageState();2==l||3==l?h.unlistenImageChange(o):(0==l&&h.load(),h.listenImageChange(o),a=!0)}return function(t,e,i,n,o,r){var s=i.getGeometryFunction()(e);if(s){var a=s.simplifyTransformed(n,o);i.getRenderer()?Np(t,a,i,e):(0,Op[a.getType()])(t,a,i,e,r)}}(t,e,i,n,r,s),a}function Np(t,e,i,n){if("GeometryCollection"!=e.getType())t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer());else for(var o=e.getGeometries(),r=0,s=o.length;r<s;++r)Np(t,o[r],i,n)}var Fp=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Dp=function(t){function e(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=[1/0,1/0,-1/0,-1/0],i.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i.declutterExecutorGroup=null,i.clipping=!0,i.compositionContext_=null,i.opacity_=1,i}return Fp(e,t),e.prototype.renderWorlds=function(t,e,i){var n=e.extent,o=e.viewState,r=o.center,s=o.resolution,a=o.projection,h=o.rotation,l=a.getExtent(),u=this.getLayer().getSource(),c=e.pixelRatio,p=e.viewHints,d=!(p[0]||p[1]),f=this.compositionContext_,g=Math.round(e.size[0]*c),_=Math.round(e.size[1]*c),m=u.getWrapX()&&a.canWrapX(),y=m?Qe(l):null,v=m?Math.ceil((n[2]-l[2])/y)+1:1,x=m?Math.floor((n[0]-l[0])/y):0;do{var w=this.getRenderTransform(r,s,h,c,g,_,x*y);t.execute(f,1,w,h,d,void 0,i)}while(++x<v)},e.prototype.setupCompositionContext_=function(){if(1!==this.opacity_){var t=jo(this.context.canvas.width,this.context.canvas.height,Yl);this.compositionContext_=t}else this.compositionContext_=this.context},e.prototype.releaseCompositionContext_=function(){if(1!==this.opacity_){var t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,Go(this.compositionContext_),Yl.push(this.compositionContext_.canvas),this.compositionContext_=null}},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())},e.prototype.renderFrame=function(t,e){var i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,i){!function(t,e,i,n,o,r,s){t[0]=e,t[1]=0,t[2]=0,t[3]=o,t[4]=0,t[5]=0}(t,e,0,0,i)}(this.pixelTransform,1/i,1/i),rn(this.inversePixelTransform,this.pixelTransform);var o=sn(this.pixelTransform);this.useContainer(e,o,this.getBackground(t));var r=this.context,s=r.canvas,a=this.replayGroup_,h=this.declutterExecutorGroup;if((!a||a.isEmpty())&&(!h||h.isEmpty()))return null;var l=Math.round(t.size[0]*i),u=Math.round(t.size[1]*i);s.width!=l||s.height!=u?(s.width=l,s.height=u,s.style.transform!==o&&(s.style.transform=o)):this.containerReused||r.clearRect(0,0,l,u),this.preRender(r,t);var c=t.viewState;this.opacity_=n.opacity,this.setupCompositionContext_();var p=!1,d=!0;if(n.extent&&this.clipping){var f=Li(n.extent);(p=(d=$e(f,t.extent))&&!Ee(f,t.extent))&&this.clipUnrotated(this.compositionContext_,t,f)}return d&&this.renderWorlds(a,t),p&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(r,t),this.renderedRotation_!==c.rotation&&(this.renderedRotation_=c.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise((function(e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var i=[this.context.canvas.width,this.context.canvas.height];nn(this.pixelTransform,i);var n=this.renderedCenter_,o=this.renderedResolution_,r=this.renderedRotation_,s=this.renderedProjection_,a=this.wrappedRenderedExtent_,h=this.getLayer(),l=[],u=i[0]*Rp,c=i[1]*Rp;l.push(this.getRenderTransform(n,o,r,Rp,u,c,0).slice());var p=h.getSource(),d=s.getExtent();if(p.getWrapX()&&s.canWrapX()&&!Ee(d,a)){for(var f=a[0],g=Qe(d),_=0;f<d[0];)--_,l.push(this.getRenderTransform(n,o,r,Rp,u,c,g*_).slice()),f+=g;for(_=0,f=a[2];f>d[2];)++_,l.push(this.getRenderTransform(n,o,r,Rp,u,c,g*_).slice()),f-=g}this.hitDetectionImageData_=function(t,e,i,n,o,r,s){var a=jo(t[0]*Rp,t[1]*Rp);a.imageSmoothingEnabled=!1;for(var h=a.canvas,l=new vp(a,Rp,o,null,s),u=i.length,c=Math.floor(16777215/u),p={},d=1;d<=u;++d){var f=i[d-1],g=f.getStyleFunction()||n;if(n){var _=g(f,r);if(_){Array.isArray(_)||(_=[_]);for(var m="#"+("000000"+(d*c).toString(16)).slice(-6),y=0,v=_.length;y<v;++y){var x=_[y],w=x.getGeometryFunction()(f);if(w&&$e(o,w.getExtent())){var b=x.clone(),C=b.getFill();C&&C.setColor(m);var M=b.getStroke();M&&(M.setColor(m),M.setLineDash(null)),b.setText(void 0);var S=x.getImage();if(S&&0!==S.getOpacity()){var T=S.getImageSize();if(!T)continue;var P=jo(T[0],T[1],void 0,{alpha:!1}),E=P.canvas;P.fillStyle=m,P.fillRect(0,0,E.width,E.height),b.setImage(new Lp({img:E,imgSize:T,anchor:S.getAnchor(),anchorXUnits:wp,anchorYUnits:wp,offset:S.getOrigin(),opacity:1,size:S.getSize(),scale:S.getScale(),rotation:S.getRotation(),rotateWithView:S.getRotateWithView()}))}var A=b.getZIndex()||0;(O=p[A])||(p[A]=O={},O.Polygon=[],O.Circle=[],O.LineString=[],O.Point=[]),O[w.getType().replace("Multi","")].push(w,b)}}}}}for(var L=Object.keys(p).map(Number).sort(ht),R=(d=0,L.length);d<R;++d){var O=p[L[d]];for(var Z in O){var I=O[Z];for(y=0,v=I.length;y<v;y+=2){l.setStyle(I[y+1]);for(var k=0,N=e.length;k<N;++k)l.setTransform(e[k]),l.drawGeometry(I[y])}}}return a.getImageData(0,0,h.width,h.height)}(i,l,this.renderedFeatures_,h.getStyleFunction(),a,o,r)}e(function(t,e,i){var n=[];if(i){var o=Math.floor(Math.round(t[0])*Rp),r=Math.floor(Math.round(t[1])*Rp),s=4*(Yt(o,0,i.width-1)+Yt(r,0,i.height-1)*i.width),a=i.data[s+2]+256*(i.data[s+1]+256*i.data[s]),h=Math.floor(16777215/e.length);a&&a%h==0&&n.push(e[a/h-1])}return n}(t,this.renderedFeatures_,this.hitDetectionImageData_))}).bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){var r=this;if(this.replayGroup_){var s,a=e.viewState.resolution,h=e.viewState.rotation,l=this.getLayer(),u={},c=function(t,e,i){var r=Ft(t),s=u[r];if(s){if(!0!==s&&i<s.distanceSq){if(0===i)return u[r]=!0,o.splice(o.lastIndexOf(s),1),n(t,l,e);s.geometry=e,s.distanceSq=i}}else{if(0===i)return u[r]=!0,n(t,l,e);o.push(u[r]={feature:t,layer:l,geometry:e,distanceSq:i,callback:n})}},p=[this.replayGroup_];return this.declutterExecutorGroup&&p.push(this.declutterExecutorGroup),p.some(function(n){return s=n.forEachFeatureAtCoordinate(t,a,h,i,c,n===r.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(function(t){return t.value}):null)}),s}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var e=this.getLayer(),i=e.getSource();if(!i)return!1;var n=t.viewHints[0],o=t.viewHints[1],r=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(this.ready&&!r&&n||!s&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var a=t.extent,h=t.viewState,l=h.projection,u=h.resolution,c=t.pixelRatio,p=e.getRevision(),d=e.getRenderBuffer(),f=e.getRenderOrder();void 0===f&&(f=Zp);var g=h.center.slice(),_=Me(a,d*u),m=_.slice(),y=[_.slice()],v=l.getExtent();if(i.getWrapX()&&l.canWrapX()&&!Ee(v,t.extent)){var x=Qe(v),w=Math.max(Qe(_)/2,x);_[0]=v[0]-w,_[2]=v[2]+w,ai(g,l);var b=ei(y[0],l);b[0]<v[0]&&b[2]<v[2]?y.push([b[0]+x,b[1],b[2]+x,b[3]]):b[0]>v[0]&&b[2]>v[2]&&y.push([b[0]-x,b[1],b[2]-x,b[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==p&&this.renderedRenderOrder_==f&&Ee(this.wrappedRenderedExtent_,_))return pt(this.renderedExtent_,m)||(this.hitDetectionImageData_=null,this.renderedExtent_=m),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null;var C,M=new ip(Ip(u,c),_,u,c);this.getLayer().getDeclutter()&&(C=new ip(Ip(u,c),_,u,c));var S,T,P;for(T=0,P=y.length;T<P;++T)i.loadFeatures(y[T],u,l);var E=function(t,e){var i=Ip(t,e);return i*i}(u,c),A=!0,L=(function(t){var i,n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,u)),i){var o=this.renderFeature(t,E,i,M,S,C);A=A&&!o}}).bind(this),R=Ai(_),O=i.getFeaturesInExtent(R);for(f&&O.sort(f),T=0,P=O.length;T<P;++T)L(O[T]);this.renderedFeatures_=O,this.ready=A;var Z=M.finish(),I=new mp(_,u,c,i.getOverlaps(),Z,e.getRenderBuffer());return C&&(this.declutterExecutorGroup=new mp(_,u,c,i.getOverlaps(),C.finish(),e.getRenderBuffer())),this.renderedResolution_=u,this.renderedRevision_=p,this.renderedRenderOrder_=f,this.renderedExtent_=m,this.wrappedRenderedExtent_=_,this.renderedCenter_=g,this.renderedProjection_=l,this.replayGroup_=I,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,n,o,r){if(!i)return!1;var s=!1;if(Array.isArray(i))for(var a=0,h=i.length;a<h;++a)s=kp(n,t,i[a],e,this.boundHandleStyleImageChange_,o,r)||s;else s=kp(n,t,i,e,this.boundHandleStyleImageChange_,o,r);return s},e}(Xl);var qp=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const zp=function(t){function e(e){return t.call(this,e)||this}return qp(e,t),e.prototype.createRenderer=function(){return new Dp(this)},e}(Nc),jp=function(){function t(t){this.rbush_=new vc(t),this.items_={}}return t.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Ft(e)]=i},t.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,o=e.length;n<o;n++){var r=t[n],s=e[n],a={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:s};i[n]=a,this.items_[Ft(s)]=a}this.rbush_.load(i)},t.prototype.remove=function(t){var e=Ft(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},t.prototype.update=function(t,e){var i=this.items_[Ft(e)];ke([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},t.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},t.prototype.getInExtent=function(t){return this.rbush_.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}).map(function(t){return t.value})},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},t.prototype.forEach_=function(t,e){for(var i,n=0,o=t.length;n<o;n++)if(i=e(t[n]))return i;return i},t.prototype.isEmpty=function(){return vt(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return Re(e.minX,e.minY,e.maxX,e.maxY,t)},t.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},t}(),Gp="addfeature",Up="removefeature";function Bp(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Wp(t,e){return function(i,n,o,r,s){var a=this;!function(t,e,i,n,o,r,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(i,n,o):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=!1,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var n=e.getType(),h=void 0;"json"==n||"text"==n?h=a.responseText:"xml"==n?(h=a.responseXML)||(h=(new DOMParser).parseFromString(a.responseText,"application/xml")):"arraybuffer"==n&&(h=a.response),h?r(e.readFeatures(h,{extent:i,featureProjection:o}),e.readProjection(h)):s()}else s()},a.onerror=s,a.send()}(t,e,i,n,o,function(t,e){a.addFeatures(t),void 0!==r&&r(t)},s||gt)}}var Yp=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vp=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.feature=i,o.features=n,o}return Yp(e,t),e}(rt);const Xp=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{attributions:n.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===n.wrapX||n.wrapX})||this).loader_=gt,i.format_=n.format,i.overlaps_=void 0===n.overlaps||n.overlaps,i.url_=n.url,void 0!==n.loader?i.loader_=n.loader:void 0!==i.url_&&(be(i.format_,7),i.loader_=Wp(i.url_,i.format_)),i.strategy_=void 0!==n.strategy?n.strategy:Bp;var o,r,s=void 0===n.useSpatialIndex||n.useSpatialIndex;return i.featuresRtree_=s?new jp:null,i.loadedExtentsRtree_=new jp,i.loadingExtentsCount_=0,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(n.features)?r=n.features:n.features&&(r=(o=n.features).getArray()),s||void 0!==o||(o=new mr(r)),void 0!==r&&i.addFeaturesInternal(r),void 0!==o&&i.bindFeaturesCollection_(o),i}return Yp(e,t),e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=Ft(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Vp(Gp,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Lt(e,Ct,this.handleFeatureChange_,this),Lt(e,st,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&(be(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],o=0,r=t.length;o<r;o++){var s=Ft(h=t[o]);this.addToIndex_(s,h)&&i.push(h)}o=0;for(var a=i.length;o<a;o++){var h;s=Ft(h=i[o]),this.setupChangeEvents_(s,h);var l=h.getGeometry();if(l){var u=l.getExtent();e.push(u),n.push(h)}else this.nullGeometryFeatures_[s]=h}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(Gp)){o=0;for(var c=i.length;o<c;o++)this.dispatchEvent(new Vp(Gp,i[o]))}},e.prototype.bindFeaturesCollection_=function(t){var e=!1;this.addEventListener(Gp,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(Up,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(pr,(function(t){e||(e=!0,this.addFeature(t.element),e=!1)}).bind(this)),t.addEventListener(dr,(function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}).bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach(Ot);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var i=(function(t){this.removeFeatureInternal(t)}).bind(this);for(var n in this.featuresRtree_.forEach(i),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var o=new Vp("clear");this.dispatchEvent(o),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){return this.forEachFeatureInExtent([t[0],t[1],t[0],t[1]],function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0})},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),vt(this.nullGeometryFeatures_)||ct(t,yt(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},e.prototype.getFeaturesInExtent=function(t,e){var i=this;if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);var n=function(t,e){if(e.canWrapX()){var i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];ei(t,e);var n=Qe(i);if(Qe(t)>n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+n,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-n,t[3]]]}return[t]}(t,e);return[].concat.apply([],n.map(function(t){return i.featuresRtree_.getInExtent(t)}))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],o=null,r=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],h=e||dt;return this.featuresRtree_.forEachInExtent(a,function(t){if(h(t)){var e=t.getGeometry(),l=s;if((s=e.closestPointXY(i,n,r,s))<l){o=t;var u=Math.sqrt(s);a[0]=i-u,a[1]=n-u,a[2]=i+u,a[3]=n+u}}}),o},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=Ft(e),n=e.getGeometry();if(n){var o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var r=e.getId();if(void 0!==r){var s=r.toString();this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Vp("changefeature",e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Ft(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&vt(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()},e.prototype.loadFeatures=function(t,e,i){for(var n=this.loadedExtentsRtree_,o=this.strategy_(t,e,i),r=function(t,r){var a=o[t];n.forEachInExtent(a,function(t){return Ee(t.extent,a)})||(++s.loadingExtentsCount_,s.dispatchEvent(new Vp("featuresloadstart")),s.loader_.call(s,a,e,i,(function(t){--this.loadingExtentsCount_,this.dispatchEvent(new Vp("featuresloadend",void 0,t))}).bind(s),(function(){--this.loadingExtentsCount_,this.dispatchEvent(new Vp("featuresloaderror"))}).bind(s)),n.insert(a,{extent:a.slice()}))},s=this,a=0,h=o.length;a<h;++a)r(a);this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,function(i){if(ke(i.extent,t))return e=i,!0}),e&&i.remove(e)},e.prototype.removeFeature=function(t){if(t){var e=Ft(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}},e.prototype.removeFeatureInternal=function(t){var e=Ft(t),i=this.featureChangeKeys_[e];if(i){i.forEach(Ot),delete this.featureChangeKeys_[e];var n=t.getId();return void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Vp(Up,t)),t}},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){be(this.format_,7),this.url_=t,this.setLoader(Wp(t,this.format_))},e}(Au);var Hp=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Kp="Point",Jp="LineString",Qp="Polygon",$p="Circle",td="drawstart",ed=function(t){function e(e,i){var n=t.call(this,e)||this;return n.feature=i,n}return Hp(e,t),e}(rt);const id=function(t){function e(e){var i=this,n=e;n.stopDown||(n.stopDown=ft),(i=t.call(this,n)||this).shouldHandle_=!1,i.downPx_=null,i.freehand_=!1,i.source_=e.source?e.source:null,i.features_=e.features?e.features:null,i.snapTolerance_=e.snapTolerance?e.snapTolerance:12,i.type_=e.type,i.mode_=function(t){switch(t){case"Point":case"MultiPoint":return Kp;case"LineString":case"MultiLineString":return Jp;case"Polygon":case"MultiPolygon":return Qp;case"Circle":return $p;default:throw new Error("Invalid type: "+t)}}(i.type_),i.stopClick_=!!e.stopClick,i.minPoints_=e.minPoints?e.minPoints:i.mode_===Qp?3:2,i.maxPoints_=i.mode_===$p?2:e.maxPoints?e.maxPoints:1/0,i.finishCondition_=e.finishCondition?e.finishCondition:dt,i.geometryLayout_=e.geometryLayout?e.geometryLayout:Ui;var o,r=e.geometryFunction;if(!r){var s,a=i.mode_;a===$p?r=function(t,e,i){var n=e||new rc([NaN,NaN]),o=Ei(t[0]),r=ri(o,Ei(t[t.length-1]));n.setCenterAndRadius(o,Math.sqrt(r),this.geometryLayout_);return n}:(a===Kp?s=Nn:a===Jp?s=pc:a===Qp&&(s=Qn),r=function(t,e,i){return e?e.setCoordinates(a===Qp?t[0].length?[t[0].concat([t[0][0]])]:[]:t,this.geometryLayout_):e=new s(t,this.geometryLayout_),e})}return i.geometryFunction_=r,i.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,i.overlay_=new zp({source:new Xp({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:(o=Rc(),function(t,e){return o[t.getGeometry().getType()]}),updateWhileInteracting:!0}),i.geometryName_=e.geometryName,i.condition_=e.condition?e.condition:ys,i.freehandCondition_=e.freehand?_s:e.freehandCondition?e.freehandCondition:vs,i.addChangeListener(os,i.updateState_),i}return Hp(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===Mt&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!==Kp&&this.freehandCondition_(e);var i=e.type===Tr.POINTERMOVE,n=!0;return!this.freehand_&&this.lastDragTime_&&e.type===Tr.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===Tr.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),n=!1):this.freehand_&&e.type===Tr.POINTERDOWN?n=!1:i&&this.getPointerCount()<2?(n=e.type===Tr.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===Tr.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===Tr.DBLCLICK&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout((function(){this.handlePointerMove_(new Sr(Tr.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}).bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)},e.prototype.handleUpEvent=function(t){var e=!0;if(0===this.getPointerCount())if(this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t),this.shouldHandle_){var i=!this.finishCoordinate_;i&&this.startDrawing_(t.coordinate),!i&&this.freehand_?this.finishDrawing():this.freehand_||i&&this.mode_!==Kp||(this.atFinish_(t.pixel)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing();return!e&&this.stopClick_&&t.preventDefault(),e},e.prototype.handlePointerMove_=function(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,n=e[0]-i[0],o=e[1]-i[1],r=n*n+o*o;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?this.modifyDrawing_(t.coordinate):this.createOrUpdateSketchPoint_(t.coordinate.slice())},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,n=[this.finishCoordinate_],o=this.mode_;if(o===Kp)e=!0;else if(o===$p)e=2===this.sketchCoords_.length;else if(o===Jp)i=this.sketchCoords_.length>this.minPoints_;else if(o===Qp){var r=this.sketchCoords_;i=r[0].length>this.minPoints_,n=[r[0][0],r[0][r[0].length-2]]}if(i)for(var s=this.getMap(),a=0,h=n.length;a<h;a++){var l=n[a],u=s.getPixelFromCoordinate(l),c=t[0]-u[0],p=t[1]-u[1],d=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(c*c+p*p)<=d){this.finishCoordinate_=l;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new ac(new Nn(t)),this.updateSketchFeatures_())},e.prototype.createOrUpdateCustomSketchLine_=function(t){this.sketchLine_||(this.sketchLine_=new ac);var e=t.getLinearRing(0),i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new pc(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))},e.prototype.startDrawing_=function(t){for(var e=this.getMap().getView().getProjection(),i=fn(this.geometryLayout_);t.length<i;)t.push(0);this.finishCoordinate_=t,this.mode_===Kp?this.sketchCoords_=t.slice():this.mode_===Qp?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ac(new pc(this.sketchLineCoords_)));var n=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new ac,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new ed(td,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){for(var e,i,n=this.getMap(),o=this.sketchFeature_.getGeometry(),r=n.getView().getProjection(),s=fn(this.geometryLayout_);t.length<s;)t.push(0);this.mode_===Kp?i=this.sketchCoords_:this.mode_===Qp?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(n.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=t[0],i[1]=t[1],this.geometryFunction_(this.sketchCoords_,o,r),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),"Polygon"===o.getType()&&this.mode_!==Qp?this.createOrUpdateCustomSketchLine_(o):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,n=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection(),r=this.mode_;r===Jp||r===$p?(this.finishCoordinate_=t.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),this.geometryFunction_(i,n,o)):r===Qp&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,n,o)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),n=this.mode_;if(n===Jp||n===$p){if((t=this.sketchCoords_).splice(-2,1),t.length>=2){this.finishCoordinate_=t[t.length-2].slice();var o=this.finishCoordinate_.slice();t[t.length-1]=o,this.createOrUpdateSketchPoint_(o)}this.geometryFunction_(t,e,i),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(n===Qp){(t=this.sketchCoords_[0]).splice(-2,1);var r=this.sketchLine_.getGeometry();t.length>=2&&(o=t[t.length-2].slice(),t[t.length-1]=o,this.createOrUpdateSketchPoint_(o)),r.setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,i)}1===t.length&&this.abortDrawing(),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry(),n=this.getMap().getView().getProjection();this.mode_===Jp?(e.pop(),this.geometryFunction_(e,i,n)):this.mode_===Qp&&(e[0].pop(),this.geometryFunction_(e,i,n),e=i.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new _c([e])):"MultiLineString"===this.type_?t.setGeometry(new fc([e])):"MultiPolygon"===this.type_&&t.setGeometry(new yc([e])),this.dispatchEvent(new ed("drawend",t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),t},e.prototype.abortDrawing=function(){var t=this.abortDrawing_();t&&this.dispatchEvent(new ed("drawabort",t))},e.prototype.appendCoordinates=function(t){var e,i=this.mode_,n=!this.sketchFeature_;if(n&&this.startDrawing_(t[0]),i===Jp||i===$p)e=this.sketchCoords_;else{if(i!==Qp)return;e=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}n&&e.shift(),e.pop();for(var o=0;o<t.length;o++)this.addToDrawing_(t[o]);var r=t[t.length-1];this.addToDrawing_(r),this.modifyDrawing_(r)},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new ac(new Nn(i)),this.updateSketchFeatures_(),this.dispatchEvent(new ed(td,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)},e}(ps);var nd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),od=[0,0,0,0],rd=[],sd="modifyend",ad=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.features=i,o.mapBrowserEvent=n,o}return nd(e,t),e}(rt);function hd(t,e){return t.index-e.index}function ld(t,e,i){var n=e.geometry;if("Circle"===n.getType()){var o=n;if(1===e.index){var r=ri(o.getCenter(),Ei(t)),s=Math.sqrt(r)-o.getRadius();return s*s}}var a=Ei(t);return rd[0]=Ei(e.segment[0]),rd[1]=Ei(e.segment[1]),function(t,e){return ri(t,ii(t,e))}(a,rd)}function ud(t,e,i){var n=e.geometry;if("Circle"===n.getType()&&1===e.index){var o=n;return Pi(o.getClosestPoint(Ei(t)))}var r=Ei(t);return rd[0]=Ei(e.segment[0]),rd[1]=Ei(e.segment[1]),Pi(ii(r,rd))}const cd=function(t){function e(e){var i,n,o=t.call(this,e)||this;if(o.boundHandleFeatureChange_=o.handleFeatureChange_.bind(o),o.condition_=e.condition?e.condition:bs,o.defaultDeleteCondition_=function(t){return function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}(t)&&function(t){return t.type==Tr.SINGLECLICK}(t)},o.deleteCondition_=e.deleteCondition?e.deleteCondition:o.defaultDeleteCondition_,o.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:_s,o.vertexFeature_=null,o.vertexSegments_=null,o.lastPixel_=[0,0],o.ignoreNextSingleClick_=!1,o.featuresBeingModified_=null,o.rBush_=new jp,o.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,o.snappedToVertex_=!1,o.changingFeature_=!1,o.dragSegments_=[],o.overlay_=new zp({source:new Xp({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:(i=Rc(),function(t,e){return i.Point}),updateWhileAnimating:!0,updateWhileInteracting:!0}),o.SEGMENT_WRITERS_={Point:o.writePointGeometry_.bind(o),LineString:o.writeLineStringGeometry_.bind(o),LinearRing:o.writeLineStringGeometry_.bind(o),Polygon:o.writePolygonGeometry_.bind(o),MultiPoint:o.writeMultiPointGeometry_.bind(o),MultiLineString:o.writeMultiLineStringGeometry_.bind(o),MultiPolygon:o.writeMultiPolygonGeometry_.bind(o),Circle:o.writeCircleGeometry_.bind(o),GeometryCollection:o.writeGeometryCollectionGeometry_.bind(o)},o.source_=null,o.hitDetection_=null,e.features?n=e.features:e.source&&(o.source_=e.source,n=new mr(o.source_.getFeatures()),o.source_.addEventListener(Gp,o.handleSourceAdd_.bind(o)),o.source_.addEventListener(Up,o.handleSourceRemove_.bind(o))),!n)throw new Error("The modify interaction requires features, a source or a layer");return e.hitDetection&&(o.hitDetection_=e.hitDetection),o.features_=n,o.features_.forEach(o.addFeature_.bind(o)),o.features_.addEventListener(pr,o.handleFeatureAdd_.bind(o)),o.features_.addEventListener(dr,o.handleFeatureRemove_.bind(o)),o.lastPointerEvent_=null,o.delta_=[0,0],o.snapToPointer_=void 0===e.snapToPointer?!o.hitDetection_:e.snapToPointer,o}return nd(e,t),e.prototype.addFeature_=function(t){var e=t.getGeometry();if(e){var i=this.SEGMENT_WRITERS_[e.getType()];i&&i(t,e)}var n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),t.addEventListener(Ct,this.boundHandleFeatureChange_)},e.prototype.willModifyFeatures_=function(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new mr;for(var i=this.featuresBeingModified_.getArray(),n=0,o=e.length;n<o;++n)for(var r=e[n],s=0,a=r.length;s<a;++s){var h=r[s].feature;h&&-1===i.indexOf(h)&&this.featuresBeingModified_.push(h)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new ad("modifystart",this.featuresBeingModified_,t))}},e.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(Ct,this.boundHandleFeatureChange_)},e.prototype.removeFeatureSegmentData_=function(t){var e=this.rBush_,i=[];e.forEach(function(e){t===e.feature&&i.push(e)});for(var n=i.length-1;n>=0;--n){for(var o=i[n],r=this.dragSegments_.length-1;r>=0;--r)this.dragSegments_[r][0]===o&&this.dragSegments_.splice(r,1);e.remove(o)}},e.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.overlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},e.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},e.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},e.prototype.handleFeatureChange_=function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}},e.prototype.handleFeatureRemove_=function(t){this.removeFeature_(t.element)},e.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)},e.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n){var r=i[n],s={feature:t,geometry:e,depth:[n],index:n,segment:[r,r]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length-1;n<o;++n){var r=i.slice(n,n+2),s={feature:t,geometry:e,index:n,segment:r};this.rBush_.insert(Ce(r),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n)for(var r=i[n],s=0,a=r.length-1;s<a;++s){var h=r.slice(s,s+2),l={feature:t,geometry:e,depth:[n],index:s,segment:h};this.rBush_.insert(Ce(h),l)}},e.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n)for(var r=i[n],s=0,a=r.length-1;s<a;++s){var h=r.slice(s,s+2),l={feature:t,geometry:e,depth:[n],index:s,segment:h};this.rBush_.insert(Ce(h),l)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n)for(var r=i[n],s=0,a=r.length;s<a;++s)for(var h=r[s],l=0,u=h.length-1;l<u;++l){var c=h.slice(l,l+2),p={feature:t,geometry:e,depth:[s,n],index:l,segment:c};this.rBush_.insert(Ce(c),p)}},e.prototype.writeCircleGeometry_=function(t,e){var i=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[i,i]},o={feature:t,geometry:e,index:1,segment:[i,i]},r=[n,o];n.featureSegments=r,o.featureSegments=r,this.rBush_.insert(Ze(i),n);var s=e;this.rBush_.insert(s.getExtent(),o)},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),n=0;n<i.length;++n){var o=i[n];(0,this.SEGMENT_WRITERS_[o.getType()])(t,o)}},e.prototype.createOrUpdateVertexFeature_=function(t,e,i){var n=this.vertexFeature_;return n?n.getGeometry().setCoordinates(t):(n=new ac(new Nn(t)),this.vertexFeature_=n,this.overlay_.getSource().addFeature(n)),n.set("features",e),n.set("geometries",i),n},e.prototype.handleEvent=function(e){return!e.originalEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=Tr.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(i=!(e.type!=Tr.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==Tr.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),t.prototype.handleEvent.call(this,e)&&!i);var i},e.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_);for(var e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],i=[],n=[],o=0,r=this.dragSegments_.length;o<r;++o){var s=this.dragSegments_[o],a=s[0],h=a.feature;-1===i.indexOf(h)&&i.push(h);var l=a.geometry;-1===n.indexOf(l)&&n.push(l);for(var u=a.depth,c=void 0,p=a.segment,d=s[1];e.length<l.getStride();)e.push(p[d][e.length]);switch(l.getType()){case"Point":c=e,p[0]=e,p[1]=e;break;case"MultiPoint":(c=l.getCoordinates())[a.index]=e,p[0]=e,p[1]=e;break;case"LineString":(c=l.getCoordinates())[a.index+d]=e,p[d]=e;break;case"MultiLineString":case"Polygon":(c=l.getCoordinates())[u[0]][a.index+d]=e,p[d]=e;break;case"MultiPolygon":(c=l.getCoordinates())[u[1]][u[0]][a.index+d]=e,p[d]=e;break;case"Circle":if(p[0]=e,p[1]=e,0===a.index)this.changingFeature_=!0,l.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0;t.map.getView().getProjection();var f=si(Ei(l.getCenter()),Ei(e));l.setRadius(f),this.changingFeature_=!1}}c&&this.setGeometryCoordinates_(l,c)}this.createOrUpdateVertexFeature_(e,i,n)},e.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;var e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.featuresBeingModified_=null;var i=this.vertexFeature_;if(i){t.map.getView().getProjection();var n=[],o=i.getGeometry().getCoordinates(),r=Ce([o]),s=this.rBush_.getInExtent(r),a={};s.sort(hd);for(var h=0,l=s.length;h<l;++h){var u=s[h],c=u.segment,p=Ft(u.geometry),d=u.depth;if(d&&(p+="-"+d.join("-")),a[p]||(a[p]=new Array(2)),"Circle"!==u.geometry.getType()||1!==u.index)if(!ni(c[0],o)||a[p][0])if(!ni(c[1],o)||a[p][1])Ft(c)in this.vertexSegments_&&!a[p][0]&&!a[p][1]&&this.insertVertexCondition_(t)&&n.push(u);else{if(a[p][0]&&0===a[p][0].index){var f=u.geometry.getCoordinates();switch(u.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":f=f[d[1]];case"Polygon":if(u.index!==f[d[0]].length-2)continue}}this.dragSegments_.push([u,1]),a[p][1]=u}else this.dragSegments_.push([u,0]),a[p][0]=u;else ni(ud(e,u),o)&&!a[p][0]&&(this.dragSegments_.push([u,0]),a[p][0]=u)}n.length&&this.willModifyFeatures_(t,[n]);for(var g=n.length-1;g>=0;--g)this.insertVertex_(n[g],o)}return!!this.vertexFeature_},e.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var i=this.dragSegments_[e][0],n=i.geometry;if("Circle"===n.getType()){var o=n.getCenter(),r=i.featureSegments[0],s=i.featureSegments[1];r.segment[0]=o,r.segment[1]=o,s.segment[0]=o,s.segment[1]=o,this.rBush_.update(Ze(o),r);var a=n;this.rBush_.update(a.getExtent(),s)}else this.rBush_.update(Ce(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new ad(sd,this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1},e.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)},e.prototype.handlePointerAtPixel_=function(t,e,i){var n,o,r=this,s=i||e.getCoordinateFromPixel(t);e.getView().getProjection();if(this.hitDetection_&&e.forEachFeatureAtPixel(t,function(t,e,i){if("Point"===(i=i||t.getGeometry()).getType()&&r.features_.getArray().indexOf(t)>=0){o=i;var s=i.getFlatCoordinates().slice(0,2);n=[{feature:t,geometry:i,segment:[s,s]}]}return!0},{layerFilter:"object"==typeof this.hitDetection_?function(t){return t===r.hitDetection_}:void 0}),!n){var a=Ai(Me(Li(Ze(s,od)),e.getView().getResolution()*this.pixelTolerance_,od));n=this.rBush_.getInExtent(a)}if(n&&n.length>0){var h=n.sort(function(t,e){return ld(s,t)-ld(s,e)})[0],l=h.segment,u=ud(s,h),c=e.getPixelFromCoordinate(u),p=si(t,c);if(o||p<=this.pixelTolerance_){var d={};if(d[Ft(l)]=!0,this.snapToPointer_||(this.delta_[0]=u[0]-s[0],this.delta_[1]=u[1]-s[1]),"Circle"===h.geometry.getType()&&1===h.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u,[h.feature],[h.geometry]);else{var f=e.getPixelFromCoordinate(l[0]),g=e.getPixelFromCoordinate(l[1]),_=ri(c,f),m=ri(c,g);p=Math.sqrt(Math.min(_,m)),this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(u=_>m?l[1]:l[0]),this.createOrUpdateVertexFeature_(u,[h.feature],[h.geometry]);var y={};y[Ft(h.geometry)]=!0;for(var v=1,x=n.length;v<x;++v){var w=n[v].segment;if(!(ni(l[0],w[0])&&ni(l[1],w[1])||ni(l[0],w[1])&&ni(l[1],w[0])))break;var b=Ft(n[v].geometry);b in y||(y[b]=!0,d[Ft(w)]=!0)}}return void(this.vertexSegments_=d)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},e.prototype.insertVertex_=function(t,e){for(var i,n=t.segment,o=t.feature,r=t.geometry,s=t.depth,a=t.index;e.length<r.getStride();)e.push(0);switch(r.getType()){case"MultiLineString":case"Polygon":(i=r.getCoordinates())[s[0]].splice(a+1,0,e);break;case"MultiPolygon":(i=r.getCoordinates())[s[1]][s[0]].splice(a+1,0,e);break;case"LineString":(i=r.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(r,i);var h=this.rBush_;h.remove(t),this.updateSegmentIndices_(r,a,s,1);var l={segment:[n[0],e],feature:o,geometry:r,depth:s,index:a};h.insert(Ce(l.segment),l),this.dragSegments_.push([l,1]);var u={segment:[e,n[1]],feature:o,geometry:r,depth:s,index:a+1};h.insert(Ce(u.segment),u),this.dragSegments_.push([u,0]),this.ignoreNextSingleClick_=!0},e.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Tr.POINTERDRAG){var t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_);var e=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new ad(sd,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,e}return!1},e.prototype.removeVertex_=function(){var t,e,i,n,o,r,s,a,h,l,u,c=this.dragSegments_,p={},d=!1;for(o=c.length-1;o>=0;--o)u=Ft((l=(i=c[o])[0]).feature),l.depth&&(u+="-"+l.depth.join("-")),u in p||(p[u]={}),0===i[1]?(p[u].right=l,p[u].index=l.index):1==i[1]&&(p[u].left=l,p[u].index=l.index+1);for(u in p){switch(h=p[u].right,(a=(r=p[u].index)-1)<0&&(a=0),t=e=(n=(l=void 0!==(s=p[u].left)?s:h).geometry).getCoordinates(),d=!1,n.getType()){case"MultiLineString":e[l.depth[0]].length>2&&(e[l.depth[0]].splice(r,1),d=!0);break;case"LineString":e.length>2&&(e.splice(r,1),d=!0);break;case"MultiPolygon":t=t[l.depth[1]];case"Polygon":(t=t[l.depth[0]]).length>4&&(r==t.length-1&&(r=0),t.splice(r,1),d=!0,0===r&&(t.pop(),t.push(t[0]),a=t.length-1))}if(d){this.setGeometryCoordinates_(n,e);var f=[];if(void 0!==s&&(this.rBush_.remove(s),f.push(s.segment[0])),void 0!==h&&(this.rBush_.remove(h),f.push(h.segment[1])),void 0!==s&&void 0!==h){var g={depth:l.depth,feature:l.feature,geometry:l.geometry,index:a,segment:f};this.rBush_.insert(Ce(g.segment),g)}this.updateSegmentIndices_(n,r,l.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return d},e.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},e.prototype.updateSegmentIndices_=function(t,e,i,n){this.rBush_.forEachInExtent(t.getExtent(),function(o){o.geometry===t&&(void 0===i||void 0===o.depth||pt(o.depth,i))&&o.index>e&&(o.index+=n)})},e}(ps);var pd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function dd(t){for(var e=[],i=0,n=t.length;i<n;++i)e.push(t[i].clone());return e}const fd=function(t){function e(e){var i=t.call(this)||this;return i.geometries_=e||null,i.changeEventsKeys_=[],i.listenGeometriesChange_(),i}return pd(e,t),e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(Ot),this.changeEventsKeys_.length=0},e.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(Lt(this.geometries_[t],Ct,this.changed,this))},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,n){if(n<Te(this.getExtent(),t,e))return n;for(var o=this.geometries_,r=0,s=o.length;r<s;++r)n=o[r].closestPointXY(t,e,i,n);return n},e.prototype.containsXY=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)if(i[n].containsXY(t,e))return!0;return!1},e.prototype.computeExtent=function(t){Oe(t);for(var e=this.geometries_,i=0,n=e.length;i<n;++i)Ne(t,e[i].getExtent());return t},e.prototype.getGeometries=function(){return dd(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getGeometriesArrayRecursive=function(){for(var t=[],e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var i=[],n=this.geometries_,o=!1,r=0,s=n.length;r<s;++r){var a=n[r],h=a.getSimplifiedGeometry(t);i.push(h),h!==a&&(o=!0)}if(o){var l=new e(null);return l.setGeometriesArray(i),l}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return"GeometryCollection"},e.prototype.intersectsExtent=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return 0===this.geometries_.length},e.prototype.rotate=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)i[n].rotate(t,e);this.changed()},e.prototype.scale=function(t,e,i){var n=i;n||(n=Be(this.getExtent()));for(var o=this.geometries_,r=0,s=o.length;r<s;++r)o[r].scale(t,e,n);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(dd(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()},e.prototype.translate=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)i[n].translate(t,e);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),t.prototype.disposeInternal.call(this)},e}(pn),gd=function(){function t(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return t.prototype.getReadOptions=function(t,e){var i;if(e){var n=e.dataProjection?fi(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()===Ut.TILE_PIXELS&&(n=fi(n)).setWorldExtent(e.extent),i={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(i)},t.prototype.adaptOptions=function(t){return _t({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return kt()},t.prototype.readFeature=function(t,e){return kt()},t.prototype.readFeatures=function(t,e){return kt()},t.prototype.readGeometry=function(t,e){return kt()},t.prototype.readProjection=function(t){return kt()},t.prototype.writeFeature=function(t,e){return kt()},t.prototype.writeFeatures=function(t,e){return kt()},t.prototype.writeGeometry=function(t,e){return kt()},t}();function _d(t,e,i){var n,o=i?fi(i.featureProjection):null,r=i?fi(i.dataProjection):null;if(n=o&&r&&!vi(o,r)?(e?t.clone():t).transform(e?o:r,e?r:o):t,e&&i&&void 0!==i.decimals){var s=Math.pow(10,i.decimals);n===t&&(n=t.clone()),n.applyTransform(function(t){for(var e=0,i=t.length;e<i;++e)t[e]=Math.round(t[e]*s)/s;return t})}return n}function md(t,e){var i=e?fi(e.featureProjection):null,n=e?fi(e.dataProjection):null;return i&&n&&!vi(i,n)?Ci(t,n,i):t}var yd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function vd(t){return"string"==typeof t?JSON.parse(t)||null:null!==t?t:null}const xd=function(t){function e(){return t.call(this)||this}return yd(e,t),e.prototype.getType=function(){return"json"},e.prototype.readFeature=function(t,e){return this.readFeatureFromObject(vd(t),this.getReadOptions(t,e))},e.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(vd(t),this.getReadOptions(t,e))},e.prototype.readFeatureFromObject=function(t,e){return kt()},e.prototype.readFeaturesFromObject=function(t,e){return kt()},e.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(vd(t),this.getReadOptions(t,e))},e.prototype.readGeometryFromObject=function(t,e){return kt()},e.prototype.readProjection=function(t){return this.readProjectionFromObject(vd(t))},e.prototype.readProjectionFromObject=function(t){return kt()},e.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},e.prototype.writeFeatureObject=function(t,e){return kt()},e.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},e.prototype.writeFeaturesObject=function(t,e){return kt()},e.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},e.prototype.writeGeometryObject=function(t,e){return kt()},e}(gd);var wd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function bd(t,e){if(!t)return null;var i;switch(t.type){case"Point":i=function(t){return new Nn(t.coordinates)}(t);break;case"LineString":i=function(t){return new pc(t.coordinates)}(t);break;case"Polygon":i=function(t){return new Qn(t.coordinates)}(t);break;case"MultiPoint":i=function(t){return new _c(t.coordinates)}(t);break;case"MultiLineString":i=function(t){return new fc(t.coordinates)}(t);break;case"MultiPolygon":i=function(t){return new yc(t.coordinates)}(t);break;case"GeometryCollection":i=function(t,e){var i=t.geometries.map(function(t){return bd(t,void 0)});return new fd(i)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return _d(i,!1,e)}function Cd(t,e){var i,n=(t=_d(t,!0,e)).getType();switch(n){case"Point":i=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":i=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":i=function(t,e){var i;return e&&(i=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"MultiPoint":i=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":i=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":i=function(t,e){var i;return e&&(i=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"GeometryCollection":i=function(t,e){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(t){var i=_t({},e);return delete i.featureProjection,Cd(t,i)})}}(t,e);break;case"Circle":i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return i}const Md=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this)||this).dataProjection=fi(n.dataProjection?n.dataProjection:"EPSG:4326"),n.featureProjection&&(i.defaultFeatureProjection=fi(n.featureProjection)),i.geometryName_=n.geometryName,i.extractGeometryName_=n.extractGeometryName,i.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],i}return wd(e,t),e.prototype.readFeatureFromObject=function(t,e){var i,n=bd((i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),o=new ac;return this.geometryName_?o.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&o.setGeometryName(i.geometry_name),o.setGeometry(n),"id"in i&&o.setId(i.id),i.properties&&o.setProperties(i.properties,!0),o},e.prototype.readFeaturesFromObject=function(t,e){var i=null;if("FeatureCollection"===t.type){i=[];for(var n=t.features,o=0,r=n.length;o<r;++o)i.push(this.readFeatureFromObject(n[o],e))}else i=[this.readFeatureFromObject(t,e)];return i},e.prototype.readGeometryFromObject=function(t,e){return bd(t,e)},e.prototype.readProjectionFromObject=function(t){var e,i=t.crs;return i?"name"==i.type?e=fi(i.properties.name):"EPSG"===i.type?e=fi("EPSG:"+i.properties.code):be(!1,36):e=this.dataProjection,e},e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var i={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(i.id=n),!t.hasProperties())return i;var o=t.getProperties(),r=t.getGeometry();return r&&(i.geometry=Cd(r,e),delete o[t.getGeometryName()]),vt(o)||(i.properties=o),i},e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var i=[],n=0,o=t.length;n<o;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}},e.prototype.writeGeometryObject=function(t,e){return Cd(t,this.adaptOptions(e))},e}(xd);function Sd(t,e){return zd().createElementNS(t,e)}function Td(t,e){return Pd(t,e,[]).join("")}function Pd(t,e,i){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)i.push(e?String(t.nodeValue).replace(/(\r\n|\r|\n)/g,""):t.nodeValue);else{var n=void 0;for(n=t.firstChild;n;n=n.nextSibling)Pd(n,e,i)}return i}function Ed(t){return"documentElement"in t}function Ad(t){return(new DOMParser).parseFromString(t,"application/xml")}function Ld(t,e){return function(i,n){var o=t.call(void 0!==e?e:this,i,n);void 0!==o&&n[n.length-1].push(o)}}function Rd(t,e){return function(i,n){var o=t.call(void 0!==e?e:this,i,n);void 0!==o&&(n[n.length-1]=o)}}function Od(t,e){return function(i,n,o){t.call(void 0!==e?e:this,i,n,o),o[o.length-1].node.appendChild(i)}}function Zd(t,e){var i=t;return function(t,n,o){var r=i;return void 0===r&&(r=o),Sd(void 0!==e?e:n[n.length-1].node.namespaceURI,r)}}var Id=Zd();function kd(t,e,i,n){var o;for(o=e.firstElementChild;o;o=o.nextElementSibling){var r=t[o.namespaceURI];if(void 0!==r){var s=r[o.localName];void 0!==s&&s.call(n,o,i)}}}function Nd(t,e,i,n,o){return n.push(t),kd(e,i,n,o),n.pop()}function Fd(t,e,i,n,o,r,s){return o.push(t),function(t,e,i,n,o,r){for(var s,a,h=(void 0!==o?o:i).length,l=0;l<h;++l)void 0!==(s=i[l])&&void 0!==(a=e.call(void 0!==r?r:this,s,n,void 0!==o?o[l]:void 0))&&t[a.namespaceURI][a.localName].call(r,a,s,n)}(e,i,n,o,r,s),o.pop()}var Dd=void 0,qd=void 0;function zd(){return void 0===qd&&"undefined"!=typeof document&&(qd=document.implementation.createDocument("","",null)),qd}var jd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const Gd=function(t){function e(){var e=t.call(this)||this;return e.xmlSerializer_=(void 0===Dd&&"undefined"!=typeof XMLSerializer&&(Dd=new XMLSerializer),Dd),e}return jd(e,t),e.prototype.getType=function(){return"xml"},e.prototype.readFeature=function(t,e){if(t){if("string"==typeof t){var i=Ad(t);return this.readFeatureFromDocument(i,e)}return Ed(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}return null},e.prototype.readFeatureFromDocument=function(t,e){var i=this.readFeaturesFromDocument(t,e);return i.length>0?i[0]:null},e.prototype.readFeatureFromNode=function(t,e){return null},e.prototype.readFeatures=function(t,e){if(t){if("string"==typeof t){var i=Ad(t);return this.readFeaturesFromDocument(i,e)}return Ed(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}return[]},e.prototype.readFeaturesFromDocument=function(t,e){for(var i=[],n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&ct(i,this.readFeaturesFromNode(n,e));return i},e.prototype.readFeaturesFromNode=function(t,e){return kt()},e.prototype.readGeometry=function(t,e){if(t){if("string"==typeof t){var i=Ad(t);return this.readGeometryFromDocument(i,e)}return Ed(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}return null},e.prototype.readGeometryFromDocument=function(t,e){return null},e.prototype.readGeometryFromNode=function(t,e){return null},e.prototype.readProjection=function(t){if(t){if("string"==typeof t){var e=Ad(t);return this.readProjectionFromDocument(e)}return Ed(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}return null},e.prototype.readProjectionFromDocument=function(t){return this.dataProjection},e.prototype.readProjectionFromNode=function(t){return this.dataProjection},e.prototype.writeFeature=function(t,e){var i=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(i)},e.prototype.writeFeatureNode=function(t,e){return null},e.prototype.writeFeatures=function(t,e){var i=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(i)},e.prototype.writeFeaturesNode=function(t,e){return null},e.prototype.writeGeometry=function(t,e){var i=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(i)},e.prototype.writeGeometryNode=function(t,e){return null},e}(gd);var Ud=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bd="http://www.opengis.net/gml",Wd=/^[\s\xa0]*$/,Yd=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.featureType=n.featureType,i.featureNS=n.featureNS,i.srsName=n.srsName,i.schemaLocation="",i.FEATURE_COLLECTION_PARSERS={},i.FEATURE_COLLECTION_PARSERS[i.namespace]={featureMember:Ld(i.readFeaturesInternal),featureMembers:Rd(i.readFeaturesInternal)},i.supportedMediaTypes=["application/gml+xml"],i}return Ud(e,t),e.prototype.readFeaturesInternal=function(t,e){var i=t.localName,n=null;if("FeatureCollection"==i)n=Nd([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if("featureMembers"==i||"featureMember"==i||"member"==i){var o=e[0],r=o.featureType,s=o.featureNS;if(!r&&t.childNodes){r=[],s={};for(var a=0,h=t.childNodes.length;a<h;++a){var l=t.childNodes[a];if(1===l.nodeType){var u=l.nodeName.split(":").pop();if(-1===r.indexOf(u)){var c="",p=0,d=l.namespaceURI;for(var f in s){if(s[f]===d){c=f;break}++p}c||(s[c="p"+p]=d),r.push(c+":"+u)}}}"featureMember"!=i&&(o.featureType=r,o.featureNS=s)}if("string"==typeof s){var g=s;(s={}).p0=g}var _={},m=Array.isArray(r)?r:[r];for(var y in s){var v={};for(a=0,h=m.length;a<h;++a)(-1===m[a].indexOf(":")?"p0":m[a].split(":")[0])===y&&(v[m[a].split(":").pop()]="featureMembers"==i?Ld(this.readFeatureElement,this):Rd(this.readFeatureElement,this));_[s[y]]=v}n=Nd("featureMember"==i||"member"==i?void 0:[],_,t,e)}return null===n&&(n=[]),n},e.prototype.readGeometryOrExtent=function(t,e){var i=e[0];return i.srsName=t.firstElementChild.getAttribute("srsName"),i.srsDimension=t.firstElementChild.getAttribute("srsDimension"),Nd(null,this.GEOMETRY_PARSERS,t,e,this)},e.prototype.readExtentElement=function(t,e){var i=e[0],n=this.readGeometryOrExtent(t,e);return n?md(n,i):void 0},e.prototype.readGeometryElement=function(t,e){var i=e[0],n=this.readGeometryOrExtent(t,e);return n?_d(n,!1,i):void 0},e.prototype.readFeatureElementInternal=function(t,e,i){for(var n,o={},r=t.firstElementChild;r;r=r.nextElementSibling){var s=void 0,a=r.localName;0===r.childNodes.length||1===r.childNodes.length&&(3===r.firstChild.nodeType||4===r.firstChild.nodeType)?(s=Td(r,!1),Wd.test(s)&&(s=void 0)):(i&&(s="boundedBy"===a?this.readExtentElement(r,e):this.readGeometryElement(r,e)),s?"boundedBy"!==a&&(n=a):s=this.readFeatureElementInternal(r,e,!1));var h=r.attributes.length;if(h>0){s={_content_:s};for(var l=0;l<h;l++)s[r.attributes[l].name]=r.attributes[l].value}o[a]?(o[a]instanceof Array||(o[a]=[o[a]]),o[a].push(s)):o[a]=s}if(i){var u=new ac(o);n&&u.setGeometryName(n);var c=t.getAttribute("fid")||function(t,e,i){return t.getAttributeNS(e,"id")||""}(t,this.namespace);return c&&u.setId(c),u}return o},e.prototype.readFeatureElement=function(t,e){return this.readFeatureElementInternal(t,e,!0)},e.prototype.readPoint=function(t,e){var i=this.readFlatCoordinatesFromNode(t,e);if(i)return new Nn(i,Bi)},e.prototype.readMultiPoint=function(t,e){var i=Nd([],this.MULTIPOINT_PARSERS,t,e,this);return i?new _c(i):void 0},e.prototype.readMultiLineString=function(t,e){var i=Nd([],this.MULTILINESTRING_PARSERS,t,e,this);if(i)return new fc(i)},e.prototype.readMultiPolygon=function(t,e){var i=Nd([],this.MULTIPOLYGON_PARSERS,t,e,this);if(i)return new yc(i)},e.prototype.pointMemberParser=function(t,e){kd(this.POINTMEMBER_PARSERS,t,e,this)},e.prototype.lineStringMemberParser=function(t,e){kd(this.LINESTRINGMEMBER_PARSERS,t,e,this)},e.prototype.polygonMemberParser=function(t,e){kd(this.POLYGONMEMBER_PARSERS,t,e,this)},e.prototype.readLineString=function(t,e){var i=this.readFlatCoordinatesFromNode(t,e);return i?new pc(i,Bi):void 0},e.prototype.readFlatLinearRing=function(t,e){return Nd(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)||void 0},e.prototype.readLinearRing=function(t,e){var i=this.readFlatCoordinatesFromNode(t,e);if(i)return new In(i,Bi)},e.prototype.readPolygon=function(t,e){var i=Nd([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(i&&i[0]){var n,o=i[0],r=[o.length],s=void 0;for(s=1,n=i.length;s<n;++s)ct(o,i[s]),r.push(o.length);return new Qn(o,Bi,r)}},e.prototype.readFlatCoordinatesFromNode=function(t,e){return Nd(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},e.prototype.readGeometryFromNode=function(t,e){return this.readGeometryElement(t,[this.getReadOptions(t,e||{})])||null},e.prototype.readFeaturesFromNode=function(t,e){var i={featureType:this.featureType,featureNS:this.featureNS};return e&&_t(i,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[i])||[]},e.prototype.readProjectionFromNode=function(t){return fi(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))},e}(Gd);Yd.prototype.namespace=Bd,Yd.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},Yd.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},Yd.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},Yd.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:Ld(Yd.prototype.pointMemberParser),pointMembers:Ld(Yd.prototype.pointMemberParser)}},Yd.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:Ld(Yd.prototype.lineStringMemberParser),lineStringMembers:Ld(Yd.prototype.lineStringMemberParser)}},Yd.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:Ld(Yd.prototype.polygonMemberParser),polygonMembers:Ld(Yd.prototype.polygonMemberParser)}},Yd.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:Ld(Yd.prototype.readFlatCoordinatesFromNode)}},Yd.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:Ld(Yd.prototype.readLineString)}},Yd.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:Ld(Yd.prototype.readPolygon)}},Yd.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Rd(Yd.prototype.readFlatLinearRing)}};const Vd=Yd;function Xd(t){var e=/^\s*(\d+)\s*$/.exec(t);return e?parseInt(e[1],10):void 0}function Hd(t,e){t.appendChild(zd().createTextNode(e))}var Kd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Jd={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},Qd=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,n)||this).FEATURE_COLLECTION_PARSERS[Bd].featureMember=Ld(i.readFeaturesInternal),i.schemaLocation=n.schemaLocation?n.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",i}return Kd(e,t),e.prototype.readFlatCoordinates=function(t,e){var i=Td(t,!1).replace(/^\s*|\s*$/g,""),n=e[0].srsName,o="enu";if(n){var r=fi(n);r&&(o=r.getAxisOrientation())}for(var s=i.trim().split(/\s+/),a=[],h=0,l=s.length;h<l;h++){var u=s[h].split(/,+/),c=parseFloat(u[0]),p=parseFloat(u[1]),d=3===u.length?parseFloat(u[2]):0;"en"===o.substr(0,2)?a.push(c,p,d):a.push(p,c,d)}return a},e.prototype.readBox=function(t,e){var i=Nd([null],this.BOX_PARSERS_,t,e,this);return Re(i[1][0],i[1][1],i[1][3],i[1][4])},e.prototype.innerBoundaryIsParser=function(t,e){var i=Nd(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)},e.prototype.outerBoundaryIsParser=function(t,e){var i=Nd(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)},e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,i){var n,o=e[e.length-1],r=o.multiSurface,s=o.surface,a=o.multiCurve;return Array.isArray(t)?n="Envelope":"MultiPolygon"===(n=t.getType())&&!0===r?n="MultiSurface":"Polygon"===n&&!0===s?n="Surface":"MultiLineString"===n&&!0===a&&(n="MultiCurve"),Sd("http://www.opengis.net/gml",n)},e.prototype.writeFeatureElement=function(t,e,i){var n=e.getId();n&&t.setAttribute("fid",n);var o=i[i.length-1],r=o.featureNS,s=e.getGeometryName();o.serializers||(o.serializers={},o.serializers[r]={});var a=[],h=[];if(e.hasProperties()){var l=e.getProperties();for(var u in l){var c=l[u];null!==c&&(a.push(u),h.push(c),u==s||"function"==typeof c.getSimplifiedGeometry?u in o.serializers[r]||(o.serializers[r][u]=Od(this.writeGeometryElement,this)):u in o.serializers[r]||(o.serializers[r][u]=Od(Hd)))}}var p=_t({},o);p.node=t,Fd(p,o.serializers,Zd(void 0,r),h,i,a)},e.prototype.writeCurveOrLineString=function(t,e,i){var n=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&n&&t.setAttribute("srsName",n),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var o=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(o),this.writeCoordinates_(o,e,i)}else if("Curve"===t.nodeName){var r=Sd(t.namespaceURI,"segments");t.appendChild(r),this.writeCurveSegments_(r,e,i)}},e.prototype.writeLineStringOrCurveMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))},e.prototype.writeMultiCurveOrLineString=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName,s=n.curve;r&&t.setAttribute("srsName",r);var a=e.getLineStrings();Fd({node:t,hasZ:o,srsName:r,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeGeometryElement=function(t,e,i){var n,o=i[i.length-1],r=_t({},o);r.node=t,n=Array.isArray(e)?md(e,o):_d(e,!0,o),Fd(r,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[n],i,void 0,this)},e.prototype.createCoordinatesNode_=function(t){var e=Sd(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e},e.prototype.writeCoordinates_=function(t,e,i){for(var n=i[i.length-1],o=n.hasZ,r=n.srsName,s=e.getCoordinates(),a=s.length,h=new Array(a),l=0;l<a;++l)h[l]=this.getCoords_(s[l],r,o);Hd(t,h.join(" "))},e.prototype.writeCurveSegments_=function(t,e,i){var n=Sd(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)},e.prototype.writeSurfaceOrPolygon=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName;if("PolygonPatch"!==t.nodeName&&r&&t.setAttribute("srsName",r),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var s=e.getLinearRings();Fd({node:t,hasZ:o,srsName:r},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,s,i,void 0,this)}else if("Surface"===t.nodeName){var a=Sd(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}},e.prototype.RING_NODE_FACTORY_=function(t,e,i){var n=e[e.length-1],o=n.node,r=n.exteriorWritten;return void 0===r&&(n.exteriorWritten=!0),Sd(o.namespaceURI,void 0!==r?"innerBoundaryIs":"outerBoundaryIs")},e.prototype.writeSurfacePatches_=function(t,e,i){var n=Sd(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)},e.prototype.writeRing=function(t,e,i){var n=Sd(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)},e.prototype.getCoords_=function(t,e,i){var n="enu";e&&(n=fi(e).getAxisOrientation());var o="en"===n.substr(0,2)?t[0]+","+t[1]:t[1]+","+t[0];return i&&(o+=","+(t[2]||0)),o},e.prototype.writePoint=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName;r&&t.setAttribute("srsName",r);var s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s);var a=e.getCoordinates();Hd(s,this.getCoords_(a,r,o))},e.prototype.writeMultiPoint=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName;r&&t.setAttribute("srsName",r);var s=e.getPoints();Fd({node:t,hasZ:o,srsName:r},this.POINTMEMBER_SERIALIZERS,Zd("pointMember"),s,i,void 0,this)},e.prototype.writePointMember=function(t,e,i){var n=Sd(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)},e.prototype.writeLinearRing=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var o=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(o),this.writeCoordinates_(o,e,i)},e.prototype.writeMultiSurfaceOrPolygon=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName,s=n.surface;r&&t.setAttribute("srsName",r);var a=e.getPolygons();Fd({node:t,hasZ:o,srsName:r,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeSurfaceOrPolygonMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))},e.prototype.writeEnvelope=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n),Fd({node:t},this.ENVELOPE_SERIALIZERS,Id,[e[0]+" "+e[1],e[2]+" "+e[3]],i,["lowerCorner","upperCorner"],this)},e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,i){return Sd("http://www.opengis.net/gml",Jd[e[e.length-1].node.nodeName])},e}(Vd);Qd.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:Rd(Qd.prototype.readFlatCoordinates)}},Qd.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:Qd.prototype.innerBoundaryIsParser,outerBoundaryIs:Qd.prototype.outerBoundaryIsParser}},Qd.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:Ld(Qd.prototype.readFlatCoordinates)}},Qd.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Rd(Vd.prototype.readPoint),MultiPoint:Rd(Vd.prototype.readMultiPoint),LineString:Rd(Vd.prototype.readLineString),MultiLineString:Rd(Vd.prototype.readMultiLineString),LinearRing:Rd(Vd.prototype.readLinearRing),Polygon:Rd(Vd.prototype.readPolygon),MultiPolygon:Rd(Vd.prototype.readMultiPolygon),Box:Rd(Qd.prototype.readBox)}},Qd.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:Od(Qd.prototype.writeCurveOrLineString),MultiCurve:Od(Qd.prototype.writeMultiCurveOrLineString),Point:Od(Qd.prototype.writePoint),MultiPoint:Od(Qd.prototype.writeMultiPoint),LineString:Od(Qd.prototype.writeCurveOrLineString),MultiLineString:Od(Qd.prototype.writeMultiCurveOrLineString),LinearRing:Od(Qd.prototype.writeLinearRing),Polygon:Od(Qd.prototype.writeSurfaceOrPolygon),MultiPolygon:Od(Qd.prototype.writeMultiSurfaceOrPolygon),Surface:Od(Qd.prototype.writeSurfaceOrPolygon),MultiSurface:Od(Qd.prototype.writeMultiSurfaceOrPolygon),Envelope:Od(Qd.prototype.writeEnvelope)}},Qd.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:Od(Qd.prototype.writeLineStringOrCurveMember),curveMember:Od(Qd.prototype.writeLineStringOrCurveMember)}},Qd.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:Od(Qd.prototype.writeRing),innerBoundaryIs:Od(Qd.prototype.writeRing)}},Qd.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:Od(Qd.prototype.writePointMember)}},Qd.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:Od(Qd.prototype.writeSurfaceOrPolygonMember),polygonMember:Od(Qd.prototype.writeSurfaceOrPolygonMember)}},Qd.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:Od(Hd),upperCorner:Od(Hd)}};const $d=Qd;var tf,ef=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),nf={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},of=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,n)||this).surface_=void 0!==n.surface&&n.surface,i.curve_=void 0!==n.curve&&n.curve,i.multiCurve_=void 0===n.multiCurve||n.multiCurve,i.multiSurface_=void 0===n.multiSurface||n.multiSurface,i.schemaLocation=n.schemaLocation?n.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",i.hasZ=void 0!==n.hasZ&&n.hasZ,i}return ef(e,t),e.prototype.readMultiCurve=function(t,e){var i=Nd([],this.MULTICURVE_PARSERS,t,e,this);return i?new fc(i):void 0},e.prototype.readFlatCurveRing=function(t,e){for(var i=Nd([],this.MULTICURVE_PARSERS,t,e,this),n=[],o=0,r=i.length;o<r;++o)ct(n,i[o].getFlatCoordinates());return n},e.prototype.readMultiSurface=function(t,e){var i=Nd([],this.MULTISURFACE_PARSERS,t,e,this);if(i)return new yc(i)},e.prototype.curveMemberParser=function(t,e){kd(this.CURVEMEMBER_PARSERS,t,e,this)},e.prototype.surfaceMemberParser=function(t,e){kd(this.SURFACEMEMBER_PARSERS,t,e,this)},e.prototype.readPatch=function(t,e){return Nd([null],this.PATCHES_PARSERS,t,e,this)},e.prototype.readSegment=function(t,e){return Nd([],this.SEGMENTS_PARSERS,t,e,this)},e.prototype.readPolygonPatch=function(t,e){return Nd([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)},e.prototype.readLineStringSegment=function(t,e){return Nd([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},e.prototype.interiorParser=function(t,e){var i=Nd(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)},e.prototype.exteriorParser=function(t,e){var i=Nd(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)},e.prototype.readSurface=function(t,e){var i=Nd([null],this.SURFACE_PARSERS,t,e,this);if(i&&i[0]){var n,o=i[0],r=[o.length],s=void 0;for(s=1,n=i.length;s<n;++s)ct(o,i[s]),r.push(o.length);return new Qn(o,Bi,r)}},e.prototype.readCurve=function(t,e){var i=Nd([null],this.CURVE_PARSERS,t,e,this);return i?new pc(i,Bi):void 0},e.prototype.readEnvelope=function(t,e){var i=Nd([null],this.ENVELOPE_PARSERS,t,e,this);return Re(i[1][0],i[1][1],i[2][0],i[2][1])},e.prototype.readFlatPos=function(t,e){for(var i,n=Td(t,!1),o=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,r=[];i=o.exec(n);)r.push(parseFloat(i[1])),n=n.substr(i[0].length);if(""===n){var s=e[0].srsName,a="enu";if(s&&(a=fi(s).getAxisOrientation()),"neu"===a){var h,l=void 0;for(l=0,h=r.length;l<h;l+=3){var u=r[l];r[l]=r[l+1],r[l+1]=u}}var c=r.length;if(2==c&&r.push(0),0!==c)return r}},e.prototype.readFlatPosList=function(t,e){var i=Td(t,!1).replace(/^\s*|\s*$/g,""),n=e[0],o=n.srsName,r=n.srsDimension,s="enu";o&&(s=fi(o).getAxisOrientation());var a,h,l,u=i.split(/\s+/),c=2;t.getAttribute("srsDimension")?c=Xd(t.getAttribute("srsDimension")):t.getAttribute("dimension")?c=Xd(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?c=Xd(t.parentNode.getAttribute("srsDimension")):r&&(c=Xd(r));for(var p=[],d=0,f=u.length;d<f;d+=c)a=parseFloat(u[d]),h=parseFloat(u[d+1]),l=3===c?parseFloat(u[d+2]):0,"en"===s.substr(0,2)?p.push(a,h,l):p.push(h,a,l);return p},e.prototype.writePos_=function(t,e,i){var n=i[i.length-1],o=n.hasZ;t.setAttribute("srsDimension",o?"3":"2");var r=n.srsName,s="enu";r&&(s=fi(r).getAxisOrientation());var a,h=e.getCoordinates();a="en"===s.substr(0,2)?h[0]+" "+h[1]:h[1]+" "+h[0],o&&(a+=" "+(h[2]||0)),Hd(t,a)},e.prototype.getCoords_=function(t,e,i){var n="enu";e&&(n=fi(e).getAxisOrientation());var o="en"===n.substr(0,2)?t[0]+" "+t[1]:t[1]+" "+t[0];return i&&(o+=" "+(t[2]||0)),o},e.prototype.writePosList_=function(t,e,i){var n=i[i.length-1],o=n.hasZ;t.setAttribute("srsDimension",o?"3":"2");for(var r=n.srsName,s=e.getCoordinates(),a=s.length,h=new Array(a),l=0;l<a;++l)h[l]=this.getCoords_(s[l],r,o);Hd(t,h.join(" "))},e.prototype.writePoint=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var o=Sd(t.namespaceURI,"pos");t.appendChild(o),this.writePos_(o,e,i)},e.prototype.writeEnvelope=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n),Fd({node:t},this.ENVELOPE_SERIALIZERS,Id,[e[0]+" "+e[1],e[2]+" "+e[3]],i,["lowerCorner","upperCorner"],this)},e.prototype.writeLinearRing=function(t,e,i){var n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);var o=Sd(t.namespaceURI,"posList");t.appendChild(o),this.writePosList_(o,e,i)},e.prototype.RING_NODE_FACTORY_=function(t,e,i){var n=e[e.length-1],o=n.node,r=n.exteriorWritten;return void 0===r&&(n.exteriorWritten=!0),Sd(o.namespaceURI,void 0!==r?"interior":"exterior")},e.prototype.writeSurfaceOrPolygon=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName;if("PolygonPatch"!==t.nodeName&&r&&t.setAttribute("srsName",r),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var s=e.getLinearRings();Fd({node:t,hasZ:o,srsName:r},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,s,i,void 0,this)}else if("Surface"===t.nodeName){var a=Sd(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}},e.prototype.writeCurveOrLineString=function(t,e,i){var n=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&n&&t.setAttribute("srsName",n),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var o=Sd(t.namespaceURI,"posList");t.appendChild(o),this.writePosList_(o,e,i)}else if("Curve"===t.nodeName){var r=Sd(t.namespaceURI,"segments");t.appendChild(r),this.writeCurveSegments_(r,e,i)}},e.prototype.writeMultiSurfaceOrPolygon=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName,s=n.surface;r&&t.setAttribute("srsName",r);var a=e.getPolygons();Fd({node:t,hasZ:o,srsName:r,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeMultiPoint=function(t,e,i){var n=i[i.length-1],o=n.srsName,r=n.hasZ;o&&t.setAttribute("srsName",o);var s=e.getPoints();Fd({node:t,hasZ:r,srsName:o},this.POINTMEMBER_SERIALIZERS,Zd("pointMember"),s,i,void 0,this)},e.prototype.writeMultiCurveOrLineString=function(t,e,i){var n=i[i.length-1],o=n.hasZ,r=n.srsName,s=n.curve;r&&t.setAttribute("srsName",r);var a=e.getLineStrings();Fd({node:t,hasZ:o,srsName:r,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeRing=function(t,e,i){var n=Sd(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)},e.prototype.writeSurfaceOrPolygonMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))},e.prototype.writePointMember=function(t,e,i){var n=Sd(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)},e.prototype.writeLineStringOrCurveMember=function(t,e,i){var n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))},e.prototype.writeSurfacePatches_=function(t,e,i){var n=Sd(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)},e.prototype.writeCurveSegments_=function(t,e,i){var n=Sd(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)},e.prototype.writeGeometryElement=function(t,e,i){var n,o=i[i.length-1],r=_t({},o);r.node=t,n=Array.isArray(e)?md(e,o):_d(e,!0,o),Fd(r,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[n],i,void 0,this)},e.prototype.writeFeatureElement=function(t,e,i){var n=e.getId();n&&t.setAttribute("fid",n);var o=i[i.length-1],r=o.featureNS,s=e.getGeometryName();o.serializers||(o.serializers={},o.serializers[r]={});var a=[],h=[];if(e.hasProperties()){var l=e.getProperties();for(var u in l){var c=l[u];null!==c&&(a.push(u),h.push(c),u==s||"function"==typeof c.getSimplifiedGeometry?u in o.serializers[r]||(o.serializers[r][u]=Od(this.writeGeometryElement,this)):u in o.serializers[r]||(o.serializers[r][u]=Od(Hd)))}}var p=_t({},o);p.node=t,Fd(p,o.serializers,Zd(void 0,r),h,i,a)},e.prototype.writeFeatureMembers_=function(t,e,i){var n=i[i.length-1],o=n.featureType,r=n.featureNS,s={};s[r]={},s[r][o]=Od(this.writeFeatureElement,this);var a=_t({},n);a.node=t,Fd(a,s,Zd(o,r),e,i)},e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,i){return Sd(this.namespace,nf[e[e.length-1].node.nodeName])},e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,i){var n,o=e[e.length-1],r=o.multiSurface,s=o.surface,a=o.curve,h=o.multiCurve;return Array.isArray(t)?n="Envelope":"MultiPolygon"===(n=t.getType())&&!0===r?n="MultiSurface":"Polygon"===n&&!0===s?n="Surface":"LineString"===n&&!0===a?n="Curve":"MultiLineString"===n&&!0===h&&(n="MultiCurve"),Sd(this.namespace,n)},e.prototype.writeGeometryNode=function(t,e){e=this.adaptOptions(e);var i=Sd(this.namespace,"geom"),n={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return e&&_t(n,e),this.writeGeometryElement(i,t,[n]),i},e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var i=Sd(this.namespace,"featureMembers");i.setAttributeNS("http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.schemaLocation);var n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return e&&_t(n,e),this.writeFeatureMembers_(i,t,[n]),i},e}(Vd);of.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:Rd(of.prototype.readFlatPos),posList:Rd(of.prototype.readFlatPosList),coordinates:Rd($d.prototype.readFlatCoordinates)}},of.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:of.prototype.interiorParser,exterior:of.prototype.exteriorParser}},of.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Rd(Vd.prototype.readPoint),MultiPoint:Rd(Vd.prototype.readMultiPoint),LineString:Rd(Vd.prototype.readLineString),MultiLineString:Rd(Vd.prototype.readMultiLineString),LinearRing:Rd(Vd.prototype.readLinearRing),Polygon:Rd(Vd.prototype.readPolygon),MultiPolygon:Rd(Vd.prototype.readMultiPolygon),Surface:Rd(of.prototype.readSurface),MultiSurface:Rd(of.prototype.readMultiSurface),Curve:Rd(of.prototype.readCurve),MultiCurve:Rd(of.prototype.readMultiCurve),Envelope:Rd(of.prototype.readEnvelope)}},of.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:Ld(of.prototype.curveMemberParser),curveMembers:Ld(of.prototype.curveMemberParser)}},of.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:Ld(of.prototype.surfaceMemberParser),surfaceMembers:Ld(of.prototype.surfaceMemberParser)}},of.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:Ld(Vd.prototype.readLineString),Curve:Ld(of.prototype.readCurve)}},of.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:Ld(Vd.prototype.readPolygon),Surface:Ld(of.prototype.readSurface)}},of.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:Rd(of.prototype.readPatch)}},of.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:Rd(of.prototype.readSegment)}},of.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:Ld(of.prototype.readFlatPosList),upperCorner:Ld(of.prototype.readFlatPosList)}},of.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:Rd(of.prototype.readPolygonPatch)}},of.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:(tf=of.prototype.readLineStringSegment,function(t,e){var i=tf.call(this,t,e);void 0!==i&&ct(e[e.length-1],i)})}},Vd.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Rd(Vd.prototype.readFlatLinearRing),Ring:Rd(of.prototype.readFlatCurveRing)}},of.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:Od(of.prototype.writeRing),interior:Od(of.prototype.writeRing)}},of.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:Od(Hd),upperCorner:Od(Hd)}},of.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:Od(of.prototype.writeSurfaceOrPolygonMember),polygonMember:Od(of.prototype.writeSurfaceOrPolygonMember)}},of.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:Od(of.prototype.writePointMember)}},of.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:Od(of.prototype.writeLineStringOrCurveMember),curveMember:Od(of.prototype.writeLineStringOrCurveMember)}},of.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:Od(of.prototype.writeCurveOrLineString),MultiCurve:Od(of.prototype.writeMultiCurveOrLineString),Point:Od(of.prototype.writePoint),MultiPoint:Od(of.prototype.writeMultiPoint),LineString:Od(of.prototype.writeCurveOrLineString),MultiLineString:Od(of.prototype.writeMultiCurveOrLineString),LinearRing:Od(of.prototype.writeLinearRing),Polygon:Od(of.prototype.writeSurfaceOrPolygon),MultiPolygon:Od(of.prototype.writeMultiSurfaceOrPolygon),Surface:Od(of.prototype.writeSurfaceOrPolygon),MultiSurface:Od(of.prototype.writeMultiSurfaceOrPolygon),Envelope:Od(of.prototype.writeEnvelope)}};const rf=of;function sf(t,e){if(1&t&&(a.TgZ(0,"option",14),a._uU(1),a.qZA()),2&t){const t=e.$implicit;a.Q6J("value",e.index),a.xp6(1),a.hij(" ",t.fullName," ")}}function af(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"button",21),a.NdJ("click",function(){a.CHM(t);const e=a.oxw(2);return e.showAttributePanel=!e.showAttributePanel}),a._UZ(1,"i",22),a.qZA()}}function hf(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"input",25),a.NdJ("change",function(e){a.CHM(t);const i=a.oxw(2).$implicit;return a.oxw(3).updateFeature(e,i.name)}),a.qZA()}if(2&t){const t=a.oxw(2).$implicit,e=a.oxw(3);a.Q6J("value",e.currentEditFeature.getProperties()[t.name])}}function lf(t,e){if(1&t&&(a.TgZ(0,"tr"),a.TgZ(1,"td"),a._uU(2),a.qZA(),a.TgZ(3,"td"),a.YNc(4,hf,1,1,"input",24),a.qZA(),a.qZA()),2&t){const t=a.oxw().$implicit,e=a.oxw(3);a.xp6(2),a.hij(" ",t.name," "),a.xp6(2),a.Q6J("ngIf",e.currentEditFeature)}}function uf(t,e){if(1&t&&(a.ynx(0),a.YNc(1,lf,5,2,"tr",20),a.BQk()),2&t){const t=e.$implicit;a.xp6(1),a.Q6J("ngIf","geom"!=t.name)}}function cf(t,e){if(1&t&&(a.TgZ(0,"table"),a.YNc(1,uf,2,1,"ng-container",23),a.qZA()),2&t){const t=a.oxw(2);a.xp6(1),a.Q6J("ngForOf",t.attributes)}}function pf(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",15),a.YNc(1,af,2,0,"button",16),a.TgZ(2,"div",17),a.TgZ(3,"button",18),a.NdJ("click",function(){return a.CHM(t),a.oxw().showAttributePanel=!1}),a._UZ(4,"i",19),a.qZA(),a.YNc(5,cf,2,1,"table",20),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(1),a.Q6J("ngIf",!t.showAttributePanel),a.xp6(1),a.Udp("display",t.showAttributePanel?"block":"none"),a.xp6(3),a.Q6J("ngIf",t.attributes.length>0)}}let df=(()=>{class t{constructor(t,e){this.httpClient=t,this.changeDetectorRef=e,this.map=null,this.drawInt=null,this.modifyInt=null,this.dragInt=null,this.editingLayer=null,this.editingWfsLayer=null,this.editingLayers=[],this.editorStarted=!1,this.tmpLayerName=null,this.loaderGifPath="assets/Loader.gif",this.loading=!0,this.savedFeatues=[],this.attributes=[],this.showAttributePanel=!1,this.currentEditFeature=null,this.parentComponent=null}setMap(t){this.map=t,Fl.defs("EPSG:900913","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"),Dl(Fl),setTimeout(()=>this.refreshLayers(),2e3)}refreshLayers(){this.editingLayers=[];let t=this.map.getLayers().getArray();for(let e=0;e<t.length;e++)"wms"==t[e].get("type")&&this.editingLayers.push({name:t[e].get("name"),fullName:t[e].get("full-name"),modelName:t[e].get("model-name"),geometryType:t[e].get("geometry-type")})}getGeomCoords(t,e){}saveFeatures(){var t,e=this;return(t=function*(){let t=e.editingWfsLayer.getSource().getFeatures(),i=[];for(let e=0;e<t.length;e++)t[e].get("action")&&i.push(t[e]);if(i.length>0){const t=function(t,e){switch(t.get("action")){case"add":return"";case"modify":let n="",o=(t.getGeometry().getType(),new rf({srsName:"urn:ogc:def:crs:EPSG::27700"}));t.getGeometry().transform("EPSG:3857","EPSG:27700"),n+=`<wfs:Property><wfs:Name>geom</wfs:Name><wfs:Value>${o.writeGeometry(t.getGeometry(),{dataProjection:"EPSG:27700",featureProjection:"urn:ogc:def:crs:EPSG::27700",rightHanded:!1})}</wfs:Value></wfs:Property>`;let r=t.getProperties();for(var i in r)if("geometry"==i);else{if("action"==i)continue;n+=`<wfs:Property><wfs:Name>${i}</wfs:Name><wfs:Value>${r[i]?r[i]:""}</wfs:Value></wfs:Property>`}return`<wfs:Transaction service="WFS" version="1.1.0" xmlns:topp="http://www.openplans.org/topp" xmlns:ogc="http://www.opengis.net/ogc" xmlns:wfs="http://www.opengis.net/wfs" xmlns:gml="http://www.opengis.net/gml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/WFS-transaction.xsd"><wfs:Update typeName="${e}">${n}<ogc:Filter><ogc:FeatureId fid="${t.getId().split(".")[1]}"/></ogc:Filter></wfs:Update></wfs:Transaction>`;case"removed":return`<wfs:Transaction service="WFS" version="1.0.0"\n          xmlns:cdf="http://www.opengis.net/cite/data"\n          xmlns:ogc="http://www.opengis.net/ogc"\n          xmlns:wfs="http://www.opengis.net/wfs"\n          xmlns:topp="http://www.openplans.org/topp">\n          <wfs:Delete typeName="${e}">\n            <ogc:Filter>\n              <ogc:FeatureId fid="${t.getId().split(".")[1]}"/>\n            </ogc:Filter>\n          </wfs:Delete>\n        </wfs:Transaction>`;default:return null}};new h.WM({"Content-Type":"text/xml",Accept:"text/xml,text/html, application/xhtml+xml, */*","Response-Type":"text/xml"});for(let o=0;o<i.length;o++){let n=yield fetch(`${e.configs.geoserverUrl}/wfs`,{method:"POST",headers:{"Content-Type":"text/xml",Accept:"text/xml,text/html, application/xhtml+xml, */*","Response-Type":"text/xml",Authorization:"Basic "+btoa("admin:geoserver")},mode:"no-cors",body:t(i[o],e.editingLayer.fullName)}),r=yield n.status;console.log(r),console.log(n)}alert("save completed"),e.switchStartInteractions(null);let n=e.map.getLayers().getArray();for(let i=0;i<n.length;i++)n[i].get("full-name")==e.tmpLayerName&&(n[i].set("full-name",e.editingLayer.fullName),n[i].set("name",e.editingLayer.name),n[i].set("visible",!0),n[i].getSource().updateParams({time:Date.now()}));e.editingWfsLayer.getSource().clear(),e.editingWfsLayer=null,e.tmpLayerName=null,e.attributes=[],e.currentEditFeature=null,e.map.removeLayer(e.editingWfsLayer),e.map.updateSize({}),e.editorStarted=!1}},function(){var e=this,i=arguments;return new Promise(function(n,o){var r=t.apply(e,i);function s(t){ic(r,n,o,s,a,"next",t)}function a(t){ic(r,n,o,s,a,"throw",t)}s(void 0)})})()}startEndEditing(){if(this.editorStarted||(this.editorStarted=!0),this.editorStarted){const e=new Sc({radius:3,fill:null,stroke:new Pc({color:"red",width:3})}),i={Point:new Zc({image:e}),LineString:new Zc({stroke:new Pc({color:"green",width:1})}),MultiLineString:new Zc({stroke:new Pc({color:"green",width:1})}),MultiPoint:new Zc({image:e}),MultiPolygon:new Zc({stroke:new Pc({color:"yellow",width:1}),fill:new Tc({color:"rgba(255, 255, 0, 0.1)"})}),Polygon:new Zc({stroke:new Pc({color:"blue",lineDash:[4],width:3}),fill:new Tc({color:"rgba(0, 0, 255, 0.1)"})}),GeometryCollection:new Zc({stroke:new Pc({color:"magenta",width:2}),fill:new Tc({color:"magenta"}),image:new Sc({radius:10,fill:null,stroke:new Pc({color:"magenta"})})}),Circle:new Zc({stroke:new Pc({color:"red",width:2}),fill:new Tc({color:"rgba(255,0,0,0.2)"})})},n=function(t){return"removed"==t.get("action")?null:i[t.getGeometry().getType()]};let o=`${this.configs.geoserverUrl}/${this.editingLayer.fullName.split(":")[0]}/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=${this.editingLayer.fullName}&outputFormat=application/json&srsName=EPSG:900913`;this.editingWfsLayer=new zp({style:n,source:new Xp({format:new Md,url:o})}),this.httpClient.get(`${this.configs.geoserverUrl}/wfs?version=1.3.0&request=describeFeatureType&outputFormat=application/json&service=WFS&typeName=${this.editingLayer.fullName}`).subscribe(t=>{this.attributes=t.featureTypes[0].properties}),this.editingWfsLayer.set("name",this.editingLayer.fullName),this.editingWfsLayer.set("model-name",this.editingLayer.modelName),this.editingWfsLayer.set("type","wfs"),this.editingWfsLayer.set("full-name",this.editingLayer.fullName),this.editingWfsLayer.set("geometry-type",this.editingLayer.geometryType),this.editingWfsLayer.set("visible",!0),this.tmpLayerName=Date.now().toString(36)+Math.random().toString(36).substring(2);var t=this;this.map.getLayers().forEach(function(e){e.get("full-name")==t.editingLayer.fullName&&(e.set("full-name",t.tmpLayerName),e.set("name",t.tmpLayerName),e.set("visible",!1),t.map.updateSize())}),this.map.addLayer(this.editingWfsLayer)}else this.saveFeatures();this.map.updateSize()}onLayerChange(t){this.editingLayer=this.editingLayers[t.target.selectedIndex-1]}forEachFeatureAtPixel(t,e){}updateSize(t){}deleteFeatureOnMapClick(t){var e=this;this.forEachFeatureAtPixel(t.pixel,function(t,i){confirm("Do you want to remove this feature?")&&("new"==t.get("action")?i.getSource().removeFeature(t):t.set("action","removed"),e.updateSize({}))})}addFeatureMode(){}editFeatureMode(){}dragFeatureMode(){}removeFeatureMode(){}drawEndEvent(t){t.feature.set("action","new"),this.currentEditFeature=t.feature,this.showAttributePanel=!0}modifyEndEvent(t){t.features.getArray().length>0&&"new"!=t.features.getArray()[0].get("action")&&t.features.getArray()[0].set("action","modify")}modifystart(t){t.features.getArray().length>0&&"new"!=t.features.getArray()[0].get("action")&&t.features.getArray()[0].set("action","modify"),this.parentComponent.currentEditFeature&&this.parentComponent.currentEditFeature.getId()==t.features.getArray()[0].getId()||(this.parentComponent.showAttributePanel=!0,this.parentComponent.currentEditFeature=t.features.getArray()[0],this.parentComponent.changeDetectorRef.detectChanges())}dragEndEvent(t){}updateFeature(t,e){let i=this.currentEditFeature.getProperties();i[e]=t.target.value,this.currentEditFeature.setProperties(i)}switchStartInteractions(t){if(this.drawInt&&(this.map.removeInteraction(this.drawInt),this.drawInt.un("drawend",this.drawEndEvent),this.drawInt=null),this.modifyInt&&(this.map.removeInteraction(this.modifyInt),this.modifyInt.un("modifyend",this.modifyEndEvent),this.modifyInt.un("modifystart",this.modifystart),this.modifyInt.parentComponent=null,this.modifyInt=null),this.dragInt&&(this.map.removeInteraction(this.dragInt),this.dragInt=null),this.map.un("singleclick",this.deleteFeatureOnMapClick),t)switch(t){case"add":this.drawInt=new id({source:this.editingWfsLayer.getSource(),type:this.editingLayer.geometryType}),this.drawInt.on("drawend",this.drawEndEvent),this.map.addInteraction(this.drawInt);break;case"modify":this.modifyInt=new cd({source:this.editingWfsLayer.getSource()}),this.modifyInt.on("modifyend",this.modifyEndEvent),this.modifyInt.on("modifystart",this.modifystart),this.map.addInteraction(this.modifyInt),this.modifyInt.parentComponent=this;break;case"drag":this.dragInt=new nc,this.map.addInteraction(this.dragInt);break;case"remove":this.map.on("singleclick",this.deleteFeatureOnMapClick)}}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(h.eN),a.Y36(a.sBO))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-ol-map-wms-layer-editor"]],inputs:{configs:"configs"},decls:16,vars:9,consts:[[1,"ol-map-editor"],[1,"form-select",3,"disabled","change"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-info",2,"font-size","10px",3,"click"],["title","add feature",1,"btn","btn-sm","btn-success",2,"font-size","10px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-plus"],["title","modify feature",1,"btn","btn-sm","btn-success",2,"font-size","10px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-pencil"],["title","drag feature",1,"btn","btn-sm","btn-success",2,"font-size","10px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-arrows-alt"],["title","remove feature",1,"btn","btn-sm","btn-success",2,"font-size","10px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-trash"],["class","ol-map-editor-attributes",4,"ngIf"],[3,"value"],[1,"ol-map-editor-attributes"],["class","btn btn-primary btn-sm map-layers-btn",3,"click",4,"ngIf"],[1,"feature-attributes-pnl"],["title","close panel",3,"click"],[1,"fa","fa-arrow-right"],[4,"ngIf"],[1,"btn","btn-primary","btn-sm","map-layers-btn",3,"click"],[1,"fa","fa-bars"],[4,"ngFor","ngForOf"],["type","text",3,"value","change",4,"ngIf"],["type","text",3,"value","change"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"select",1),a.NdJ("change",function(t){return e.onLayerChange(t)}),a.TgZ(2,"option",2),a._uU(3,"Select layer to edit"),a.qZA(),a.YNc(4,sf,2,2,"option",3),a.qZA(),a.TgZ(5,"button",4),a.NdJ("click",function(){return e.startEndEditing()}),a._uU(6),a.qZA(),a.TgZ(7,"button",5),a.NdJ("click",function(){return e.switchStartInteractions("add")}),a._UZ(8,"i",6),a.qZA(),a.TgZ(9,"button",7),a.NdJ("click",function(){return e.switchStartInteractions("modify")}),a._UZ(10,"i",8),a.qZA(),a.TgZ(11,"button",9),a.NdJ("click",function(){return e.switchStartInteractions("drag")}),a._UZ(12,"i",10),a.qZA(),a.TgZ(13,"button",11),a.NdJ("click",function(){return e.switchStartInteractions("remove")}),a._UZ(14,"i",12),a.qZA(),a.qZA(),a.YNc(15,pf,6,4,"div",13)),2&t&&(a.xp6(1),a.Q6J("disabled",e.editorStarted),a.xp6(1),a.Q6J("ngValue",null),a.xp6(2),a.Q6J("ngForOf",e.editingLayers),a.xp6(2),a.hij(" ",e.editorStarted?"Finish and save":"Start editing"," "),a.xp6(1),a.Q6J("disabled",!e.editorStarted),a.xp6(2),a.Q6J("disabled",!e.editorStarted),a.xp6(2),a.Q6J("disabled",!e.editorStarted),a.xp6(2),a.Q6J("disabled",!e.editorStarted),a.xp6(2),a.Q6J("ngIf",e.editorStarted))},directives:[o.YN,o.Kr,n.sg,n.O5],styles:[".ol-map-editor[_ngcontent-%COMP%]{left:100px;height:50px;display:flex}.ol-map-editor[_ngcontent-%COMP%], .ol-map-editor-attributes[_ngcontent-%COMP%]{position:absolute;top:5px;padding:3px;background-color:#fff;z-index:1}.ol-map-editor-attributes[_ngcontent-%COMP%]{right:10px;overflow:auto}.feature-attributes-pnl[_ngcontent-%COMP%]{max-height:90vh}"]}),t})();const ff=["mapLayers"],gf=["mapEditor"];let _f=(()=>{class t{constructor(t,e){this.zone=t,this.cd=e,this.configs={geoserverUrl:"/geoserver"},this.extent=[-20026376.39,-20048966.1,20026376.39,20048966.1],this.mapReady=new a.vpe}ngOnInit(){"9090"==window.location.port&&(this.configs.geoserverUrl=window.location.protocol+"//"+window.location.hostname+":8080/geoserver")}ngAfterViewInit(){this.Map||this.zone.runOutsideAngular(()=>this.initMap()),setTimeout(()=>this.mapReady.emit(this.Map))}initMap(){Fl.defs("EPSG:900913","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"),Fl.defs("EPSG:27700","+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs "),Dl(Fl),this.projection=fi("EPSG:900913"),this.projection.setExtent(this.extent),this.view=new oo({center:this.center,zoom:this.zoom,projection:this.projection}),this.Map=new Vs({layers:[new vu({source:new Xu({})})],target:"map",view:this.view,controls:ns().extend([new ta({})])}),this.mapLayers.setMap(this.Map),this.mapEditor.setMap(this.Map)}addWmsLayer(t,e,i){let n=t.split(":"),o="",r=n[1];-1==r.indexOf(localStorage.getItem("username"))&&(r=localStorage.getItem("username")+"_"+r),o=n[0]+":"+r;let s=new vu({source:new Qu({url:`${this.configs.geoserverUrl}/${n[0]}/wms`,params:{LAYERS:o}})});s.set("name",o),s.set("model-name",i),s.set("type","wms"),s.set("full-name",o),s.set("geometry-type",e),s.setVisible(!0),this.Map.addLayer(s),this.Map.updateSize(),this.mapLayers.getCapabilities(),this.mapLayers.reRenderLayers(),this.mapEditor.refreshLayers()}getWmsLayer(t,e,i){let n=t.split(":"),o=new vu({source:new Qu({url:`${this.configs.geoserverUrl}/${n[0]}/wms`,params:{LAYERS:t}})});return o.set("name",t),o.set("model-name",i),o.set("type","wms"),o.set("full-name",t),o.set("geometry-type",e),o.setVisible(!0),o}removeLayer(t){let e=this.Map.getLayers().getArray();for(let i=0;i<e.length;i++)e[i].get("name")==t&&this.Map.removeLayer(e[i]);this.mapLayers.reRenderLayers(),this.mapEditor.refreshLayers()}removeLayerByModelName(t){let e=this.Map.getLayers().getArray();for(let i=0;i<e.length;i++)e[i].get("model-name")==t&&this.Map.removeLayer(e[i]);this.mapLayers.reRenderLayers(),this.mapEditor.refreshLayers(),this.Map.updateSize()}removeAllWmsLayers(){let t=this.Map.getLayers().getArray();for(let e=0;e<t.length;e++)"wms"==t[e].get("type")&&this.Map.removeLayer(t[e]);this.mapLayers.reRenderLayers(),this.mapEditor.refreshLayers()}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(a.R0b),a.Y36(a.sBO))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-ol-map"]],viewQuery:function(t,e){if(1&t&&(a.Gf(ff,5),a.Gf(gf,5)),2&t){let t;a.iGM(t=a.CRH())&&(e.mapLayers=t.first),a.iGM(t=a.CRH())&&(e.mapEditor=t.first)}},inputs:{center:"center",zoom:"zoom"},outputs:{mapReady:"mapReady"},decls:5,vars:2,consts:[["id","map",1,"map-container"],[3,"configs"],["mapLayers",""],["mapEditor",""]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a._UZ(1,"app-ol-map-layers",1,2),a._UZ(3,"app-ol-map-wms-layer-editor",1,3),a.qZA()),2&t&&(a.xp6(1),a.Q6J("configs",e.configs),a.xp6(2),a.Q6J("configs",e.configs))},directives:[ec,df],styles:[".map-container[_ngcontent-%COMP%]{width:inherit;height:inherit;z-index:1;position:relative}"]}),t})();var mf=i(4332);function yf(t){const{subscriber:e,counter:i,period:n}=t;e.next(i),this.schedule({subscriber:e,counter:i+1,period:n},n)}var vf=i(1906),xf=i(611),wf=i(6599);function bf(t,e,i){for(let n in e)if(e.hasOwnProperty(n)){const o=e[n];o?t.setProperty(n,o,(null==i?void 0:i.has(n))?"important":""):t.removeProperty(n)}return t}function Cf(t,e){const i=e?"":"none";bf(t.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":i,"-ms-user-select":i,"-webkit-user-select":i,"-moz-user-select":i})}function Mf(t,e,i){bf(t.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},i)}function Sf(t,e){return e&&"none"!=e?t+" "+e:t}function Tf(t){const e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function Pf(t,e){return t.getPropertyValue(e).split(",").map(t=>t.trim())}function Ef(t){const e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function Af(t,e,i){const{top:n,bottom:o,left:r,right:s}=t;return i>=n&&i<=o&&e>=r&&e<=s}function Lf(t,e,i){t.top+=e,t.bottom=t.top+t.height,t.left+=i,t.right=t.left+t.width}function Rf(t,e,i,n){const{top:o,right:r,bottom:s,left:a,width:h,height:l}=t,u=h*e,c=l*e;return n>o-c&&n<s+c&&i>a-u&&i<r+u}class Of{constructor(t,e){this._document=t,this._viewportRuler=e,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),t.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:Ef(t)})})}handleScroll(t){const e=(0,$.sA)(t),i=this.positions.get(e);if(!i)return null;const n=e===this._document?e.documentElement:e,o=i.scrollPosition;let r,s;if(e===this._document){const t=this._viewportRuler.getViewportScrollPosition();r=t.top,s=t.left}else r=e.scrollTop,s=e.scrollLeft;const a=o.top-r,h=o.left-s;return this.positions.forEach((t,i)=>{t.clientRect&&e!==i&&n.contains(i)&&Lf(t.clientRect,a,h)}),o.top=r,o.left=s,{top:a,left:h}}}function Zf(t){const e=t.cloneNode(!0),i=e.querySelectorAll("[id]"),n=t.nodeName.toLowerCase();e.removeAttribute("id");for(let o=0;o<i.length;o++)i[o].removeAttribute("id");return"canvas"===n?Ff(t,e):"input"!==n&&"select"!==n&&"textarea"!==n||Nf(t,e),If("canvas",t,e,Ff),If("input, textarea, select",t,e,Nf),e}function If(t,e,i,n){const o=e.querySelectorAll(t);if(o.length){const e=i.querySelectorAll(t);for(let t=0;t<o.length;t++)n(o[t],e[t])}}let kf=0;function Nf(t,e){"file"!==e.type&&(e.value=t.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${kf++}`)}function Ff(t,e){const i=e.getContext("2d");if(i)try{i.drawImage(t,0,0)}catch(n){}}const Df=(0,$.i$)({passive:!0}),qf=(0,$.i$)({passive:!1}),zf=new Set(["position"]);class jf{constructor(t,e,i,n,o,r){this._config=e,this._document=i,this._ngZone=n,this._viewportRuler=o,this._dragDropRegistry=r,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new P.xQ,this._pointerMoveSubscription=z.w.EMPTY,this._pointerUpSubscription=z.w.EMPTY,this._scrollSubscription=z.w.EMPTY,this._resizeSubscription=z.w.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new P.xQ,this.started=new P.xQ,this.released=new P.xQ,this.ended=new P.xQ,this.entered=new P.xQ,this.exited=new P.xQ,this.dropped=new P.xQ,this.moved=this._moveEvents,this._pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){const e=this._handles.find(e=>{const i=(0,$.sA)(t);return!!i&&(i===e||e.contains(i))});!e||this._disabledHandles.has(e)||this.disabled||this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)},this._pointerMove=t=>{const e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const e=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),i=this._dropContainer;if(!e)return void this._endDragSequence(t);i&&(i.isDragging()||i.isReceiving())||(t.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(t)))}return}this._boundaryElement&&(this._previewRect&&(this._previewRect.width||this._previewRect.height)||(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect())),t.preventDefault();const i=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,e);else{const t=this._activeTransform;t.x=i.x-this._pickupPositionOnPage.x+this._passiveTransform.x,t.y=i.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(t.x,t.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${t.x} ${t.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:t,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})},this._pointerUp=t=>{this._endDragSequence(t)},this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new Of(i,o),r.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){const e=(0,T.Ig)(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>Cf(t,e)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(t=>(0,T.fI)(t)),this._handles.forEach(t=>Cf(t,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(t=>{this._handles.indexOf(t)>-1&&e.add(t)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const e=(0,T.fI)(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,qf),e.addEventListener("touchstart",this._pointerDown,Df)}),this._initialTransform=void 0,this._rootElement=e),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?(0,T.fI)(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&Bf(this._rootElement),Bf(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Cf(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Cf(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&Bf(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&Bf(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){Wf(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const t=this._rootElement,i=t.parentNode,n=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment(""),r=this._getShadowRoot();i.insertBefore(o,t),this._initialTransform=t.style.transform||"",this._preview=this._createPreviewElement(),Mf(t,!1,zf),this._document.body.appendChild(i.replaceChild(n,t)),this._getPreviewInsertionPoint(i,r).appendChild(this._preview),this.started.next({source:this}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();const i=this.isDragging(),n=Wf(e),o=!n&&0!==e.button,r=this._rootElement,s=(0,$.sA)(e),a=!n&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),h=n?(0,mf.yG)(e):(0,mf.X6)(e);if(s&&s.draggable&&"mousedown"===e.type&&e.preventDefault(),i||o||a||h)return;this._handles.length&&(this._rootElementTapHighlight=r.style.webkitTapHighlightColor||"",r.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>this._updateOnScroll(t)),this._boundaryElement&&(this._boundaryRect=Ef(this._boundaryElement));const l=this._previewTemplate;this._pickupPositionInElement=l&&l.template&&!l.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);const u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){Mf(this._rootElement,!0,zf),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const e=this._dropContainer,i=e.getItemIndex(this),n=this._getPointerPositionOnPage(t),o=this._getDragDistance(n),r=e._isOverContainer(n.x,n.y);this.ended.next({source:this,distance:o,dropPoint:n}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:r,distance:o,dropPoint:n}),e.drop(this,i,this._initialIndex,this._initialContainer,r,o,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:n}){let o=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=o,this._dropContainer.enter(this,t,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,n),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_createPreviewElement(){const t=this._previewTemplate,e=this.previewClass,i=t?t.template:null;let n;if(i&&t){const e=t.matchSize?this._rootElement.getBoundingClientRect():null,o=t.viewContainer.createEmbeddedView(i,t.context);o.detectChanges(),n=Yf(o,this._document),this._previewRef=o,t.matchSize?Vf(n,e):n.style.transform=Gf(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const t=this._rootElement;n=Zf(t),Vf(n,t.getBoundingClientRect()),this._initialTransform&&(n.style.transform=this._initialTransform)}return bf(n.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},zf),Cf(n,!1),n.classList.add("cdk-drag-preview"),n.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(t=>n.classList.add(t)):n.classList.add(e)),n}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);const e=function(t){const e=getComputedStyle(t),i=Pf(e,"transition-property"),n=i.find(t=>"transform"===t||"all"===t);if(!n)return 0;const o=i.indexOf(n),r=Pf(e,"transition-duration"),s=Pf(e,"transition-delay");return Tf(r[o])+Tf(s[o])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{const i=e=>{var o;(!e||(0,$.sA)(e)===this._preview&&"transform"===e.propertyName)&&(null===(o=this._preview)||void 0===o||o.removeEventListener("transitionend",i),t(),clearTimeout(n))},n=setTimeout(i,1.5*e);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,e=t?t.template:null;let i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=Yf(this._placeholderRef,this._document)):i=Zf(this._rootElement),i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(t,e){const i=this._rootElement.getBoundingClientRect(),n=t===this._rootElement?null:t,o=n?n.getBoundingClientRect():i,r=Wf(e)?e.targetTouches[0]:e,s=this._getViewportScrollPosition();return{x:o.left-i.left+(r.pageX-o.left-s.left),y:o.top-i.top+(r.pageY-o.top-s.top)}}_getPointerPositionOnPage(t){const e=this._getViewportScrollPosition(),i=Wf(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,n=i.pageX-e.left,o=i.pageY-e.top;if(this._ownerSVGElement){const t=this._ownerSVGElement.getScreenCTM();if(t){const e=this._ownerSVGElement.createSVGPoint();return e.x=n,e.y=o,e.matrixTransform(t.inverse())}}return{x:n,y:o}}_getConstrainedPointerPosition(t){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:n}=this.constrainPosition?this.constrainPosition(t,this):t;if("x"===this.lockAxis||"x"===e?n=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==e||(i=this._pickupPositionOnPage.x),this._boundaryRect){const{x:t,y:e}=this._pickupPositionInElement,o=this._boundaryRect,r=this._previewRect,s=o.top+e,a=o.bottom-(r.height-e);i=Uf(i,o.left+t,o.right-(r.width-t)),n=Uf(n,s,a)}return{x:i,y:n}}_updatePointerDirectionDelta(t){const{x:e,y:i}=t,n=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,r=Math.abs(e-o.x),s=Math.abs(i-o.y);return r>this._config.pointerDirectionChangeThreshold&&(n.x=e>o.x?1:-1,o.x=e),s>this._config.pointerDirectionChangeThreshold&&(n.y=i>o.y?1:-1,o.y=i),n}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Cf(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,qf),t.removeEventListener("touchstart",this._pointerDown,Df)}_applyRootElementTransform(t,e){const i=Gf(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform&&"none"!=this._rootElement.style.transform?this._rootElement.style.transform:""),this._rootElement.style.transform=Sf(i,this._initialTransform)}_applyPreviewTransform(t,e){var i;const n=(null===(i=this._previewTemplate)||void 0===i?void 0:i.template)?void 0:this._initialTransform,o=Gf(t,e);this._preview.style.transform=Sf(o,n)}_getDragDistance(t){const e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(0===t&&0===e||this.isDragging()||!this._boundaryElement)return;const i=this._boundaryElement.getBoundingClientRect(),n=this._rootElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===n.width&&0===n.height)return;const o=i.left-n.left,r=n.right-i.right,s=i.top-n.top,a=n.bottom-i.bottom;i.width>n.width?(o>0&&(t+=o),r>0&&(t-=r)):t=0,i.height>n.height?(s>0&&(e+=s),a>0&&(e-=a)):e=0,t===this._passiveTransform.x&&e===this._passiveTransform.y||this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){const e=this.dragStartDelay;return"number"==typeof e?e:Wf(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){const e=this._parentPositions.handleScroll(t);if(e){const i=(0,$.sA)(t);this._boundaryRect&&(i===this._document||i!==this._boundaryElement&&i.contains(this._boundaryElement))&&Lf(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const t=this._parentPositions.positions.get(this._document);return t?t.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,$.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){const i=this._previewContainer||"global";if("parent"===i)return t;if("global"===i){const t=this._document;return e||t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement||t.body}return(0,T.fI)(i)}}function Gf(t,e){return`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}function Uf(t,e,i){return Math.max(e,Math.min(i,t))}function Bf(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Wf(t){return"t"===t.type[0]}function Yf(t,e){const i=t.rootNodes;if(1===i.length&&i[0].nodeType===e.ELEMENT_NODE)return i[0];const n=e.createElement("div");return i.forEach(t=>n.appendChild(t)),n}function Vf(t,e){t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.transform=Gf(e.left,e.top)}function Xf(t,e){return Math.max(0,Math.min(e,t))}class Hf{constructor(t,e,i,n,o){this._dragDropRegistry=e,this._ngZone=n,this._viewportRuler=o,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new P.xQ,this.entered=new P.xQ,this.exited=new P.xQ,this.dropped=new P.xQ,this.sorted=new P.xQ,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=z.w.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new P.xQ,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(t=0,e=j.P){return(!W(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=j.P),new A.y(i=>(i.add(e.schedule(yf,t,{subscriber:i,counter:0,period:t})),i))}(0,q).pipe((0,K.R)(this._stopScrollTimers)).subscribe(()=>{const t=this._scrollNode,e=this.autoScrollStep;1===this._verticalScrollDirection?Jf(t,-e):2===this._verticalScrollDirection&&Jf(t,e),1===this._horizontalScrollDirection?Qf(t,-e):2===this._horizontalScrollDirection&&Qf(t,e)})},this.element=(0,T.fI)(t),this._document=i,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new Of(i,o)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,n){let o;this._draggingStarted(),null==n?(o=this.sortingDisabled?this._draggables.indexOf(t):-1,-1===o&&(o=this._getItemIndexFromPointerPosition(t,e,i))):o=n;const r=this._activeDraggables,s=r.indexOf(t),a=t.getPlaceholderElement();let h=r[o];if(h===t&&(h=r[o+1]),s>-1&&r.splice(s,1),h&&!this._dragDropRegistry.isDragging(h)){const e=h.getRootElement();e.parentElement.insertBefore(a,e),r.splice(o,0,t)}else if(this._shouldEnterAsFirstChild(e,i)){const e=r[0].getRootElement();e.parentNode.insertBefore(a,e),r.unshift(t)}else(0,T.fI)(this.element).appendChild(a),r.push(t);a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,n,o,r,s){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:n,isPointerOverContainer:o,distance:r,dropPoint:s})}withItems(t){const e=this._draggables;return this._draggables=t,t.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(t=>t.isDragging()).every(e=>-1===t.indexOf(e))?this._reset():this._cacheItems()),this}withDirection(t){return this._direction=t,this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){return this._orientation=t,this}withScrollableParents(t){const e=(0,T.fI)(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e,...t]:t.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?Kf("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,e=>e.drag===t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,n){if(this.sortingDisabled||!this._clientRect||!Rf(this._clientRect,.05,e,i))return;const o=this._itemPositions,r=this._getItemIndexFromPointerPosition(t,e,i,n);if(-1===r&&o.length>0)return;const s="horizontal"===this._orientation,a=Kf(o,e=>e.drag===t),h=o[r],l=h.clientRect,u=a>r?1:-1,c=this._getItemOffsetPx(o[a].clientRect,l,u),p=this._getSiblingOffsetPx(a,o,u),d=o.slice();!function(t,e,i){const n=Xf(e,t.length-1),o=Xf(i,t.length-1);if(n===o)return;const r=t[n],s=o<n?-1:1;for(let a=n;a!==o;a+=s)t[a]=t[a+s];t[o]=r}(o,a,r),this.sorted.next({previousIndex:a,currentIndex:r,container:this,item:t}),o.forEach((e,i)=>{if(d[i]===e)return;const n=e.drag===t,o=n?c:p,r=n?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=o,s?(r.style.transform=Sf(`translate3d(${Math.round(e.offset)}px, 0, 0)`,e.initialTransform),Lf(e.clientRect,0,o)):(r.style.transform=Sf(`translate3d(0, ${Math.round(e.offset)}px, 0)`,e.initialTransform),Lf(e.clientRect,o,0))}),this._previousSwap.overlaps=Af(l,e,i),this._previousSwap.drag=h.drag,this._previousSwap.delta=s?n.x:n.y}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,n=0,o=0;if(this._parentPositions.positions.forEach((r,s)=>{s!==this._document&&r.clientRect&&!i&&Rf(r.clientRect,.05,t,e)&&([n,o]=function(t,e,i,n){const o=$f(e,n),r=tg(e,i);let s=0,a=0;if(o){const e=t.scrollTop;1===o?e>0&&(s=1):t.scrollHeight-e>t.clientHeight&&(s=2)}if(r){const e=t.scrollLeft;1===r?e>0&&(a=1):t.scrollWidth-e>t.clientWidth&&(a=2)}return[s,a]}(s,r.clientRect,t,e),(n||o)&&(i=s))}),!n&&!o){const{width:r,height:s}=this._viewportRuler.getViewportSize(),a={width:r,height:s,top:0,right:r,bottom:s,left:0};n=$f(a,e),o=tg(a,t),i=window}!i||n===this._verticalScrollDirection&&o===this._horizontalScrollDirection&&i===this._scrollNode||(this._verticalScrollDirection=n,this._horizontalScrollDirection=o,this._scrollNode=i,(n||o)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const t=(0,T.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const t=(0,T.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}_cacheItemPositions(){const t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const e=t.getVisibleElement();return{drag:t,offset:0,initialTransform:e.style.transform||"",clientRect:Ef(e)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_reset(){this._isDragging=!1;const t=(0,T.fI)(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{var e;const i=t.getRootElement();if(i){const n=null===(e=this._itemPositions.find(e=>e.drag===t))||void 0===e?void 0:e.initialTransform;i.style.transform=n||""}}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(t,e,i){const n="horizontal"===this._orientation,o=e[t].clientRect,r=e[t+-1*i];let s=o[n?"width":"height"]*i;if(r){const t=n?"left":"top",e=n?"right":"bottom";-1===i?s-=r.clientRect[t]-o[e]:s+=o[t]-r.clientRect[e]}return s}_getItemOffsetPx(t,e,i){const n="horizontal"===this._orientation;let o=n?e.left-t.left:e.top-t.top;return-1===i&&(o+=n?e.width-t.width:e.height-t.height),o}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,n="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){const o=i[i.length-1].clientRect;return n?t>=o.right:e>=o.bottom}{const o=i[0].clientRect;return n?t<=o.left:e<=o.top}}_getItemIndexFromPointerPosition(t,e,i,n){const o="horizontal"===this._orientation,r=Kf(this._itemPositions,({drag:r,clientRect:s},a,h)=>{if(r===t)return h.length<2;if(n){const t=o?n.x:n.y;if(r===this._previousSwap.drag&&this._previousSwap.overlaps&&t===this._previousSwap.delta)return!1}return o?e>=Math.floor(s.left)&&e<Math.floor(s.right):i>=Math.floor(s.top)&&i<Math.floor(s.bottom)});return-1!==r&&this.sortPredicate(r,t,this)?r:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(t,e){return null!=this._clientRect&&Af(this._clientRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(n=>n._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._clientRect||!Af(this._clientRect,e,i)||!this.enterPredicate(t,this))return!1;const n=this._getShadowRoot().elementFromPoint(e,i);if(!n)return!1;const o=(0,T.fI)(this.element);return n===o||o.contains(n)}_startReceiving(t,e){const i=this._activeSiblings;!i.has(t)&&e.every(t=>this.enterPredicate(t,this)||this._draggables.indexOf(t)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(t);e&&(this._itemPositions.forEach(({clientRect:t})=>{Lf(t,e.top,e.left)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=(0,$.kV)((0,T.fI)(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const t=this._activeDraggables.filter(t=>t.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}}function Kf(t,e){for(let i=0;i<t.length;i++)if(e(t[i],i,t))return i;return-1}function Jf(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function Qf(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function $f(t,e){const{top:i,bottom:n,height:o}=t,r=.05*o;return e>=i-r&&e<=i+r?1:e>=n-r&&e<=n+r?2:0}function tg(t,e){const{left:i,right:n,width:o}=t,r=.05*o;return e>=i-r&&e<=i+r?1:e>=n-r&&e<=n+r?2:0}const eg=(0,$.i$)({passive:!1,capture:!0});let ig=(()=>{class t{constructor(t,e){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=t=>t.isDragging(),this.pointerMove=new P.xQ,this.pointerUp=new P.xQ,this.scroll=new P.xQ,this._preventDefaultWhileDragging=t=>{this._activeDragInstances.length>0&&t.preventDefault()},this._persistentTouchmoveListener=t=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&t.preventDefault(),this.pointerMove.next(t))},this._document=e}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,eg)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,eg)}startDragging(t,e){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const t=e.type.startsWith("touch");this._globalListeners.set(t?"touchend":"mouseup",{handler:t=>this.pointerUp.next(t),options:!0}).set("scroll",{handler:t=>this.scroll.next(t),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:eg}),t||this._globalListeners.set("mousemove",{handler:t=>this.pointerMove.next(t),options:eg}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((t,e)=>{this._document.addEventListener(e,t.handler,t.options)})})}}stopDragging(t){const e=this._activeDragInstances.indexOf(t);e>-1&&(this._activeDragInstances.splice(e,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const e=[this.scroll];return t&&t!==this._document&&e.push(new A.y(e=>this._ngZone.runOutsideAngular(()=>{const i=t=>{this._activeDragInstances.length&&e.next(t)};return t.addEventListener("scroll",i,!0),()=>{t.removeEventListener("scroll",i,!0)}}))),(0,vf.T)(...e)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,e)=>{this._document.removeEventListener(e,t.handler,t.options)}),this._globalListeners.clear()}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(a.R0b),a.LFG(n.K0))},t.\u0275prov=a.Yz7({factory:function(){return new t(a.LFG(a.R0b),a.LFG(n.K0))},token:t,providedIn:"root"}),t})();const ng={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let og=(()=>{class t{constructor(t,e,i,n){this._document=t,this._ngZone=e,this._viewportRuler=i,this._dragDropRegistry=n}createDrag(t,e=ng){return new jf(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Hf(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(n.K0),a.LFG(a.R0b),a.LFG(nt),a.LFG(ig))},t.\u0275prov=a.Yz7({factory:function(){return new t(a.LFG(n.K0),a.LFG(a.R0b),a.LFG(nt),a.LFG(ig))},token:t,providedIn:"root"}),t})();const rg=new a.OlP("CDK_DRAG_PARENT"),sg=new a.OlP("CDK_DRAG_CONFIG"),ag=new a.OlP("CdkDropList"),hg=new a.OlP("CdkDragHandle"),lg=new a.OlP("CdkDragPlaceholder"),ug=new a.OlP("CdkDragPreview");let cg=(()=>{class t{constructor(e,i,n,o,r,s,h,l,u,c,p){this.element=e,this.dropContainer=i,this._ngZone=o,this._viewContainerRef=r,this._dir=h,this._changeDetectorRef=u,this._selfHandle=c,this._parentDrag=p,this._destroyed=new P.xQ,this.started=new a.vpe,this.released=new a.vpe,this.ended=new a.vpe,this.entered=new a.vpe,this.exited=new a.vpe,this.dropped=new a.vpe,this.moved=new A.y(t=>{const e=this._dragRef.moved.pipe((0,O.U)(t=>({source:this,pointerPosition:t.pointerPosition,event:t.event,delta:t.delta,distance:t.distance}))).subscribe(t);return()=>{e.unsubscribe()}}),this._dragRef=l.createDrag(e,{dragStartThreshold:s&&null!=s.dragStartThreshold?s.dragStartThreshold:5,pointerDirectionChangeThreshold:s&&null!=s.pointerDirectionChangeThreshold?s.pointerDirectionChangeThreshold:5,zIndex:null==s?void 0:s.zIndex}),this._dragRef.data=this,t._dragInstances.push(this),s&&this._assignDefaults(s),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=(0,T.Ig)(t),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,xf.q)(1),(0,K.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const e=t.rootElementSelector,i=t.freeDragPosition;e&&!e.firstChange&&this._updateRootElement(),i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const e=t._dragInstances.indexOf(this);e>-1&&t._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement,e=this.rootElementSelector?pg(t,this.rootElementSelector):t;this._dragRef.withRootElement(e||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?pg(this.element.nativeElement,t):(0,T.fI)(t):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const t=this._dir,i=this.dragStartDelay,n=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay="object"==typeof i&&i?i:(0,T.su)(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(n).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),t&&e.withDirection(t.value)}}),e.beforeStarted.pipe((0,xf.q)(1)).subscribe(()=>{var i,n;if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let o=this.element.nativeElement.parentElement;for(;o;){if(null===(i=o.classList)||void 0===i?void 0:i.contains("cdk-drag")){e.withParent((null===(n=t._dragInstances.find(t=>t.element.nativeElement===o))||void 0===n?void 0:n._dragRef)||null);break}o=o.parentElement}})}_handleEvents(t){t.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(()=>{this.released.emit({source:this})}),t.ended.subscribe(t=>{this.ended.emit({source:this,distance:t.distance,dropPoint:t.dropPoint}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(t=>{this.entered.emit({container:t.container.data,item:this,currentIndex:t.currentIndex})}),t.exited.subscribe(t=>{this.exited.emit({container:t.container.data,item:this})}),t.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,isPointerOverContainer:t.isPointerOverContainer,item:this,distance:t.distance,dropPoint:t.dropPoint})})}_assignDefaults(t){const{lockAxis:e,dragStartDelay:i,constrainPosition:n,previewClass:o,boundaryElement:r,draggingDisabled:s,rootElementSelector:a,previewContainer:h}=t;this.disabled=null!=s&&s,this.dragStartDelay=i||0,e&&(this.lockAxis=e),n&&(this.constrainPosition=n),o&&(this.previewClass=o),r&&(this.boundaryElement=r),a&&(this.rootElementSelector=a),h&&(this.previewContainer=h)}_setupHandlesListener(){this._handles.changes.pipe((0,J.O)(this._handles),(0,wf.b)(t=>{const e=t.filter(t=>t._parentDrag===this).map(t=>t.element);this._selfHandle&&this.rootElementSelector&&e.push(this.element),this._dragRef.withHandles(e)}),(0,Q.w)(t=>(0,vf.T)(...t.map(t=>t._stateChanges.pipe((0,J.O)(t))))),(0,K.R)(this._destroyed)).subscribe(t=>{const e=this._dragRef,i=t.element.nativeElement;t.disabled?e.disableHandle(i):e.enableHandle(i)})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(a.SBq),a.Y36(ag,12),a.Y36(n.K0),a.Y36(a.R0b),a.Y36(a.s_b),a.Y36(sg,8),a.Y36(tt.Is,8),a.Y36(og),a.Y36(a.sBO),a.Y36(hg,10),a.Y36(rg,12))},t.\u0275dir=a.lG2({type:t,selectors:[["","cdkDrag",""]],contentQueries:function(t,e,i){if(1&t&&(a.Suo(i,ug,5),a.Suo(i,lg,5),a.Suo(i,hg,5)),2&t){let t;a.iGM(t=a.CRH())&&(e._previewTemplate=t.first),a.iGM(t=a.CRH())&&(e._placeholderTemplate=t.first),a.iGM(t=a.CRH())&&(e._handles=t)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,e){2&t&&a.ekj("cdk-drag-disabled",e.disabled)("cdk-drag-dragging",e._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],previewContainer:["cdkDragPreviewContainer","previewContainer"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[a._Bn([{provide:rg,useExisting:t}]),a.TTD]}),t._dragInstances=[],t})();function pg(t,e){let i=t.parentElement;for(;i;){if(i.matches?i.matches(e):i.msMatchesSelector(e))return i;i=i.parentElement}return null}let dg=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({providers:[og],imports:[ot]}),t})();const fg=["mapComponent"];function gg(t,e){1&t&&(a.TgZ(0,"div",30),a._UZ(1,"div",31),a.qZA())}function _g(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",32),a.TgZ(1,"div",33),a.NdJ("click",function(e){const i=a.CHM(t).$implicit;return a.oxw().dropNewModel(e,i)}),a.TgZ(2,"div",34),a.TgZ(3,"p",35),a._uU(4),a.qZA(),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=e.$implicit;a.xp6(4),a.hij(" ",t.name," ")}}function mg(t,e){1&t&&(a.TgZ(0,"div",45),a.TgZ(1,"div"),a._uU(2,"Running"),a.qZA(),a._UZ(3,"div",46),a.qZA())}function yg(t,e){1&t&&(a.TgZ(0,"div",45),a.TgZ(1,"div",47),a._uU(2,"Completed"),a.qZA(),a._UZ(3,"div",48),a.qZA())}const vg=function(){return{"background-color":"white"}},xg=function(){return{"background-color":"#3ed63e"}},wg=function(){return{"background-color":"red"}};function bg(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",36),a.NdJ("cdkDragEnded",function(e){const i=a.CHM(t).$implicit;return a.oxw().replaceDraggedModel(e,i)}),a.TgZ(1,"div",37),a.TgZ(2,"div",38),a.TgZ(3,"div",39),a.TgZ(4,"p",40),a._uU(5),a.qZA(),a.qZA(),a.TgZ(6,"div",41),a.TgZ(7,"button",42),a.NdJ("click",function(){const e=a.CHM(t),i=e.index,n=e.$implicit;return a.oxw().editDraggedModelInput(i,n)}),a._uU(8," Inputs "),a.qZA(),a.TgZ(9,"button",43),a.NdJ("click",function(){const e=a.CHM(t),i=e.index,n=e.$implicit;return a.oxw().removeDraggedModel(i,n)}),a._uU(10," Remove "),a.qZA(),a.qZA(),a.TgZ(11,"div"),a.YNc(12,mg,4,0,"div",44),a.YNc(13,yg,4,0,"div",44),a.qZA(),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=e.$implicit,i=e.index;a.Q6J("ngStyle",0==t.isCompleted&&0==t.hasError?a.DdM(7,vg):1==t.isCompleted&&0==t.hasError?a.DdM(8,xg):a.DdM(9,wg)),a.xp6(1),a.Q6J("id","start_"+i),a.xp6(4),a.hij(" ",t.name," "),a.xp6(2),a.Q6J("disabled",t.isRunning),a.xp6(2),a.Q6J("disabled",t.isRunning),a.xp6(3),a.Q6J("ngIf",t.isRunning),a.xp6(1),a.Q6J("ngIf",t.isCompleted)}}function Cg(t,e){if(1&t&&(a.TgZ(0,"div"),a.TgZ(1,"p"),a._uU(2),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(2),a.hij(" ",t," ")}}function Mg(t,e){if(1&t&&(a.TgZ(0,"div",49),a.TgZ(1,"h3"),a.TgZ(2,"b"),a._uU(3,"Terminal"),a.qZA(),a.qZA(),a.YNc(4,Cg,3,1,"div",50),a.qZA()),2&t){const t=a.oxw();a.xp6(4),a.Q6J("ngForOf",t.terminalDetails)}}function Sg(t,e){if(1&t&&(a.O4$(),a._UZ(0,"line",51)),2&t){const t=e.$implicit;a.uIk("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function Tg(t,e){if(1&t&&(a.TgZ(0,"tr"),a.TgZ(1,"td"),a._uU(2),a.qZA(),a.TgZ(3,"td"),a._uU(4),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(2),a.Oqu(t.cluster_id),a.xp6(2),a.Oqu(t.sum_pon_homes)}}function Pg(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div"),a.TgZ(1,"div",52),a.TgZ(2,"table",53),a.TgZ(3,"thead"),a.TgZ(4,"th"),a._uU(5,"Cluster Id"),a.qZA(),a.TgZ(6,"th"),a._uU(7,"Sum Pon Homes"),a.qZA(),a.qZA(),a.TgZ(8,"tbody"),a.YNc(9,Tg,5,2,"tr",50),a.qZA(),a.qZA(),a.qZA(),a.TgZ(10,"form",54),a.NdJ("ngSubmit",function(){return a.CHM(t),a.oxw().onSubmitClusterCorrection()}),a.TgZ(11,"div",55),a.TgZ(12,"label",56),a._uU(13,"Input Cluster Id"),a.qZA(),a._UZ(14,"input",57),a.qZA(),a.TgZ(15,"div",58),a.TgZ(16,"label",56),a._uU(17,"Output Cluster Id"),a.qZA(),a._UZ(18,"input",59),a.qZA(),a.TgZ(19,"div",58),a.TgZ(20,"label",60),a._uU(21,"GIS Tool Id"),a.qZA(),a._UZ(22,"input",61),a.qZA(),a.TgZ(23,"div",62),a.TgZ(24,"button",63),a._uU(25,"Execute"),a.qZA(),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(9),a.Q6J("ngForOf",t.outliers_data),a.xp6(1),a.Q6J("formGroup",t.clusterCorrectionForm)}}function Eg(t,e){if(1&t&&(a.TgZ(0,"div",55),a.TgZ(1,"label",56),a._uU(2),a.qZA(),a.TgZ(3,"input",72),a.NdJ("ngModelChange",function(t){return e.$implicit.value=t}),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(2),a.Oqu(t.label),a.xp6(1),a.Q6J("type",t.type)("ngModel",t.value)}}function Ag(t,e){if(1&t&&(a.TgZ(0,"option",75),a._uU(1),a.qZA()),2&t){const t=e.$implicit;a.Q6J("value",t.value),a.xp6(1),a.hij(" ",t.text," ")}}function Lg(t,e){if(1&t&&(a.TgZ(0,"div",55),a.TgZ(1,"label",56),a._uU(2),a.qZA(),a.TgZ(3,"select",73),a.NdJ("ngModelChange",function(t){return e.$implicit.value=t}),a.YNc(4,Ag,2,2,"option",74),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(2),a.Oqu(t.label),a.xp6(1),a.Q6J("ngModel",t.value),a.xp6(1),a.Q6J("ngForOf",t.options)}}function Rg(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",55),a.TgZ(1,"label",56),a._uU(2),a.qZA(),a.TgZ(3,"input",76),a.NdJ("change",function(e){const i=a.CHM(t).$implicit;return a.oxw(2).currentModelFilesDropped(e,i.name)}),a.qZA(),a.qZA()}if(2&t){const t=e.$implicit;a.xp6(2),a.Oqu(t.label)}}function Og(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",64),a.TgZ(1,"div",65),a.TgZ(2,"h4",66),a._uU(3),a.qZA(),a.qZA(),a.TgZ(4,"div",67),a.YNc(5,Eg,4,3,"div",68),a.YNc(6,Lg,5,3,"div",68),a.YNc(7,Rg,4,1,"div",68),a.TgZ(8,"div",69),a.TgZ(9,"button",70),a.NdJ("click",function(){return a.CHM(t),a.oxw().hideDialog()}),a._uU(10,"Ok"),a.qZA(),a.TgZ(11,"button",71),a.NdJ("click",function(){return a.CHM(t),a.oxw().hideDialogWithCancel()}),a._uU(12," Cancel "),a.qZA(),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(3),a.hij(" ",t.currentDraggedNewModel.name," "),a.xp6(2),a.Q6J("ngForOf",t.currentDraggedNewModel.form.inputs),a.xp6(1),a.Q6J("ngForOf",t.currentDraggedNewModel.form.inputSelects),a.xp6(1),a.Q6J("ngForOf",t.currentDraggedNewModel.form.inputFiles)}}const Zg=function(t){return[t,7025785.89186]},Ig=function(t){return{in:t}},kg=function(t,e){return{display:t,opacity:e}};let Ng=(()=>{class t{constructor(t,e,i,n){this.httpClient=t,this.formBuilder=e,this.zone=i,this.activatedRoute=n,this.exportStatus="none",this.loadingLoader=!1,this.outliers_data=[],this.isShowTerminal=!1,this.mainApi=s.N.api+"/api/",this.currentDraggedNewModel=null,this.currentMode="create",this.currentEditIndex=-1,this.currentExecuteNodeIndex=-1,this.mainNodes=[{name:"Cluster Boundary",key:"secondary_clusterbndry",result:{},formData:null,form:{endpointApi:"secondary_clusterbndry"}},{name:"Fully UG Cluster Grouping",key:"ug_page",result:{},formData:null,form:{endpointApi:"ug_page"}},{name:"Nodeplacement",key:"hybrid_nodeplacement",result:{},formData:null,form:{endpointApi:"secondary_hybrid_np"}},{name:"Node Boundary ",key:"node_boundary",result:{},formData:null,form:{endpointApi:"nb_page"}},{name:"PN Nodeplacement",key:"secondary_pn_np",result:{},formData:null,form:{endpointApi:"secondary_pn_np"}},{name:"Cabinet Placement",key:"secondary_cp",result:{},formData:null,form:{endpointApi:"secondary_cp"}},{name:"Cluster Corrections",key:"cluster_corrections",result:{},formData:null,form:{endpointApi:"update_db",renderData:"",loadRenderData:function(){this.httpClient.get(this.mainApi+"load_data?username="+localStorage.getItem("username")).subscribe(t=>{let e=[];for(var i=0;i<t.cluster_id.length;i++)console.log(t.cluster_id[i]),e.push({cluster_id:t.cluster_id[i],sum_pon_homes:t.sum_pon_homes[i]})})}}},{name:"Add address creation",key:"secondary_add_page",result:{},formData:null,form:{endpointApi:"secondary_add_page"}},{name:"Distribution network",key:"secondary_dis_page",result:{},formData:null,form:{endpointApi:"secondary_dis_page"}},{name:"Brownfield cluster grouping",key:"bf_page",result:{},formData:null,form:{endpointApi:"bf_page"}},{name:"Core Network",key:"secondary_core_page",result:{},formData:null,form:{endpointApi:"secondary_core_page"}},{name:"Secondary Nodeboundary",key:"secondary_nodeboundary",result:{},formData:null,form:{endpointApi:"snboundary_page"}}],this.draggedNodes=[],this.lines=[],this.terminalDetails=[],this.visible=!1,this.visibleAnimate=!1}dropNewModel(t,e){if("google"==this.activatedRoute.snapshot.params.type);else{if(0==this.draggedNodes.length&&"secondary_clusterbndry"!=e.key&&"ug_page"!=e.key&&"secondary_pn_np"!=e.key)return void alert("Warning!!! First model should be one of the following: Cluster Boundary, Fully UG Cluster Grouping, PN Nodeplacement!");if(0==this.draggedNodes.length&&"cluster_corrections"==e.key)return void alert("Warning!!! Before cluster corrections model should be selected cluster grouping model!")}let i=JSON.parse(JSON.stringify(e)),n=Date.now().toString(36)+Math.random().toString(36).substring(2);i.modelName=e.key+n,this.currentDraggedNewModel=i,this.currentMode="create",this.currentDraggedNewModel.form.showInputsFormOnDrag?this.showDialog():(this.draggedNodes.push(this.currentDraggedNewModel),this.currentDraggedNewModel=null)}replaceDraggedModel(t,e){e.dragPosition.x=t.dropPoint.x,e.dragPosition.y=t.dropPoint.y,this.refreshLines()}removeItem(t,e){this.draggedNodes.length>0&&"secondary_clusterbndry"!=this.draggedNodes[0].key&&"ug_page"!=this.draggedNodes[0].key?alert("Warning!!! First model should be one of the following: Cluster Boundary, Fully UG Cluster Grouping!"):this.draggedNodes.splice(t,0)}removeDraggedModel(t,e){this.mapComponent.removeLayerByModelName(this.draggedNodes[t].modelName),this.draggedNodes.splice(t,1),this.refreshLines()}editDraggedModelInput(t,e){this.currentEditIndex=t,this.currentDraggedNewModel=e,this.currentMode="edit",this.showDialog()}ngOnInit(){"google"==this.activatedRoute.snapshot.params.type&&(this.mainNodes=[{name:"Google api fetch",key:"google_api_fetch",result:{},formData:null,form:{endpointApi:"upload_streetcenterline",showInputsFormOnDrag:!0,inputFiles:[{label:"Street center line files",name:"streetcenterline_files",files:[]}]}}]);let t=[];this.mainNodes.forEach(e=>{t.push({name:e.name,key:e.key,result:null,formData:null,form:e.form,isRunning:!1,isCompleted:!1,hasError:!1,dragPosition:{x:310,y:null}})}),this.mainNodes=t,this.clusterCorrectionForm=this.formBuilder.group({input_cluster_id:[""],output_cluster_id:[""],gis_tool_id:[""]}),"9090"==window.location.port&&(this.mainApi=window.location.protocol+"//"+window.location.hostname+":5000/")}showTerminal(){this.isShowTerminal=!0}currentModelFilesDropped(t,e){for(let i=0;i<this.currentDraggedNewModel.form.inputFiles.length;i++)if(this.currentDraggedNewModel.form.inputFiles[i].name==e)for(let e=0;e<t.target.files.length;e++)this.currentDraggedNewModel.form.inputFiles[i].files.push({file:t.target.files[e]})}showDialog(){this.visible=!0,setTimeout(()=>this.visibleAnimate=!0,100)}hideDialog(){this.visibleAnimate=!1,"create"==this.currentMode?this.draggedNodes.push(this.currentDraggedNewModel):this.draggedNodes[this.currentEditIndex]=this.currentDraggedNewModel,this.currentDraggedNewModel=null,this.currentMode="",setTimeout(()=>this.visible=!1,300),this.refreshLines()}hideDialogWithCancel(){this.visibleAnimate=!1,this.currentMode="",this.currentDraggedNewModel=null,setTimeout(()=>this.visible=!1,300)}refreshLines(){this.lines=[],this.draggedNodes.length>1&&setTimeout(()=>{for(let t=1;t<this.draggedNodes.length;t++){const e=document.querySelector("#start_"+(t-1)),i=document.querySelector("#start_"+t),n=e.getBoundingClientRect(),o=i.getBoundingClientRect();this.lines.push({x1:n.right-25,y1:n.top+20,x2:o.left-18,y2:o.top+20})}})}start(){for(let t=0;t<this.draggedNodes.length;t++){let e="";if("node_placements"==this.draggedNodes[t].key){for(let n=0;n<this.draggedNodes[t].form.inputSelects.length;n++)if("cluster_type"==this.draggedNodes[t].form.inputSelects[n].name){e="1"==this.draggedNodes[t].form.inputSelects[n].value?"aerial_page":"ug_page","node_placements"==this.draggedNodes[t].key&&(e="1"==this.draggedNodes[t].form.inputSelects[n].value?"np_page":"np_ug_page");break}}else e=this.draggedNodes[t].form.endpointApi;e=`${this.mainApi}${e}`,this.draggedNodes[t].form.endpointApi=e;const i=new FormData;if(i.append("username",localStorage.getItem("username")),this.draggedNodes[t].form.inputs)for(let n=0;n<this.draggedNodes[t].form.inputs.length;n++)i.append(this.draggedNodes[t].form.inputs[n].name,this.draggedNodes[t].form.inputs[n].value);if(this.draggedNodes[t].form.inputFiles)for(let n=0;n<this.draggedNodes[t].form.inputFiles.length;n++){let e=this.draggedNodes[t].form.inputFiles[n];for(let t=0;t<e.files.length;t++)i.append(e.name,e.files[t].file)}this.draggedNodes[t].formData=i}this.draggedNodes.length>0&&(this.draggedNodes[0].isRunning=!0,this.terminalDetails.push(this.draggedNodes[0].name+" run started ....."),this.httpClient.post(this.draggedNodes[0].form.endpointApi,this.draggedNodes[0].formData).subscribe(t=>{if(this.draggedNodes[0].isRunning=!1,this.draggedNodes[0].isCompleted=!0,this.draggedNodes[0].result=t,this.terminalDetails.push(this.draggedNodes[0].name+" run completed successfully"),"google_api_fetch"==this.draggedNodes[0].key){const t=new FormData;t.append("city_name",localStorage.getItem("username")),this.httpClient.post("/api/google_api_fetch",t).subscribe(t=>{alert("google_api_fetch success")},t=>{alert("google_api_fetch error")})}},t=>{console.error(t),this.draggedNodes[0].isCompleted=!0,this.draggedNodes[0].hasError=!0,this.terminalDetails.push(this.draggedNodes[0].name+" run completed with error")},()=>{this.draggedNodes.length>1&&("cluster_corrections"==this.draggedNodes[1].key?(this.loadClusterCorrections(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)},2e3),this.draggedNodes[1].isRunning=!0,this.currentExecuteNodeIndex=1):"distribution_network"==this.draggedNodes[1].key?(setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)},2e3),this.draggedNodes[1].isRunning=!0,this.currentExecuteNodeIndex=1,this.loopPostRequestThroughDraggedModels(1)):this.loopPostRequestThroughDraggedModels(1)),this.showUpdateMap()}))}loopPostRequestThroughDraggedModels(t){if(this.currentExecuteNodeIndex=t,t<=this.draggedNodes.length-1){if("cluster_corrections"==this.draggedNodes[t].key)return this.loadClusterCorrections(),this.showUpdateMap(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)},2e3),void(this.draggedNodes[t].isRunning=!0);"distribution_network"==this.draggedNodes[t].key&&(setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)},2e3),this.draggedNodes[t].isRunning=!0),this.draggedNodes[t].isRunning=!0,this.terminalDetails.push(this.draggedNodes[t].name+" run started ....."),this.httpClient.post(this.draggedNodes[t].form.endpointApi,this.draggedNodes[t].formData).subscribe(e=>{this.draggedNodes[t].result=e,this.terminalDetails.push(this.draggedNodes[t].name+" run completed successfully"),this.showUpdateMap()},e=>{console.error(e),this.draggedNodes[t].hasError=!0,this.terminalDetails.push(this.draggedNodes[t].name+" run completed with error")},()=>{this.draggedNodes[t].isRunning=!1,this.draggedNodes[t].isCompleted=!0,this.loopPostRequestThroughDraggedModels(t+1)})}}showUpdateMap(){setTimeout(()=>{for(let t=0;t<this.draggedNodes.length;t++)if("cluster_corrections"!=this.draggedNodes[t].key&&this.draggedNodes[t].result)switch(this.mapComponent.removeLayerByModelName(this.draggedNodes[t].modelName),this.draggedNodes[t].key){case"node_placements":if(200===this.draggedNodes[t].result.status)for(let e=0;e<this.draggedNodes[t].result.table_name.length;e++)"joined_cluster_id"!=this.draggedNodes[t].result.table_name[e]&&"outlier_output"!=this.draggedNodes[t].result.table_name[e]&&this.mapComponent.addWmsLayer(this.draggedNodes[t].result.workspace_name+":sample_flask_"+this.draggedNodes[t].result.table_name[e],"Point",this.draggedNodes[t].modelName);break;case"bf_page":case"secondary_core_page":case"secondary_drop_ug_page":case"secondary_dis_page":case"secondary_add_page":case"secondary_nodeboundary":case"secondary_clusterbndry":case"secondary_hybrid_np":case"secondary_nodeboundary":case",secondary_cp":if(200===this.draggedNodes[t].result.status)for(let e=0;e<this.draggedNodes[t].result.table_name.length;e++)this.draggedNodes[t].result.table_name[e]&&this.mapComponent.addWmsLayer(this.draggedNodes[t].result.workspace_name+":sample_flask_"+this.draggedNodes[t].result.table_name[e],"Point",this.draggedNodes[t].modelName);break;case"node_boundary":200===this.draggedNodes[t].result.status&&this.mapComponent.addWmsLayer(this.draggedNodes[t].result.workspace+":"+this.draggedNodes[t].result.sample_flask,"Polygon",this.draggedNodes[t].modelName);break;case"distribution_network":200===this.draggedNodes[t].result.status&&(this.mapComponent.addWmsLayer(this.draggedNodes[t].result.workspace_name+":sample_flask_"+this.draggedNodes[t].result.table_name[0],"Point",this.draggedNodes[t].modelName),this.mapComponent.addWmsLayer(this.draggedNodes[t].result.workspace_name+":sample_flask_"+this.draggedNodes[t].result.table_name[1],"Point",this.draggedNodes[t].modelName))}},1e3)}onContainerClicked(t){t.target.classList.contains("modal")}loadClusterCorrections(){this.httpClient.get(this.mainApi+"load_data?username="+localStorage.getItem("username")).subscribe(t=>{for(var e=0;e<t.cluster_id.length;e++)console.log(t.cluster_id[e]),this.outliers_data.push({cluster_id:t.cluster_id[e],sum_pon_homes:t.sum_pon_homes[e]})})}onSubmitClusterCorrection(){const t=new FormData;t.append("input_cluster_id",this.clusterCorrectionForm.value.input_cluster_id),t.append("output_cluster_id",this.clusterCorrectionForm.value.output_cluster_id),t.append("gis_tool_id",this.clusterCorrectionForm.value.gis_tool_id),t.append("username",localStorage.getItem("username")),this.loadingLoader=!0,this.httpClient.post(`${this.mainApi}update_db`,t).subscribe(t=>{this.outliers_data=[];for(var e=0;e<t.cluster_id.length;e++)console.log(t.cluster_id[e]),this.outliers_data.push({cluster_id:t.cluster_id[e],sum_pon_homes:t.sum_pon_homes[e]});this.mapComponent.removeLayerByModelName(this.draggedNodes[this.currentExecuteNodeIndex].modelName),this.mapComponent.addWmsLayer(t.workspace_name+":"+t.table_name,"geometryType","cluster_corrections"+this.draggedNodes[this.currentExecuteNodeIndex].modelName)},t=>{console.error(t)},()=>{this.loadingLoader=!1})}executeNextModel(){this.draggedNodes[this.currentExecuteNodeIndex].isRunning=!1,this.draggedNodes[this.currentExecuteNodeIndex].isCompleted=!0,this.currentExecuteNodeIndex+=1,this.currentExecuteNodeIndex>this.draggedNodes.length-1||(window.scrollTo(0,0),this.loopPostRequestThroughDraggedModels(this.currentExecuteNodeIndex))}export(){this.loadingLoader=!0;const t=new FormData;t.append("username",localStorage.getItem("username")),this.httpClient.post(s.N.api+"/api/export_output",t).subscribe(e=>{this.httpClient.post("/api/download_qgis_files",t,{responseType:"arraybuffer"}).subscribe(t=>{let e=new Blob([t],{type:"application/zip"}),i=window.URL.createObjectURL(e),n=window.open(i);n&&!n.closed&&void 0!==n.closed||alert("Please disable your Pop-up blocker and try again."),alert("completed successfully"),this.loadingLoader=!1,this.exportStatus="success"},t=>{console.error(t),alert(" completed with error"),this.loadingLoader=!1,this.exportStatus="fail"},()=>{this.loadingLoader=!1})},t=>{console.error(t),alert(" completed with error"),this.loadingLoader=!1,this.exportStatus="fail"},()=>{})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(h.eN),a.Y36(o.qu),a.Y36(a.R0b),a.Y36(r.gz))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-dragdrop"]],viewQuery:function(t,e){if(1&t&&a.Gf(fg,5),2&t){let t;a.iGM(t=a.CRH())&&(e.mapComponent=t.first)}},decls:38,vars:18,consts:[["class","loader-class",4,"ngIf"],[1,"container-fluid",2,"background-color","#f5f5f5"],[1,"row"],[1,"col-2",2,"height","80vh","border-right","2px solid black","text-align","center","z-index","1","background-color","#dcdcdc","overflow-y","scroll"],["native",""],["style","display: flex; justify-content: center",4,"ngFor","ngForOf"],[1,"col-10",2,"z-index","1"],["native1",""],[1,"row",2,"margin","1rem 0rem","z-index","1"],[1,"col-6",2,"text-align","center","z-index","1"],[1,"btn","btn-login",3,"click"],[1,"col-6",2,"text-align","end","z-index","1"],[1,"btn","btn-login",2,"margin-left","10px",3,"click"],["cdkScrollable","",1,"row","example-boundary",2,"height","80%","z-index","1"],["class","box","cdkDrag","","cdkDragBoundary",".example-boundary",3,"ngStyle","cdkDragEnded",4,"ngFor","ngForOf"],["class","row","style","\n          background-color: black;\n          color: white;\n          border: 1px double;\n          height: 27%;\n          overflow-y: scroll;\n          z-index: 1;\n        ",4,"ngIf"],[2,"position","absolute","left","0","top","0","width","100%","height","100%"],["id","arrow","markerWidth","10","markerHeight","10","refX","5","refY","3","orient","auto","markerUnits","strokeWidth","viewBox","0 0 20 20"],["d","M0,0 L0,6 L9,3 z","fill","blue"],["stroke","#f00","stroke-width","3","marker-end","url(#arrow)",4,"ngFor","ngForOf"],[1,"container-fluid",2,"background-color","#f5f5f5","margin-top","200px"],[1,"col-3"],[4,"ngIf"],["type","button",1,"btn","btn-success",3,"click"],[1,"col-9"],[1,"map",3,"center","zoom"],["mapComponent",""],["tabindex","-1",1,"modal","fade",2,"background","#8080804f",3,"ngClass","ngStyle","click"],[1,"modal-dialog",2,"margin-top","10%"],["class","modal-content",4,"ngIf"],[1,"loader-class"],[1,"loader"],[2,"display","flex","justify-content","center"],[1,"example-box",2,"width","180px","height","50px","margin","5px",3,"click"],[1,"row",2,"display","flex","justify-content","center","align-items","center"],[2,"font-size","10px","margin-left","5px"],["cdkDrag","","cdkDragBoundary",".example-boundary",1,"box",3,"ngStyle","cdkDragEnded"],[1,"row",3,"id"],[1,"col-12"],[2,"display","flex","align-items","center"],[2,"font-size","10px","margin-right","0px"],[2,"display","flex"],[1,"btn","btn-sm","btn-info",2,"font-size","10px","color","white",3,"disabled","click"],[1,"btn","btn-sm","btn-warning",2,"font-size","10px","color","white",3,"disabled","click"],["style","\n                    display: flex;\n                    justify-content: end;\n                    align-items: center;\n                    font-size: 8px;\n                  ",4,"ngIf"],[2,"display","flex","justify-content","end","align-items","center","font-size","8px"],[1,"dotRed","mx-1"],[1,"mx-1"],[1,"dotGreen","mx-1"],[1,"row",2,"background-color","black","color","white","border","1px double","height","27%","overflow-y","scroll","z-index","1"],[4,"ngFor","ngForOf"],["stroke","#f00","stroke-width","3","marker-end","url(#arrow)"],[2,"max-height","200px","overflow","auto"],[1,"table","table-hover"],[3,"formGroup","ngSubmit"],[1,"mb-3","mt-3"],[1,"form-label"],["type","text","placeholder","01","formControlName","input_cluster_id",1,"form-control"],[1,"mb-3"],["type","text","placeholder","02","formControlName","output_cluster_id",1,"form-control"],[1,"fw-bold"],["type","text","placeholder","03","formControlName","gis_tool_id",1,"form-control"],[1,"d-grid","gap-2","mb-3","col-3","mx-auto"],["type","submit",1,"btn","btn-primary"],[1,"modal-content"],[1,"modal-header"],[1,"text-center","text-warning","p-2","mb-4","text-uppercase"],[1,"modal-body"],["class","mb-3 mt-3",4,"ngFor","ngForOf"],[1,"gap-2","mb-3","col-3","mx-auto",2,"display","flex"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"form-control",3,"type","ngModel","ngModelChange"],[1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","file","multiple","",1,"form-control",3,"change"]],template:function(t,e){1&t&&(a.YNc(0,gg,2,0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"div",3,4),a.YNc(5,_g,5,1,"div",5),a.qZA(),a.TgZ(6,"div",6,7),a.TgZ(8,"div",8),a.TgZ(9,"div",9),a.TgZ(10,"button",10),a.NdJ("click",function(){return e.start()}),a._uU(11,"Start"),a.qZA(),a.qZA(),a.TgZ(12,"div",11),a.TgZ(13,"button",10),a.NdJ("click",function(){return e.showTerminal()}),a._uU(14," Show Terminal "),a.qZA(),a.TgZ(15,"button",12),a.NdJ("click",function(){return e.export()}),a._uU(16," Export "),a.qZA(),a.qZA(),a.qZA(),a.TgZ(17,"div",13),a.YNc(18,bg,14,10,"div",14),a.qZA(),a.YNc(19,Mg,5,1,"div",15),a.qZA(),a.qZA(),a.O4$(),a.TgZ(20,"svg",16),a.TgZ(21,"defs"),a.TgZ(22,"marker",17),a._UZ(23,"path",18),a.qZA(),a.qZA(),a.YNc(24,Sg,1,4,"line",19),a.qZA(),a.qZA(),a.kcU(),a.TgZ(25,"div",20),a.TgZ(26,"div",2),a.TgZ(27,"div",21),a.TgZ(28,"div"),a.YNc(29,Pg,26,2,"div",22),a.TgZ(30,"button",23),a.NdJ("click",function(){return e.executeNextModel()}),a._uU(31," Go to next model "),a.qZA(),a.qZA(),a.qZA(),a.TgZ(32,"div",24),a._UZ(33,"app-ol-map",25,26),a.qZA(),a.qZA(),a.qZA(),a.TgZ(35,"div",27),a.NdJ("click",function(t){return e.onContainerClicked(t)}),a.TgZ(36,"div",28),a.YNc(37,Og,13,4,"div",29),a.qZA(),a.qZA()),2&t&&(a.Q6J("ngIf",e.loadingLoader),a.xp6(5),a.Q6J("ngForOf",e.mainNodes),a.xp6(13),a.Q6J("ngForOf",e.draggedNodes),a.xp6(1),a.Q6J("ngIf",e.isShowTerminal),a.xp6(5),a.Q6J("ngForOf",e.lines),a.xp6(5),a.Q6J("ngIf",e.currentExecuteNodeIndex>-1&&e.draggedNodes.length>e.currentExecuteNodeIndex&&"cluster_corrections"==e.draggedNodes[e.currentExecuteNodeIndex].key),a.xp6(4),a.Q6J("center",a.VKq(11,Zg,-59559.728708))("zoom",10),a.xp6(2),a.Q6J("ngClass",a.VKq(13,Ig,e.visibleAnimate))("ngStyle",a.WLB(15,kg,e.visible?"block":"none",e.visibleAnimate?1:0)),a.xp6(2),a.Q6J("ngIf",e.currentDraggedNewModel))},directives:[n.O5,n.sg,it,_f,n.mk,n.PC,cg,o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,o.On,o.EJ,o.YN,o.Kr],styles:[".box[_ngcontent-%COMP%]{border:1px solid #ccc;color:#000000de;cursor:move;display:flex;height:80px;width:160px;align-items:center;text-align:center;background:#fff;border-radius:4px;position:relative;z-index:1;transition:box-shadow .2s cubic-bezier(0,0,.2,1);box-shadow:0 3px 1px -2px #0003,0 2px 2px 0 #00000024,0 1px 5px 0 #0000001f}.box[_ngcontent-%COMP%]:active{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}p[_ngcontent-%COMP%]{margin:0 5px 0 0}.dotRed[_ngcontent-%COMP%]{background-color:red}.dotGreen[_ngcontent-%COMP%], .dotRed[_ngcontent-%COMP%]{height:.5rem;width:.5rem;border-radius:50%}.dotGreen[_ngcontent-%COMP%]{background-color:#075007}.input-line[_ngcontent-%COMP%]{display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;clear:both}.input-line[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){box-flex:1}.prompt[_ngcontent-%COMP%]{white-space:nowrap;color:#96b38a;margin-right:7px;display:-webkit-box;-webkit-box-pack:center;-webkit-box-orient:vertical;display:-moz-box;-moz-box-pack:center;display:box;box-pack:center;box-orient:vertical;-webkit-user-select:none;user-select:none}.cmdline[_ngcontent-%COMP%]{outline:none;background-color:initial;margin:0;width:100%;font:inherit;border:none;color:inherit}.ls-files[_ngcontent-%COMP%]{height:45px;-o-column-width:100px;column-width:100px}.clock-container[_ngcontent-%COMP%]{display:none;position:relative;width:200px;vertical-align:middle;overflow:hidden}.clock-container[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%] > circle[_ngcontent-%COMP%]{stroke-width:2px;stroke:#fff}.hour[_ngcontent-%COMP%], .min[_ngcontent-%COMP%], .sec[_ngcontent-%COMP%]{stroke-width:1px;fill:#333;stroke:#555}.sec[_ngcontent-%COMP%]{stroke:#f55}.col_mg[_ngcontent-%COMP%]{padding:0!important}.row[_ngcontent-%COMP%]{margin-left:0!important}.example-box[_ngcontent-%COMP%]{border:1px solid #ccc;color:#000000de;cursor:pointer;display:flex;justify-content:center;align-items:center;text-align:center;background:#fff;border-radius:4px;position:relative;z-index:1;transition:box-shadow .2s cubic-bezier(0,0,.2,1);box-shadow:0 3px 1px -2px #0003,0 2px 2px 0 #00000024,0 1px 5px 0 #0000001f}.example-box[_ngcontent-%COMP%]:active{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.element[_ngcontent-%COMP%]{height:80vh;width:30vw}.element1[_ngcontent-%COMP%]{height:80vh;width:70vw}.loader[_ngcontent-%COMP%]{border-radius:50%;border:16px solid #f3f3f3;border-top-color:#3498db;width:120px;height:120px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.loader-class[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:84vh;position:absolute;width:100%;z-index:500}.map[_ngcontent-%COMP%]{height:100vh;width:100%}"]}),t})();const Fg=function(){return["geoData"]},Dg=function(){return["project-management"]},qg=function(){return["connection-handeling"]},zg=function(){return["workflow/all"]};let jg=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-dashboardtiles"]],decls:76,vars:8,consts:[[1,"container-fluid"],["aria-label","breadcrumb",1,"mt-4",2,"--bs-breadcrumb-divider",">"],[1,"breadcrumb","p-4"],[1,"breadcrumb-item"],["href","#"],["aria-current","page",1,"breadcrumb-item","active"],[1,"breadcrumb-item",3,"routerLink"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body","shadow"],[1,"col-12","col-lg-4","col-md-6","col-sm-12","mt-4",3,"routerLink"],[1,"card","bg-lightBlue","text-white","o-hidden","h-100","card_hover"],[1,"card-body","align-items-center","d-flex","justify-content-center",2,"padding-bottom","0px !important"],[1,"mr-5"],[1,"dasbaord-name","text-white","text-uppercase","m-b-20"],[1,"card-body-icon"],["src","https://img.icons8.com/external-flaticons-lineal-color-flat-icons/64/000000/external-project-crowdfunding-flaticons-lineal-color-flat-icons-2.png","width","110","height","90",1,"float-right"],[1,"card","text-white","bg-yellow","o-hidden","h-100","card_hover"],[1,"card-body","align-items-center","d-flex","justify-content-center"],["src","../../assets/connection.png","width","110","height","90",1,"float-right"],[1,"col-12","col-lg-4","col-md-6","col-sm-12","mt-4"],[1,"card","text-white","bg-green","o-hidden","h-100","card_hover"],["src","../../assets/manage.png","width","110","height","90",1,"float-right"],[1,"card","text-white","bg-lightGreen","o-hidden","h-100","card_hover"],["src","../../assets/notifications.png","width","110","height","90",1,"float-right"],[1,"card","bg-blue","text-white","o-hidden","h-100","card_hover"],["src","../../assets/share.png","width","110","height","90",1,"float-right"],[1,"card","bg-sub-healthReport","text-white","o-hidden","h-100","card_hover"],["src","../../assets/workflow.png","width","110","height","90",1,"float-right"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"nav",1),a.TgZ(2,"ol",2),a.TgZ(3,"li",3),a.TgZ(4,"a",4),a._uU(5,"Home"),a.qZA(),a.qZA(),a.TgZ(6,"li",5),a._uU(7,"Dashboard"),a.qZA(),a.TgZ(8,"li",6),a._uU(9,"geoData"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(10,"div",7),a.TgZ(11,"div",8),a.TgZ(12,"div",9),a.TgZ(13,"div",10),a.TgZ(14,"div",7),a.TgZ(15,"div",11),a.TgZ(16,"a"),a.TgZ(17,"div",12),a.TgZ(18,"div",13),a.TgZ(19,"div",14),a.TgZ(20,"a",15),a.TgZ(21,"b"),a._uU(22,"Manage Project"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(23,"div",16),a._UZ(24,"img",17),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(25,"div",11),a.TgZ(26,"a"),a.TgZ(27,"div",18),a.TgZ(28,"div",19),a.TgZ(29,"div",14),a.TgZ(30,"a",15),a.TgZ(31,"b"),a._uU(32," Input Handling"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(33,"div",16),a._UZ(34,"img",20),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(35,"div",21),a.TgZ(36,"a"),a.TgZ(37,"div",22),a.TgZ(38,"div",19),a.TgZ(39,"div",14),a.TgZ(40,"a",15),a.TgZ(41,"b"),a._uU(42,"Manage Delivarables"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(43,"div",16),a._UZ(44,"img",23),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(45,"div",21),a.TgZ(46,"a"),a.TgZ(47,"div",24),a.TgZ(48,"div",19),a.TgZ(49,"div",14),a.TgZ(50,"a",15),a.TgZ(51,"b"),a._uU(52,"Notifications"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(53,"div",16),a._UZ(54,"img",25),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(55,"div",21),a.TgZ(56,"a"),a.TgZ(57,"div",26),a.TgZ(58,"div",19),a.TgZ(59,"div",14),a.TgZ(60,"a",15),a.TgZ(61,"b"),a._uU(62,"Share"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(63,"div",16),a._UZ(64,"img",27),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(65,"div",11),a.TgZ(66,"a"),a.TgZ(67,"div",28),a.TgZ(68,"div",13),a.TgZ(69,"div",14),a.TgZ(70,"a",15),a.TgZ(71,"b"),a._uU(72,"Workflow"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(73,"div",16),a._UZ(74,"img",29),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a._UZ(75,"br"),a.qZA(),a.qZA()),2&t&&(a.xp6(8),a.Q6J("routerLink",a.DdM(4,Fg)),a.xp6(7),a.Q6J("routerLink",a.DdM(5,Dg)),a.xp6(10),a.Q6J("routerLink",a.DdM(6,qg)),a.xp6(40),a.Q6J("routerLink",a.DdM(7,zg)))},directives:[r.rH],styles:[".bg-perpule[_ngcontent-%COMP%]{background-color:#6b7e9c!important}.bg-lightBlue[_ngcontent-%COMP%]{background:linear-gradient(90deg,#047edf,#90caf9)!important}.bg-blue[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fe5d70,#fe909d)}.bg-green[_ngcontent-%COMP%]{background:linear-gradient(90deg,#01a9ac,#01dbdf)}.bg-lightGreen[_ngcontent-%COMP%]{background:linear-gradient(90deg,#07cdae,#84d9d2)!important}.bg-sub-healthReport[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fe9365,#feb798)}.bg-sub-healthData[_ngcontent-%COMP%]{background-color:#c097cc!important}.bg-sub-app[_ngcontent-%COMP%]{background-color:#515151!important}.bg-yellow[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ffc107,#fff792b8)}.card-body-icon[_ngcontent-%COMP%]:hover   .someimg[_ngcontent-%COMP%]{opacity:.4;cursor:pointer}a[_ngcontent-%COMP%]{text-decoration:none}.btn-custom[_ngcontent-%COMP%]{color:#fff;background-color:#863695;border-color:#801894}.card_hover[_ngcontent-%COMP%]:hover{transition:all .2s ease-out;box-shadow:0 0 0 #26262633;top:-10px;cursor:pointer;background-color:#fcfafa}.card_hover[_ngcontent-%COMP%]{height:180px!important}"]}),t})();const Gg=function(){return["/dashboard/create-project"]};let Ug=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-project-handeling"]],decls:76,vars:2,consts:[[1,"container","mt-4"],[1,"clearfix","pb-4",3,"routerLink"],["type","button",1,"btn","btn-success","btn-md","float-right"],[1,"row"],[1,"col-12"],[1,"container"],[1,"row","bg-card"],[1,"col","align-middle"],[1,"col"],[1,"row","bg-cardmain"],["aria-hidden","true",1,"fa","fa-pencil","fa-2x"],["aria-hidden","true",1,"fa","fa-trash","fa-2x","mx-3"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"button",2),a._uU(3," Create Project "),a.qZA(),a.qZA(),a.TgZ(4,"div",3),a.TgZ(5,"div",4),a.TgZ(6,"div",5),a.TgZ(7,"div",6),a.TgZ(8,"div",7),a._uU(9,"Project Name"),a.qZA(),a.TgZ(10,"div",8),a._uU(11,"Date"),a.qZA(),a.TgZ(12,"div",8),a._uU(13,"Desc"),a.qZA(),a.TgZ(14,"div",8),a._uU(15,"Actions"),a.qZA(),a.qZA(),a.TgZ(16,"div",9),a.TgZ(17,"div",8),a._uU(18,"Project One"),a.qZA(),a.TgZ(19,"div",8),a._uU(20,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(21,"div",8),a._uU(22,"Lorem Ipsum is simply dummy text"),a.qZA(),a.TgZ(23,"div",8),a._UZ(24,"i",10),a._UZ(25,"i",11),a.qZA(),a.qZA(),a.TgZ(26,"div",9),a.TgZ(27,"div",8),a._uU(28,"Project One"),a.qZA(),a.TgZ(29,"div",8),a._uU(30,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(31,"div",8),a._uU(32,"Lorem Ipsum is simply dummy text"),a.qZA(),a.TgZ(33,"div",8),a._UZ(34,"i",10),a._UZ(35,"i",11),a.qZA(),a.qZA(),a.TgZ(36,"div",9),a.TgZ(37,"div",8),a._uU(38,"Project One"),a.qZA(),a.TgZ(39,"div",8),a._uU(40,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(41,"div",8),a._uU(42,"Lorem Ipsum is simply dummy text"),a.qZA(),a.TgZ(43,"div",8),a._UZ(44,"i",10),a._UZ(45,"i",11),a.qZA(),a.qZA(),a.TgZ(46,"div",9),a.TgZ(47,"div",8),a._uU(48,"Project One"),a.qZA(),a.TgZ(49,"div",8),a._uU(50,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(51,"div",8),a._uU(52,"Lorem Ipsum is simply dummy text"),a.qZA(),a.TgZ(53,"div",8),a._UZ(54,"i",10),a._UZ(55,"i",11),a.qZA(),a.qZA(),a.TgZ(56,"div",9),a.TgZ(57,"div",8),a._uU(58,"Project One"),a.qZA(),a.TgZ(59,"div",8),a._uU(60,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(61,"div",8),a._uU(62,"Lorem Ipsum is simply dummy text"),a.qZA(),a.TgZ(63,"div",8),a._UZ(64,"i",10),a._UZ(65,"i",11),a.qZA(),a.qZA(),a.TgZ(66,"div",9),a.TgZ(67,"div",8),a._uU(68,"Project One"),a.qZA(),a.TgZ(69,"div",8),a._uU(70,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(71,"div",8),a._uU(72,"Lorem Ipsum is simply dummy text"),a.qZA(),a.TgZ(73,"div",8),a._UZ(74,"i",10),a._UZ(75,"i",11),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(1),a.Q6J("routerLink",a.DdM(1,Gg)))},directives:[r.rH],styles:[".bg-cardmain[_ngcontent-%COMP%]{background-color:#d7d7d7!important}.bg-card[_ngcontent-%COMP%], .bg-cardmain[_ngcontent-%COMP%]{color:#000!important;margin-bottom:13px;padding:12px 0;align-items:center;text-align:center}.bg-card[_ngcontent-%COMP%]{background-color:#f2f2f2!important;font-weight:700;font-size:15px}"]}),t})(),Bg=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-create-project"]],decls:27,vars:0,consts:[[1,"container","mt-4"],[1,"row"],[1,"col-12"],[1,"fw-bold"],[1,"clearfix","pb-4"],["type","button",1,"btn","btn-success","btn-md","float-right"],[1,"mb-3"],["for","exampleFormControlInput1",1,"form-label"],["type","text","id","exampleFormControlInput1","placeholder","ProjectName",1,"form-control"],["type","text","id","exampleFormControlInput2","placeholder","url",1,"form-control"],["type","text","id","exampleFormControlInput13","placeholder","ProjectCategory",1,"form-control"],["for","exampleFormControlTextarea1",1,"form-label"],["id","exampleFormControlTextarea1","rows","3",1,"form-control"],[1,"d-grid","gap-2","text-center"],["type","button",1,"btn","btn-success","btn-md"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"h1",3),a._uU(4,"Create Project"),a.qZA(),a.TgZ(5,"div",4),a.TgZ(6,"button",5),a._uU(7," All Projects "),a.qZA(),a.qZA(),a.TgZ(8,"div",6),a.TgZ(9,"label",7),a._uU(10,"Project Name"),a.qZA(),a._UZ(11,"input",8),a.qZA(),a.TgZ(12,"div",6),a.TgZ(13,"label",7),a._uU(14,"URL"),a.qZA(),a._UZ(15,"input",9),a.qZA(),a.TgZ(16,"div",6),a.TgZ(17,"label",7),a._uU(18,"Project Category"),a.qZA(),a._UZ(19,"input",10),a.qZA(),a.TgZ(20,"div",6),a.TgZ(21,"label",11),a._uU(22,"Decription"),a.qZA(),a._UZ(23,"textarea",12),a.qZA(),a.TgZ(24,"div",13),a.TgZ(25,"button",14),a._uU(26,"Submit"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA())},styles:[""]}),t})(),Wg=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-input-handeling"]],decls:2,vars:0,template:function(t,e){1&t&&(a.TgZ(0,"p"),a._uU(1,"input-handeling works!"),a.qZA())},styles:[""]}),t})();function Yg(t,e){1&t&&(a.TgZ(0,"div",41),a._UZ(1,"div",42),a.qZA())}const Vg=function(t){return{display:t}};function Xg(t,e){1&t&&(a.TgZ(0,"div",20),a.TgZ(1,"div",21),a._uU(2," DataBase "),a.qZA(),a.TgZ(3,"div",22),a.TgZ(4,"div",23),a.TgZ(5,"div",6),a.TgZ(6,"label",24),a._uU(7,"Server Name"),a.qZA(),a._UZ(8,"input",25),a.qZA(),a.TgZ(9,"div",6),a.TgZ(10,"label",26),a._uU(11,"Port"),a.qZA(),a._UZ(12,"input",27),a.qZA(),a.TgZ(13,"div",6),a.TgZ(14,"label",7),a._uU(15,"Username"),a.qZA(),a._UZ(16,"input",8),a.qZA(),a.TgZ(17,"div",6),a.TgZ(18,"label",7),a._uU(19,"Password"),a.qZA(),a._UZ(20,"input",8),a.qZA(),a.qZA(),a.qZA(),a.qZA())}function Hg(t,e){1&t&&(a.TgZ(0,"div",20),a.TgZ(1,"div",21),a._uU(2," Shpfile "),a.qZA(),a.TgZ(3,"div",22),a.TgZ(4,"div",23),a.TgZ(5,"div"),a.TgZ(6,"label",28),a._uU(7,"Shpfile"),a.qZA(),a._UZ(8,"input",29),a.qZA(),a.qZA(),a.qZA(),a.qZA())}function Kg(t,e){1&t&&(a.TgZ(0,"div",20),a.TgZ(1,"div",21),a._uU(2," Excel "),a.qZA(),a.TgZ(3,"div",22),a.TgZ(4,"div",23),a.TgZ(5,"div",23),a.TgZ(6,"div"),a.TgZ(7,"label",28),a._uU(8,"Excel"),a.qZA(),a._UZ(9,"input",29),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA())}function Jg(t,e){1&t&&(a.TgZ(0,"div",20),a.TgZ(1,"div",21),a._uU(2," Csv "),a.qZA(),a.TgZ(3,"div",22),a.TgZ(4,"div",23),a.TgZ(5,"div",23),a.TgZ(6,"div"),a.TgZ(7,"label",28),a._uU(8,"Csv"),a.qZA(),a._UZ(9,"input",29),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA())}const Qg=function(){return["/dashboard/connection-handeling"]},$g=[{path:"",component:S,children:[{path:"",component:jg},{path:"project-management",component:Ug},{path:"create-project",component:Bg},{path:"connection-handeling",component:(()=>{class t{constructor(t){this.httpClient=t,this.apiUrl=s.N.api+"/api/shape_file_page",this.loadingLoader=!1,this.uploadFilesStatus="none_status",this.uploadRefFilesStatus="none_status",this.extractExistingStatus="none_status",this.missingDemandStatus="none_status",this.secondaryPreprocessgpStatus="none_status",this.pnBoundaryCheckStatus="none_status",this.exportStatus="none_status",this.googleFetchStatus="none_status",this.sigdisplay="none",this.files={},this.filesRef={},this.filesGoogle={}}ngOnInit(){this.userType=localStorage.getItem("usertype"),console.log(this.userType)}UploadRefPoint(){this.sigdisplay="block"}filesDropped(t,e){this.files[e]=t.target.files}filesRefDropped(t,e){this.filesRef[e]=t.target.files}filesGoogleDropped(t,e){this.filesGoogle[e]=t.target.files}uploadFiles(){const t=new FormData;for(var e in t.append("username",localStorage.getItem("username")),this.files)for(let i=0;i<this.files[e].length;i++)t.append(e,this.files[e][i]);this.httpClient.post(s.N.api+this.apiUrl,t).subscribe(t=>{alert("upload completed successfully"),this.uploadFilesStatus="green_status"},t=>{console.error(t),alert(" upload completed with error"),this.uploadFilesStatus="red_status"},()=>{})}extractExisting(){this.loadingLoader=!0;const t=new FormData;t.append("username",localStorage.getItem("username")),this.httpClient.post(s.N.api+"/api/secondary_structures",t).subscribe(t=>{alert("completed successfully"),this.loadingLoader=!1,this.extractExistingStatus="green_status",this.missingDemand()},t=>{console.error(t),alert("completed with error"),this.extractExistingStatus="red_status",this.loadingLoader=!1},()=>{this.loadingLoader=!1})}missingDemand(){this.loadingLoader=!0;const t=new FormData;t.append("username",localStorage.getItem("username")),this.httpClient.post(s.N.api+"/api/secondary_preprocessdp",t).subscribe(t=>{alert("completed successfully"),this.loadingLoader=!1,this.missingDemandStatus="green_status",this.export()},t=>{console.error(t),alert(" completed with error"),this.missingDemandStatus="red_status"},()=>{this.loadingLoader=!1})}secondaryPreprocessgp(){this.loadingLoader=!0;const t=new FormData;t.append("username",localStorage.getItem("username")),this.httpClient.post(s.N.api+"/api/secondary_preprocessgp",t).subscribe(t=>{alert("completed successfully"),this.loadingLoader=!1,this.secondaryPreprocessgpStatus="green_status",this.pnBoundaryCheck()},t=>{console.error(t),alert(" completed with error"),this.loadingLoader=!1,this.secondaryPreprocessgpStatus="red_status"},()=>{this.loadingLoader=!1})}pnBoundaryCheck(){this.loadingLoader=!0;const t=new FormData;t.append("username",localStorage.getItem("username")),this.httpClient.post(s.N.api+"/api/secondary_pnb_fed_ug",t).subscribe(t=>{alert("completed successfully"),this.loadingLoader=!1,this.pnBoundaryCheckStatus="green_status",this.extractExisting()},t=>{console.error(t),alert(" completed with error"),this.loadingLoader=!1,this.pnBoundaryCheckStatus="red_status"},()=>{this.loadingLoader=!1})}export(){this.loadingLoader=!0;const t=new FormData;t.append("username",localStorage.getItem("username")),this.httpClient.post(s.N.api+"/api/export_output",t).subscribe(e=>{this.httpClient.post("/api/download_qgis_files",t,{responseType:"arraybuffer"}).subscribe(t=>{let e=new Blob([t],{type:"application/zip"}),i=window.URL.createObjectURL(e);var n=document.createElement("a");document.body.appendChild(n),i=window.URL.createObjectURL(e),n.href=i,n.download=localStorage.getItem("username")+".zip",n.click(),window.URL.revokeObjectURL(i),alert("completed successfully"),this.loadingLoader=!1,this.exportStatus="green_status",document.body.removeChild(n),this.UploadRefPoint()},t=>{console.error(t),alert(" completed with error"),this.loadingLoader=!1,this.exportStatus="red_status"},()=>{this.loadingLoader=!1})},t=>{console.error(t),alert(" completed with error"),this.loadingLoader=!1,this.exportStatus="red_status"},()=>{})}UploadRef(){const t=new FormData;for(var e in this.loadingLoader=!0,t.append("username",localStorage.getItem("username")),this.filesRef)for(let i=0;i<this.filesRef[e].length;i++)t.append(e,this.filesRef[e][i]);this.httpClient.post(s.N.api+"/api/ref_point_page",t).subscribe(t=>{alert("upload completed successfully"),this.uploadRefFilesStatus="green_status",this.UploadGoogle()},t=>{console.error(t),alert(" upload completed with error"),this.uploadRefFilesStatus="red_status"},()=>{this.loadingLoader=!1})}UploadGoogle(){const t=new FormData;this.loadingLoader=!0,t.append("username",localStorage.getItem("username")),this.loadingLoader=!0,this.httpClient.post(s.N.api+"/api/googleapifetch2",t).subscribe(t=>{alert("upload completed successfully"),this.googleFetchStatus="green_status",this.secondaryPreprocessgp()},t=>{console.error(t),alert(" upload completed with error"),this.googleFetchStatus="red_status"},()=>{this.loadingLoader=!1})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(h.eN))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-connection-handeling"]],decls:283,vars:21,consts:[["class","loader-class",4,"ngIf"],[1,"container","mt-4"],[1,"clearfix","pb-4"],["type","button",1,"btn","btn-success","btn-sm","float-right",3,"ngStyle"],[1,"row"],[1,"card"],[1,"card-header","header"],[1,"card-table","table-borderless","myTable",2,"overflow-y","auto","overflow-x","auto","text-align","center"],[1,"tableColor"],[1,"tableTitles"],["type","button","data-bs-target","#UploadRefPoints","data-bs-toggle","modal",1,"btn","btn-primary","btn-sm","btn-size","btn_shadow1"],[3,"ngClass"],[1,"tableColor",3,"ngStyle"],["type","button","data-bs-toggle","modal","data-bs-target","#shapeFilesModal",1,"btn","btn-primary","btn-sm","btn-size","btn_shadow1"],["type","button",1,"btn","btn-primary","btn-sm","btn-size","btn_shadow",3,"click"],["type","button",1,"btn","btn-primary","btn-sm","btn-size","btn_shadow1",3,"click"],["type","button","data-bs-target","#UploadRefPoint","data-bs-toggle","modal",1,"btn","btn-primary","btn-sm","btn-size","btn_shadow1",3,"click"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"mb-3"],["for","recipient-name",1,"col-form-label"],["type","file","id","recipient-name",1,"form-control"],["for","message-text",1,"col-form-label"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary"],["id","exampleModal1","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["type","file","multiple","",1,"form-control",3,"change"],["type","button",1,"btn","btn-primary",3,"click"],["id","reviewModal","tabindex","-1","aria-labelledby","reviewModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-title"],["type","button",1,"btn","btn-primary","btn-sm","btn-size"],["id","shapeFilesModal","tabindex","-1","aria-labelledby","shapeFilesLabel","aria-hidden","true","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],["id","UploadRefPoint","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade",3,"ngStyle"],[1,"modal-dialog",3,"ngStyle"],["id","UploadRefPoints","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"loader-class"],[1,"loader"]],template:function(t,e){1&t&&(a.YNc(0,Yg,2,0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"button",3),a._uU(4," Create Connection "),a.qZA(),a.qZA(),a.TgZ(5,"div",4),a.TgZ(6,"div",5),a.TgZ(7,"div",6),a.TgZ(8,"h1"),a.TgZ(9,"b"),a._uU(10,"CONNECTIONS"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(11,"table",7),a.TgZ(12,"thead"),a.TgZ(13,"tr"),a.TgZ(14,"th"),a._uU(15,"Connection Name"),a.qZA(),a.TgZ(16,"th"),a._uU(17,"Date"),a.qZA(),a.TgZ(18,"th"),a._uU(19,"Description"),a.qZA(),a.TgZ(20,"th"),a._uU(21,"Status"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(22,"tbody"),a.TgZ(23,"tr",8),a.TgZ(24,"td",9),a.TgZ(25,"button",10),a._uU(26," PN BOUNDRY "),a.qZA(),a.qZA(),a.TgZ(27,"td",9),a._uU(28,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(29,"td",9),a._uU(30,"TO CHECK TO PN BOUNDARY FED BY AERIAL OR UNDERGROUND"),a.qZA(),a.TgZ(31,"td",9),a._UZ(32,"div",11),a.qZA(),a.qZA(),a.TgZ(33,"tr",12),a.TgZ(34,"td",9),a.TgZ(35,"button",13),a._uU(36," SHAPEFILES PATH "),a.qZA(),a.qZA(),a.TgZ(37,"td",9),a._uU(38,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(39,"td",9),a._uU(40,"All the Shape files to be added"),a.qZA(),a.TgZ(41,"td",9),a._UZ(42,"div",11),a.qZA(),a.qZA(),a.TgZ(43,"tr",8),a.TgZ(44,"td",9),a.TgZ(45,"button",14),a.NdJ("click",function(){return e.UploadGoogle()}),a._uU(46," DATA FETCH "),a.qZA(),a.qZA(),a.TgZ(47,"td",9),a._uU(48,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(49,"td",9),a._uU(50," Algorithm fetch data from Google street view "),a.qZA(),a.TgZ(51,"td",9),a._UZ(52,"div",11),a.qZA(),a.qZA(),a.TgZ(53,"tr",8),a.TgZ(54,"td",9),a.TgZ(55,"button",14),a.NdJ("click",function(){return e.secondaryPreprocessgp()}),a._uU(56," GOOGLE DATA "),a._UZ(57,"br"),a._uU(58," PRE-PROCESSING "),a.qZA(),a.qZA(),a.TgZ(59,"td",9),a._uU(60,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(61,"td",9),a._uU(62," Validate the raw Google pole data with existing infrastructure "),a.qZA(),a.TgZ(63,"td",9),a._UZ(64,"div",11),a.qZA(),a.qZA(),a.TgZ(65,"tr",8),a.TgZ(66,"td",9),a.TgZ(67,"button",14),a.NdJ("click",function(){return e.pnBoundaryCheck()}),a._uU(68," PN BOUNDARY"),a._UZ(69,"br"),a._uU(70," CHECK "),a.qZA(),a.qZA(),a.TgZ(71,"td",9),a._uU(72,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(73,"td",9),a._uU(74," To check to PN boundary fed by Aerial or Underground "),a.qZA(),a.TgZ(75,"td",9),a.TgZ(76,"p"),a._uU(77,"UG \xa0\xa0"),a.TgZ(78,"span"),a._uU(79,"HB/AR"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(80,"tr",8),a.TgZ(81,"td",9),a.TgZ(82,"button",14),a.NdJ("click",function(){return e.extractExisting()}),a._uU(83," EXTRACT EXISTING "),a._UZ(84,"br"),a._uU(85," INFRASTRUCTURE "),a.qZA(),a.qZA(),a.TgZ(86,"td",9),a._uU(87,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(88,"td",9),a._uU(89," Combine poles from google street view and PIA structure "),a.qZA(),a.TgZ(90,"td",9),a._UZ(91,"div",11),a.qZA(),a.qZA(),a.TgZ(92,"tr",8),a.TgZ(93,"td",9),a.TgZ(94,"button",14),a.NdJ("click",function(){return e.missingDemand()}),a._uU(95," MISSING DEMAND "),a._UZ(96,"br"),a._uU(97," POINT CAPTURE "),a.qZA(),a.qZA(),a.TgZ(98,"td",9),a._uU(99,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(100,"td",9),a._uU(101," Generate missing demand points from cartographic text "),a.qZA(),a.TgZ(102,"td",9),a._UZ(103,"div",11),a.qZA(),a.qZA(),a.TgZ(104,"tr",8),a.TgZ(105,"td",9),a.TgZ(106,"button",15),a.NdJ("click",function(){return e.export()}),a._uU(107," EXPORT "),a.qZA(),a.qZA(),a.TgZ(108,"td",9),a._uU(109,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(110,"td",9),a._uU(111," Exporting all input to a qgis workspace and to create REF.POINTS "),a.qZA(),a.TgZ(112,"td",9),a._UZ(113,"div",11),a.qZA(),a.qZA(),a.TgZ(114,"tr",8),a.TgZ(115,"td",9),a.TgZ(116,"button",16),a.NdJ("click",function(){return e.UploadRefPoint()}),a._uU(117," UPLOAD REF. POINT "),a.qZA(),a.qZA(),a.TgZ(118,"td",9),a._uU(119,"13 nov 2021, 7:30 PM"),a.qZA(),a.TgZ(120,"td",9),a._uU(121,"Upload ref. points created in QGIS"),a.qZA(),a.TgZ(122,"td",9),a._UZ(123,"div",11),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(124,"div",17),a.TgZ(125,"div",18),a.TgZ(126,"div",19),a.TgZ(127,"div",20),a.TgZ(128,"h3",21),a._uU(129,"PREPROCESSING"),a.qZA(),a._UZ(130,"button",22),a.qZA(),a.TgZ(131,"div",23),a.TgZ(132,"form"),a.TgZ(133,"div",24),a.TgZ(134,"label",25),a._uU(135,"Pia Structure:"),a.qZA(),a._UZ(136,"input",26),a.qZA(),a.TgZ(137,"div",24),a.TgZ(138,"label",27),a._uU(139,"Google Api Output:"),a.qZA(),a._UZ(140,"input",26),a.qZA(),a.TgZ(141,"div",24),a.TgZ(142,"label",27),a._uU(143,"Gaist Data:"),a.qZA(),a._UZ(144,"input",26),a.qZA(),a.qZA(),a.qZA(),a.TgZ(145,"div",28),a.TgZ(146,"button",29),a._uU(147," Cancel "),a.qZA(),a.TgZ(148,"button",30),a._uU(149,"Submit"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(150,"div",31),a.TgZ(151,"div",18),a.TgZ(152,"div",19),a.TgZ(153,"div",20),a.TgZ(154,"h3",21),a._uU(155," EXTRACT DATA USING GOOGLE API "),a.qZA(),a._UZ(156,"button",22),a.qZA(),a.TgZ(157,"div",23),a.TgZ(158,"form"),a.TgZ(159,"div",24),a.TgZ(160,"label",25),a._uU(161,"Pnboundary files:"),a.qZA(),a.TgZ(162,"input",32),a.NdJ("change",function(t){return e.filesGoogleDropped(t,"pnboundary_files")}),a.qZA(),a.qZA(),a.TgZ(163,"div",24),a.TgZ(164,"label",25),a._uU(165,"Citygooglepoles files:"),a.qZA(),a.TgZ(166,"input",32),a.NdJ("change",function(t){return e.filesGoogleDropped(t,"citygooglepoles_files")}),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(167,"div",28),a.TgZ(168,"button",29),a._uU(169," Cancel "),a.qZA(),a.TgZ(170,"button",33),a.NdJ("click",function(){return e.UploadGoogle()}),a._uU(171," Submit "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(172,"div",34),a.TgZ(173,"div",18),a.TgZ(174,"div",19),a.TgZ(175,"div",20),a.TgZ(176,"h3",35),a._uU(177,"REVIEW"),a.qZA(),a._UZ(178,"button",22),a.qZA(),a.TgZ(179,"div",23),a.TgZ(180,"form"),a.TgZ(181,"div",24),a.TgZ(182,"button",36),a._uU(183," EXPORT TO QGIS WORKSPACE "),a.qZA(),a.qZA(),a.TgZ(184,"div",24),a.TgZ(185,"button",36),a._uU(186," REVIEW ONLY POLES VISIBLE "),a.qZA(),a.qZA(),a.TgZ(187,"div",24),a.TgZ(188,"button",36),a._uU(189," POLES FROM GOOGLE TO BE UPLOADED AS INPUT "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(190,"div",28),a.TgZ(191,"button",29),a._uU(192," Close "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(193,"div",37),a.TgZ(194,"div",18),a.TgZ(195,"div",19),a.TgZ(196,"div",20),a.TgZ(197,"h3",35),a._uU(198,"Shape Files Upload"),a.qZA(),a._UZ(199,"button",22),a.qZA(),a.TgZ(200,"div",23),a.TgZ(201,"form"),a.TgZ(202,"div",24),a.TgZ(203,"label",25),a._uU(204,"Demand Files:"),a.qZA(),a.TgZ(205,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"demand_files")}),a.qZA(),a.qZA(),a.TgZ(206,"div",24),a.TgZ(207,"label",27),a._uU(208,"PIA Duct Files:"),a.qZA(),a.TgZ(209,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"duct_files")}),a.qZA(),a.qZA(),a.TgZ(210,"div",24),a.TgZ(211,"label",27),a._uU(212,"Land Boundaries Files:"),a.qZA(),a.TgZ(213,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"landboundary_files")}),a.qZA(),a.qZA(),a.TgZ(214,"div",24),a.TgZ(215,"label",27),a._uU(216,"PIA Structure Files:"),a.qZA(),a.TgZ(217,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"piastruc_files")}),a.qZA(),a.qZA(),a.TgZ(218,"div",24),a.TgZ(219,"label",27),a._uU(220,"Street centerline files:"),a.qZA(),a.TgZ(221,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"streetcenterline_files")}),a.qZA(),a.qZA(),a.TgZ(222,"div",24),a.TgZ(223,"label",27),a._uU(224,"Gaist Data Files:"),a.qZA(),a.TgZ(225,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"gaistdata_files")}),a.qZA(),a.qZA(),a.TgZ(226,"div",24),a.TgZ(227,"label",27),a._uU(228,"Topographic Lines Files:"),a.qZA(),a.TgZ(229,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"topographiclines_files")}),a.qZA(),a.qZA(),a.TgZ(230,"div",24),a.TgZ(231,"label",27),a._uU(232,"Cartographic Text Files:"),a.qZA(),a.TgZ(233,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"cartograpgictext_file")}),a.qZA(),a.qZA(),a.TgZ(234,"div",24),a.TgZ(235,"label",27),a._uU(236,"Primary NodeBoundary:"),a.qZA(),a.TgZ(237,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"pnboundary_files")}),a.qZA(),a.qZA(),a.TgZ(238,"div",24),a.TgZ(239,"label",27),a._uU(240,"Primary Node Files:"),a.qZA(),a.TgZ(241,"input",32),a.NdJ("change",function(t){return e.filesDropped(t,"primarynodes_files")}),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(242,"div",28),a.TgZ(243,"button",33),a.NdJ("click",function(){return e.uploadFiles()}),a._uU(244," Upload Files "),a.qZA(),a.TgZ(245,"button",29),a._uU(246," Close "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(247,"div",38),a.TgZ(248,"div",39),a.TgZ(249,"div",19),a.TgZ(250,"div",20),a.TgZ(251,"h3",21),a._uU(252," Upload Reference Point "),a.qZA(),a._UZ(253,"button",22),a.qZA(),a.TgZ(254,"div",23),a.TgZ(255,"form"),a.TgZ(256,"div",24),a.TgZ(257,"label",27),a._uU(258,"Reference Point:"),a.qZA(),a.TgZ(259,"input",32),a.NdJ("change",function(t){return e.filesRefDropped(t,"refpoint_files")}),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(260,"div",28),a.TgZ(261,"button",33),a.NdJ("click",function(){return e.UploadRef()}),a._uU(262," Upload Files "),a.qZA(),a.TgZ(263,"button",29),a._uU(264," Close "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(265,"div",40),a.TgZ(266,"div",18),a.TgZ(267,"div",19),a.TgZ(268,"div",20),a.TgZ(269,"h3",21),a._uU(270," PN BOUNDRY "),a.qZA(),a._UZ(271,"button",22),a.qZA(),a.TgZ(272,"div",23),a.TgZ(273,"form"),a.TgZ(274,"div",24),a.TgZ(275,"label",27),a._uU(276,"PN Boundry:"),a.qZA(),a.TgZ(277,"input",32),a.NdJ("change",function(t){return e.filesRefDropped(t,"refpoint_files")}),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(278,"div",28),a.TgZ(279,"button",33),a.NdJ("click",function(){return e.UploadRef()}),a._uU(280," Upload Files "),a.qZA(),a.TgZ(281,"button",29),a._uU(282," Close "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.Q6J("ngIf",e.loadingLoader),a.xp6(3),a.Q6J("ngStyle",a.VKq(13,Vg,"hld_designer"===e.userType?"none":"block")),a.xp6(29),a.Q6J("ngClass",e.uploadRefFilesStatus),a.xp6(1),a.Q6J("ngStyle",a.VKq(15,Vg,"hld_designer"===e.userType?"none":"block")),a.xp6(9),a.Q6J("ngClass",e.uploadFilesStatus),a.xp6(10),a.Q6J("ngClass",e.googleFetchStatus),a.xp6(12),a.Q6J("ngClass",e.secondaryPreprocessgpStatus),a.xp6(27),a.Q6J("ngClass",e.extractExistingStatus),a.xp6(12),a.Q6J("ngClass",e.missingDemandStatus),a.xp6(10),a.Q6J("ngClass",e.exportStatus),a.xp6(10),a.Q6J("ngClass",e.uploadRefFilesStatus),a.xp6(124),a.Q6J("ngStyle",a.VKq(17,Vg,e.sigdisplay)),a.xp6(1),a.Q6J("ngStyle",a.VKq(19,Vg,e.sigdisplay)))},directives:[n.O5,n.PC,n.mk,o._Y,o.JL,o.F],styles:[".bg-cardmain[_ngcontent-%COMP%]{background-color:#d7d7d7!important}.bg-card[_ngcontent-%COMP%], .bg-cardmain[_ngcontent-%COMP%]{color:#000!important;margin-bottom:13px;padding:12px 0;align-items:center;text-align:center}.bg-card[_ngcontent-%COMP%]{background-color:#f2f2f2!important;font-weight:700;font-size:15px}.red_status[_ngcontent-%COMP%]{background:red}.green_status[_ngcontent-%COMP%], .red_status[_ngcontent-%COMP%]{max-width:30px!important;height:30px;border-radius:50%;margin:auto}.green_status[_ngcontent-%COMP%]{background:green}.none_status[_ngcontent-%COMP%]{background:#878282;max-width:30px!important;height:30px;border-radius:50%;margin:auto}.card[_ngcontent-%COMP%]{margin-top:16px;margin-left:16px;padding:0;margin-right:16px;background:#fff 0 0 no-repeat padding-box}.header[_ngcontent-%COMP%]{width:100%;height:40px;background:#ecf2f9 0 0 no-repeat padding-box;border-radius:8px 8px 0 0}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;font-family:Noto Sans,sans-serif;font-size:18px;letter-spacing:0;color:#4d4f5c}.card-table[_ngcontent-%COMP%]{word-break:break-all}td[_ngcontent-%COMP%]{padding-top:20px;padding-bottom:20px}td[_ngcontent-%COMP%]:first-child{padding-left:20px;padding-right:0}.tableColor[_ngcontent-%COMP%]{background-color:#d7d7d7;border-bottom:10px solid #fff}.table-borderless[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;font-size:12px;text-transform:uppercase}.btn-size[_ngcontent-%COMP%]{width:158px!important;font-size:12px;height:47px}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px!important}.btn_shadow[_ngcontent-%COMP%]{border-color:green;box-shadow:inset 0 0 4px 0 green}.btn_shadow[_ngcontent-%COMP%], .btn_shadow1[_ngcontent-%COMP%]{background-color:#fff;color:#000;border-radius:10px}.btn_shadow1[_ngcontent-%COMP%]{border-color:#0d6efd;box-shadow:inset 0 0 4px 0 #0d6efd}.loader[_ngcontent-%COMP%]{border-radius:50%;border:16px solid #f3f3f3;border-top-color:#3498db;width:120px;height:120px;animation:spin 2s linear infinite}.loader-class[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;position:absolute;width:100%;z-index:500;background:#f0f8ffcc}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}"]}),t})()},{path:"add-edit-connection",component:(()=>{class t{constructor(){this.selectedType=0}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-add-edit-connection"]],decls:35,vars:5,consts:[[1,"container","mt-4"],[1,"row"],[1,"col-12"],[1,"fw-bold","mb-4"],[1,"container"],[1,"row","g-3"],[1,"col-md-6"],["for","input3",1,"form-label"],["type","text","id","input3",1,"form-control"],["name","selectedType","aria-label","Default select example",1,"form-select",3,"ngModel","ngModelChange"],["selectedTypeModel","ngModel"],["selected",""],["value","1"],["value","2"],["value","3"],["value","4"],["class","card",4,"ngIf"],[1,"col-12","text-center","mt-4"],["id","save","Style","width: 100px;",1,"btn","btn-success","btn-md","ml-2"],["id","test","Style","width: 170px; ",1,"btn","btn-danger","btn-md","ml-2"],[1,"card"],[1,"card-header","p-4","text-center","bg-success","text-white"],[1,"card-body"],[1,"row","mt-2"],["for","input2",1,"form-label"],["type","text","id","input2",1,"form-control"],["for","input1",1,"form-label"],["type","text","id","input1",1,"form-control"],["for","formFile",1,"form-label"],["type","file","id","formFile",1,"form-control"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"h1",3),a._uU(4,"Create Connection"),a.qZA(),a.TgZ(5,"div",4),a.TgZ(6,"form",5),a.TgZ(7,"div",6),a.TgZ(8,"label",7),a._uU(9,"Connection Name"),a.qZA(),a._UZ(10,"input",8),a.qZA(),a.TgZ(11,"div",6),a.TgZ(12,"label",7),a._uU(13,"Type"),a.qZA(),a.TgZ(14,"select",9,10),a.NdJ("ngModelChange",function(t){return e.selectedType=t}),a.TgZ(16,"option",11),a._uU(17,"Select Type"),a.qZA(),a.TgZ(18,"option",12),a._uU(19,"Database"),a.qZA(),a.TgZ(20,"option",13),a._uU(21,"Shpfile"),a.qZA(),a.TgZ(22,"option",14),a._uU(23,"Excel"),a.qZA(),a.TgZ(24,"option",15),a._uU(25,"Csv"),a.qZA(),a.qZA(),a.qZA(),a.YNc(26,Xg,21,0,"div",16),a.YNc(27,Hg,9,0,"div",16),a.YNc(28,Kg,10,0,"div",16),a.YNc(29,Jg,10,0,"div",16),a.TgZ(30,"div",17),a.TgZ(31,"button",18),a._uU(32," Save "),a.qZA(),a.TgZ(33,"button",19),a._uU(34," Test Connection "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(14),a.Q6J("ngModel",e.selectedType),a.xp6(12),a.Q6J("ngIf",1==e.selectedType),a.xp6(1),a.Q6J("ngIf",2==e.selectedType),a.xp6(1),a.Q6J("ngIf",3==e.selectedType),a.xp6(1),a.Q6J("ngIf",4==e.selectedType))},directives:[o._Y,o.JL,o.F,o.EJ,o.JJ,o.On,o.YN,o.Kr,n.O5],styles:[".card[_ngcontent-%COMP%]{padding:0;border:1px solid #ccc;box-shadow:0 0 5px #00000030,0 3px 3px #0000003b;background:#fff}.bg-card[_ngcontent-%COMP%]{background-color:#41b3a3!important;color:#fff!important;margin-bottom:13px;align-items:center;padding:12px 0;font-weight:500;font-size:15px;text-align:center}#btnClear[_ngcontent-%COMP%], #btnSearch[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}"]}),t})()},{path:"input-handeling",component:Wg},{path:"geoData",component:b},{path:"workflow/:type",component:Ng},{path:"api-review",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-api-review"]],decls:55,vars:2,consts:[[1,"container","mt-4"],[1,"row"],[1,"col-4","card-left"],[1,"text-center"],[1,"mb-3"],["for","formGroupExampleInput"],["type","text","id","formGroupExampleInput","placeholder","Grid",1,"form-control"],["for","formGroupExampleInput2"],["type","text","id","formGroupExampleInput2","placeholder","Gistool_id",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Exchange",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Plant_item",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Obj_class",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Statuscode",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Type_name",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Category",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Struc_name",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Object_id",1,"form-control"],["type","text","id","formGroupExampleInput2","placeholder","Rotation",1,"form-control"],[1,"col-8","card-right"],[1,"pt-4"],["type","button",1,"btn","btn-warning","btn-md","pull-right",3,"routerLink"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"h1",3),a._uU(4,"Attribute Values"),a.qZA(),a.TgZ(5,"form"),a.TgZ(6,"div",4),a.TgZ(7,"label",5),a._uU(8,"Grid"),a.qZA(),a._UZ(9,"input",6),a.qZA(),a.TgZ(10,"div",4),a.TgZ(11,"label",7),a._uU(12,"Gistool_id"),a.qZA(),a._UZ(13,"input",8),a.qZA(),a.TgZ(14,"div",4),a.TgZ(15,"label",7),a._uU(16,"Exchange"),a.qZA(),a._UZ(17,"input",9),a.qZA(),a.TgZ(18,"div",4),a.TgZ(19,"label",7),a._uU(20,"Plant_item"),a.qZA(),a._UZ(21,"input",10),a.qZA(),a.TgZ(22,"div",4),a.TgZ(23,"label",7),a._uU(24,"Obj_class"),a.qZA(),a._UZ(25,"input",11),a.qZA(),a.TgZ(26,"div",4),a.TgZ(27,"label",7),a._uU(28,"Statuscode"),a.qZA(),a._UZ(29,"input",12),a.qZA(),a.TgZ(30,"div",4),a.TgZ(31,"label",7),a._uU(32,"Type_name"),a.qZA(),a._UZ(33,"input",13),a.qZA(),a.TgZ(34,"div",4),a.TgZ(35,"label",7),a._uU(36,"Category"),a.qZA(),a._UZ(37,"input",14),a.qZA(),a.TgZ(38,"div",4),a.TgZ(39,"label",7),a._uU(40,"Struc_name"),a.qZA(),a._UZ(41,"input",15),a.qZA(),a.TgZ(42,"div",4),a.TgZ(43,"label",7),a._uU(44,"Object_id"),a.qZA(),a._UZ(45,"input",16),a.qZA(),a.TgZ(46,"div",4),a.TgZ(47,"label",7),a._uU(48,"Rotation"),a.qZA(),a._UZ(49,"input",17),a.qZA(),a.qZA(),a.qZA(),a.TgZ(50,"div",18),a._uU(51,"Google API Data Review"),a.qZA(),a.TgZ(52,"div",19),a.TgZ(53,"button",20),a._uU(54," Back "),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(53),a.Q6J("routerLink",a.DdM(1,Qg)))},directives:[o._Y,o.JL,o.F,r.rH],styles:[".card-left[_ngcontent-%COMP%]{border-right:4px solid #fff;overflow-y:scroll}.card-left[_ngcontent-%COMP%], .card-right[_ngcontent-%COMP%]{background:linear-gradient(90deg,#047edf,#085696)!important;height:600px;text-align:center;font-size:16px;color:#fff;font-weight:500;padding-top:10px}"]}),t})()}]}];let t_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[r.Bz.forChild($g)],r.Bz]}),t})(),e_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({providers:[],imports:[[n.ez,t_,o.u5,o.UX,dg]]}),t})()}}]);